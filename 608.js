"use strict";(self.webpackChunkreveal_js_testing=self.webpackChunkreveal_js_testing||[]).push([[608],{34218:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "EU": () => (/* binding */ v),\n/* harmony export */   "Ue": () => (/* binding */ a),\n/* harmony export */   "WH": () => (/* binding */ x),\n/* harmony export */   "ZZ": () => (/* binding */ l),\n/* harmony export */   "qC": () => (/* binding */ q),\n/* harmony export */   "uT": () => (/* binding */ k)\n/* harmony export */ });\n/* unused harmony exports UP, copy, fromPoints, fromValues, setAngle, wrap, wrapAxisAngle */\n/* harmony import */ var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(19431);\n/* harmony import */ var _chunks_quat_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(10663);\n/* harmony import */ var _chunks_quatf64_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(61044);\n/* harmony import */ var _chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(6766);\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction a(n=U){return[n[0],n[1],n[2],n[3]]}function m(n,r,t,u){return j(n,r,t,u,w)}function p(n,r){return j(n[0],n[1],n[2],r,w)}function h(n,r=a()){return j(n[0],n[1],n[2],n[3],r)}function j(n,r,t,u,o=a()){return o[0]=n,o[1]=r,o[2]=t,o[3]=u,o}function k(n,r,t=a()){return (0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.g)(l(t),n),t[3]=r,t}function g(n,r,t=a()){return f(t,n,r),i(t,t),t[3]=-e(n,r),t}function q(r,c,s=a()){return (0,_chunks_quat_js__WEBPACK_IMPORTED_MODULE_1__.s)(b,l(r),x(r)),(0,_chunks_quat_js__WEBPACK_IMPORTED_MODULE_1__.s)(d,l(c),x(c)),(0,_chunks_quat_js__WEBPACK_IMPORTED_MODULE_1__.m)(b,d,b),z(s,(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .rad2deg */ .BV)((0,_chunks_quat_js__WEBPACK_IMPORTED_MODULE_1__.g)(l(s),b)))}function l(n){return n}function v(n){return n[3]}function x(n){return (0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .deg2rad */ .Vl)(n[3])}function z(n,r){return n[3]=r,n}const U=[0,0,1,0],b=(0,_chunks_quatf64_js__WEBPACK_IMPORTED_MODULE_2__.a)(),d=(0,_chunks_quatf64_js__WEBPACK_IMPORTED_MODULE_2__.a)(),w=a();\n\n\n//# sourceURL=webpack://reveal-js-testing/./node_modules/@arcgis/core/geometry/support/axisAngleDegrees.js?')},59468:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "k": () => (/* binding */ s)\n/* harmony export */ });\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?"xoffset"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;"number"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return"number"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>"size"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o="visualVariables"in n?r(s,n.visualVariables):s;if("simple"===n.type)return t(o,n.symbol);if("unique-value"===n.type){let e=o;return n.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if("class-breaks"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return n.type,o}\n\n\n//# sourceURL=webpack://reveal-js-testing/./node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js?')},50608:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  "DrawGraphicTool3D": () => (/* reexport */ y),\n  "ExtentTransformTool": () => (/* reexport */ At),\n  "GraphicMoveTool": () => (/* reexport */ GraphicMoveTool_R),\n  "GraphicReshapeTool": () => (/* reexport */ GraphicReshapeTool_u),\n  "GraphicTransformTool": () => (/* reexport */ GraphicTransformTool_T)\n});\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/tslib.es6.js\nvar tslib_es6 = __webpack_require__(36663);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/handleUtils.js\nvar handleUtils = __webpack_require__(23148);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/maybe.js\nvar maybe = __webpack_require__(61681);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/watchUtils.js\nvar watchUtils = __webpack_require__(15071);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js\nvar property = __webpack_require__(81977);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/arrayUtils.js\nvar arrayUtils = __webpack_require__(7753);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js\nvar has = __webpack_require__(39994);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/ensureType.js\nvar ensureType = __webpack_require__(7283);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js\nvar subclass = __webpack_require__(40266);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/support/elevationInfoUtils.js\nvar elevationInfoUtils = __webpack_require__(83772);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/symbols/support/ElevationInfo.js + 1 modules\nvar ElevationInfo = __webpack_require__(74710);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/Color.js\nvar Color = __webpack_require__(30936);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec3.js\nvar vec3 = __webpack_require__(6766);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec3f64.js\nvar vec3f64 = __webpack_require__(8909);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/visualElements/ExtendedLineVisualElement.js\nvar ExtendedLineVisualElement = __webpack_require__(56885);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Handles.js\nvar Handles = __webpack_require__(44584);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/screenUtils.js\nvar screenUtils = __webpack_require__(95550);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec2.js\nvar vec2 = __webpack_require__(55709);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec4.js\nvar vec4 = __webpack_require__(88589);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec4f32.js\nvar vec4f32 = __webpack_require__(18916);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/visualElements/Object3DVisualElement.js\nvar Object3DVisualElement = __webpack_require__(10449);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GeometryUtil.js + 1 modules\nvar GeometryUtil = __webpack_require__(6087);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Material.js\nvar Material = __webpack_require__(7358);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js\nvar VertexAttribute = __webpack_require__(21414);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/RibbonLineMaterial.js + 1 modules\nvar RibbonLineMaterial = __webpack_require__(65392);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/visualElements/ParallelLineVisualElement.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass R extends Object3DVisualElement/* Object3DVisualElement */._{constructor(t){super(t),this._handles=new Handles/* default */.Z,this._location=(0,vec3f64.c)(),this._direction=(0,vec3f64.f)(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=(0,vec4f32.f)(1,0,1,1),this._renderOccluded=Material/* RenderOccludedFlag.OccludeAndTransparent */.yD.OccludeAndTransparent,this.applyProps(t)}get location(){return this._location}set location(e){(0,vec3.k)(this._location,e)||((0,vec3.g)(this._location,e),this._updateGeometry())}get direction(){return this._direction}set direction(e){(0,vec3.k)(this._direction,e)||((0,vec3.g)(this._direction,e),this._updateGeometry())}setDirectionFromPoints(e,t){(0,vec3.n)(this._direction,(0,vec3.f)(this._direction,t,e)),this._updateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get offset(){return this._offset}set offset(e){e!==this._offset&&(this._offset=e,this._updateGeometry())}get length(){return this._length}set length(e){e!==this._length&&(this._length=e,this._updateGeometry())}get color(){return this._color}set color(e){(0,vec4.g)(e,this._color)||((0,vec4.c)(this._color,e),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}createExternalResources(){const e=new RibbonLineMaterial/* RibbonLineMaterial */.U(this.materialParameters);this._handles.add(this.view.state.watch("camera",(()=>{this._updateGeometry()}))),this._externalResources={material:e}}destroyExternalResources(){this._handles.removeAll(),this._externalResources=null}createGeometries(e){const r=GeometryUtil/* default.createPolylineGeometry */.Z.createPolylineGeometry([(0,vec3f64.c)(),(0,vec3f64.c)()]),s=GeometryUtil/* default.createPolylineGeometry */.Z.createPolylineGeometry([(0,vec3f64.c)(),(0,vec3f64.c)()]),i=(0,maybe/* unwrap */.Wg)(this._externalResources).material;e.addGeometry(r,i),e.addGeometry(s,i),this._updateVertices(e)}forEachExternalMaterial(e){(0,maybe/* isSome */.pC)(this._externalResources)&&e(this._externalResources.material)}_updateMaterial(){if((0,maybe/* isNone */.Wi)(this._externalResources))return;this._externalResources.material.setParameters(this.materialParameters)}get materialParameters(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded}}_updateGeometry(){const e=this.object;(0,maybe/* isNone */.Wi)(e)||this._updateVertices(e)}_updateVertices(e){const t=this.view.state.camera;t.projectToScreen(this.location,V),(0,vec3.b)(P,this.location,this.direction),t.projectToScreen(P,v),(0,vec2.i)(v,(0,vec2.f)(v,v,V)),this._updateVertexAttributes(t,e,0,V,v,1),this._updateVertexAttributes(t,e,1,V,v,-1)}_updateVertexAttributes(e,t,r,s,i,o){const a=t.geometryRecords[r],l=a.geometry.getMutableAttribute(VertexAttribute/* VertexAttribute.POSITION */.T.POSITION).data,d=(0,vec2.g)(A,(0,vec2.s)(A,i[1]*o,i[0]*-o),this.offset+this.width/2),m=(0,vec2.m)(M,(0,vec2.m)(M,(0,vec2.m)(M,s,(0,vec2.g)(M,i,this.length/2)),d),d),u=(0,vec2.m)(k,m,(0,vec2.g)(k,i,-this.length));e.unprojectFromScreen(m,P),l[0]=P[0],l[1]=P[1],l[2]=P[2],e.unprojectFromScreen(u,P),l[3]=P[0],l[4]=P[1],l[5]=P[2],t.geometryVertexAttrsUpdated(a)}}const P=(0,vec3f64.c)(),V=(0,screenUtils/* createScreenPointArray */.s1)(),v=(0,screenUtils/* createScreenPointArray */.s1)(),A=(0,screenUtils/* createScreenPointArray */.s1)(),M=(0,screenUtils/* createScreenPointArray */.s1)(),k=(0,screenUtils/* createScreenPointArray */.s1)();\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/mathUtils.js\nvar mathUtils = __webpack_require__(19431);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec4f64.js\nvar vec4f64 = __webpack_require__(1983);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/projection.js\nvar projection = __webpack_require__(90472);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js\nvar aaBoundingBox = __webpack_require__(37116);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/vectorStacks.js + 1 modules\nvar vectorStacks = __webpack_require__(68817);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/visualElements/VisualElementResources.js\nvar VisualElementResources = __webpack_require__(7426);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/layers/graphics/elevationAlignmentUtils.js\nvar elevationAlignmentUtils = __webpack_require__(63669);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/layers/graphics/ElevationContext.js\nvar ElevationContext = __webpack_require__(29642);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/layers/graphics/sdfPrimitives.js\nvar sdfPrimitives = __webpack_require__(57741);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/HUDMaterial.js + 2 modules\nvar HUDMaterial = __webpack_require__(86719);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/visualElements/PointVisualElement.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass S{constructor(e){this.view=null,this._geometry=null,this._size=3,this._color=(0,vec4f64.f)(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive="square",this._outlineSize=1,this._outlineColor=(0,vec4f64.f)(1,1,1,1),this._elevationInfo=null,this.resources=new VisualElementResources/* VisualElementResources */.O({view:e.view,createResources:e=>this._createResources(e),recreateGeometry:(e,t)=>(e.geometry=this._recreateGeometry(t,e.material),(0,maybe/* isSome */.pC)(e.geometry)?[e.geometry]:[])});let t=!0;for(const r in e)r in this?"attached"===r?t=e[r]:this[r]=e[r]:console.error("Cannot set unknown property",r);this.attached=t}destroy(){this.resources.destroy()}get visible(){return this.resources.visible}set visible(e){this.resources.visible=e}get attached(){return this.resources.attached}set attached(e){this.resources.attached=e}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.resources.recreateGeometry()}get size(){return this._size}set size(e){if(e!==this._size){const t=this.preferredTextureSize;this._size=e,t<this.preferredTextureSize?(0,maybe/* isSome */.pC)(this.resources)&&this.resources.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(e){(0,vec4.g)(e,this._color)||((0,vec4.c)(this._color,e),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(e){this._pixelSnappingEnabled!==e&&(this._pixelSnappingEnabled=e,this._updateMaterial())}get primitive(){return this._primitive}set primitive(e){this._primitive!==e&&(this._primitive=e,(0,maybe/* isSome */.pC)(this.resources)&&this.resources.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,vec4.g)(e,this._outlineColor)||((0,vec4.c)(this._outlineColor,e),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.resources&&this.resources.recreateGeometry()}_updateMaterial(){const e=this.resources.resources;(0,maybe/* isNone */.Wi)(e)||e.material.setParameters(this._materialParameters(e.texture.id))}_updateSizeAttribute(){const e=this.resources.resources,t=this.resources.object;if((0,maybe/* isNone */.Wi)(e)||(0,maybe/* isNone */.Wi)(t))return;const r=e.geometry;if((0,maybe/* isNone */.Wi)(r))return;const s=r.getMutableAttribute(VertexAttribute/* VertexAttribute.SIZE */.T.SIZE).data,o=this.geometrySize;s[0]=o,s[1]=o,t.geometryVertexAttrsUpdated(t.geometryRecords[0])}_materialParameters(e){return{color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:z,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:e,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}}get geometrySize(){return this._size/b}_recreateGeometry(e,t){const i=this._createRenderGeometry();return (0,maybe/* isSome */.pC)(i)&&e.addGeometry(i,t),i}_createResources(e){const t=(0,sdfPrimitives/* createTexture */.cU)(this._primitive,this.preferredTextureSize),i=new HUDMaterial/* HUDMaterial */.A(this._materialParameters(t.id)),s=this._recreateGeometry(e,i);return{material:i,texture:t,geometry:s,forEach(e){e(t),e(i),(0,maybe/* isSome */.pC)(this.geometry)&&e(this.geometry)}}}get preferredTextureSize(){return (0,mathUtils/* clamp */.uZ)((0,mathUtils/* nextHighestPowerOfTwo */.Sf)(2*this.geometrySize),16,128)}calculateMapBounds(e){if((0,maybe/* isNone */.Wi)(this.resources.resources)||(0,maybe/* isNone */.Wi)(this.resources.resources.geometry))return!1;const t=this.resources.resources.geometry.vertexAttributes.get(VertexAttribute/* VertexAttribute.POSITION */.T.POSITION);return (0,projection/* projectVectorToVector */.SH)(t.data,this.view.renderCoordsHelper.spatialReference,x,this.view.spatialReference),(0,aaBoundingBox/* expandWithBuffer */.G1)(e,x),!0}_createRenderGeometry(){const e=this.geometry;if((0,maybe/* isNone */.Wi)(e))return null;const{renderCoordsHelper:t,elevationProvider:r}=this.view,o=(0,elevationAlignmentUtils/* evaluateElevationAlignmentAtPoint */.w7)(e,r,ElevationContext/* ElevationContext.fromElevationInfo */.o.fromElevationInfo(this.elevationInfo),t),n=(0,vec3.s)(vectorStacks/* sv3d.get */.WM.get(),e.x,e.y,o),a=vectorStacks/* sv3d.get */.WM.get();(0,projection/* projectVectorToVector */.SH)(n,e.spatialReference,a,t.spatialReference);const l=this.geometrySize;return GeometryUtil/* default.createPointGeometry */.Z.createPointGeometry(null,a,null,[l,l],[0,0,0,1])}}const b=sdfPrimitives/* DEFAULT_SYMBOL_SIZE_RATIO */.Ns,z=[b/2,b/2,1-b/2,1-b/2],x=(0,vec3f64.c)();\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/visualElements/RightAngleQuadVisualElement.js\nvar RightAngleQuadVisualElement = __webpack_require__(83061);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/snapping/Settings.js\nvar Settings = __webpack_require__(50639);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js\nvar snappingUtils = __webpack_require__(22519);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/snapping/SnappingVisualizer.js\nvar SnappingVisualizer = __webpack_require__(4371);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/SnappingVisualizer3D.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass g extends SnappingVisualizer/* SnappingVisualizer */.a{visualizeIntersectionPoint(t,i){const{coordinateHelper:o,elevationInfo:r,view:a}=i;return (0,handleUtils/* destroyHandle */.ed)(new S({view:a,primitive:"circle",geometry:o.vectorToPoint(t.intersectionPoint),elevationInfo:r,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:Color/* default.toUnitRGBA */.Z.toUnitRGBA(Settings/* defaults.orange */.c.orange),pixelSnappingEnabled:!1}))}visualizePoint(t,i){const{coordinateHelper:o,elevationInfo:r,view:a}=i;return (0,handleUtils/* destroyHandle */.ed)(new S({view:a,primitive:"circle",geometry:o.vectorToPoint(t.point),elevationInfo:r,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:Color/* default.toUnitRGBA */.Z.toUnitRGBA(Settings/* defaults.orange */.c.orange),pixelSnappingEnabled:!1}))}visualizeLine(e,t){const{coordinateHelper:i,elevationInfo:o,view:r}=t;return (0,handleUtils/* destroyHandle */.ed)(this._createLineSegmentHintFromMap(e.type,e.lineStart,e.lineEnd,i,o,r,e.fadeLeft,e.fadeRight))}visualizeParallelSign(i,o){const{coordinateHelper:r,elevationInfo:l,view:s}=o,m=(0,snappingUtils/* anyMapPointToRender */.$r)(i.lineStart,r,l,o.view),u=(0,snappingUtils/* anyMapPointToRender */.$r)(i.lineEnd,r,l,o.view),v=(0,vec3.e)(u,m,u,.5),g=new R({view:s,attached:!1,offset:Settings/* defaults.parallelLineHintOffset */.c.parallelLineHintOffset,length:Settings/* defaults.parallelLineHintLength */.c.parallelLineHintLength,width:Settings/* defaults.parallelLineHintWidth */.c.parallelLineHintWidth,color:Color/* default.toUnitRGBA */.Z.toUnitRGBA(Settings/* defaults.orange */.c.orange),location:v,renderOccluded:Material/* RenderOccludedFlag.Opaque */.yD.Opaque});return g.setDirectionFromPoints(m,v),g.attached=!0,(0,handleUtils/* destroyHandle */.ed)(g)}visualizeRightAngleQuad(t,i){const{coordinateHelper:o,elevationInfo:r,view:a}=i;return (0,handleUtils/* destroyHandle */.ed)(new RightAngleQuadVisualElement/* RightAngleQuadVisualElement */.R({view:a,attached:!0,color:Color/* default.toUnitRGBA */.Z.toUnitRGBA(Settings/* defaults.orange */.c.orange),renderOccluded:Material/* RenderOccludedFlag.Transparent */.yD.Transparent,outlineRenderOccluded:Material/* RenderOccludedFlag.Opaque */.yD.Opaque,outlineColor:Color/* default.toUnitRGBA */.Z.toUnitRGBA(Settings/* defaults.orange */.c.orange),outlineSize:Settings/* defaults.rightAngleHintOutlineSize */.c.rightAngleHintOutlineSize,size:Settings/* defaults.rightAngleHintSize */.c.rightAngleHintSize,geometry:{previous:(0,snappingUtils/* anyMapPointToRender */.$r)(t.previousVertex,o,r,a),center:(0,snappingUtils/* anyMapPointToRender */.$r)(t.centerVertex,o,r,a),next:(0,snappingUtils/* anyMapPointToRender */.$r)(t.nextVertex,o,r,a)}}))}_createLineSegmentHintFromMap(e,n,t,o,r,a,l=!0,s=!0){const c=(0,vec3f64.c)(),d=(0,vec3f64.c)();return (0,snappingUtils/* anyMapPointsToRenderWithEqualZ */.gQ)(n,t,o,r,a,c,d),this._createLineSegmentHint(e,a,c,d,l,s)}_createLineSegmentHint(n,t,i,a,l=!0,s=!0){const p=new ExtendedLineVisualElement/* ExtendedLineVisualElement */.V({view:t,extensionType:ExtendedLineVisualElement/* ExtensionType.FADED */.n.FADED,start:i,end:a,color:Color/* default.toUnitRGBA */.Z.toUnitRGBA(Settings/* defaults.orange */.c.orange),renderOccluded:Material/* RenderOccludedFlag.Opaque */.yD.Opaque});switch(n){case snappingUtils/* LineSegmentHintType.TARGET */.ze.TARGET:p.width=Settings/* defaults.lineHintWidthTarget */.c.lineHintWidthTarget,p.fadedExtensions={start:0,end:Settings/* defaults.lineHintFadedExtensions */.c.lineHintFadedExtensions};break;case snappingUtils/* LineSegmentHintType.REFERENCE_EXTENSION */.ze.REFERENCE_EXTENSION:p.width=Settings/* defaults.lineHintWidthReference */.c.lineHintWidthReference,p.fadedExtensions={start:0,end:0};break;case snappingUtils/* LineSegmentHintType.REFERENCE */.ze.REFERENCE:p.width=Settings/* defaults.lineHintWidthReference */.c.lineHintWidthReference,p.fadedExtensions={start:l?Settings/* defaults.lineHintFadedExtensions */.c.lineHintFadedExtensions:0,end:s?Settings/* defaults.lineHintFadedExtensions */.c.lineHintFadedExtensions:0}}return p.attached=!0,p}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/settings.js\nvar settings = __webpack_require__(13540);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/visualElements/OutlineVisualElement.js + 1 modules\nvar OutlineVisualElement = __webpack_require__(15230);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/layers/graphics/pointUtils.js\nvar pointUtils = __webpack_require__(63593);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/basicInterfaces.js\nvar basicInterfaces = __webpack_require__(70984);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ShadedColorMaterial.js + 1 modules\nvar ShadedColorMaterial = __webpack_require__(2070);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/visualElements/VerticesVisualElement.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass p extends Object3DVisualElement/* Object3DVisualElement */._{constructor(e){super(e),this.view=null,this._renderOccluded=Material/* RenderOccludedFlag.OccludeAndTransparent */.yD.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.vertex.color */.Xd.reshapeManipulators.vertex.color),this._size=settings/* settings.reshapeManipulators.vertex.size */.Xd.reshapeManipulators.vertex.size,this._outlineColor=settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.vertex.outlineColor */.Xd.reshapeManipulators.vertex.outlineColor),this._outlineSize=settings/* settings.reshapeManipulators.vertex.outlineSize */.Xd.reshapeManipulators.vertex.outlineSize,this._elevationInfo=null,this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(e){this._vertices=e,this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(e){this._spatialReference=e,this.recreateGeometry()}get color(){return this._color}set color(e){(0,vec4.g)(e,this._color)||((0,vec4.c)(this._color,e),this._updateMaterial())}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,vec4.g)(e,this._outlineColor)||((0,vec4.c)(this._outlineColor,e),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get vertexMaterialParameters(){return{color:this._color,transparent:this._color[3]<1,screenSize:this.size,renderOccluded:this._renderOccluded}}get vertexOutlineMaterialParameters(){return{color:this._outlineColor,transparent:this._outlineColor[3]<1,screenSize:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded}}_updateMaterial(){this.attached&&this.vertexMaterial.setParameters(this.vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this.vertexOutlineMaterial.setParameters(this.vertexOutlineMaterialParameters)}_createRenderGeometries(){const r=this.vertices;if((0,maybe/* isNone */.Wi)(r)||0===r.length)return[];const i=.5,s=.5,a=(0,pointUtils/* geometryToRenderInfo */.VP)(r,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,ElevationContext/* ElevationContext.fromElevationInfo */.o.fromElevationInfo(this.elevationInfo)),o=[],c=a.numVertices,h=a.position;for(let e=0;e<c;++e){const r=(0,vec3.s)(m,h[3*e+0],h[3*e+1],h[3*e+2]),a=VerticesVisualElement_v(i,r),l=VerticesVisualElement_v(s,r);o.push({vertexGeometry:a,vertexOutlineGeometry:l})}return o}createGeometries(e){const t=this._createRenderGeometries();for(const{vertexGeometry:r,vertexOutlineGeometry:i}of t)e.addGeometry(r,this.vertexMaterial),e.addGeometry(i,this.vertexOutlineMaterial)}createExternalResources(){this.vertexMaterial=new ShadedColorMaterial/* ShadedColorMaterial */.Q({...this.vertexMaterialParameters,writeDepth:!0,cullFace:basicInterfaces/* CullFaceOptions.Back */.Vr.Back,screenSizeEnabled:!0}),this.vertexOutlineMaterial=new ShadedColorMaterial/* ShadedColorMaterial */.Q({...this.vertexOutlineMaterialParameters,transparent:!0,writeDepth:!0,cullFace:basicInterfaces/* CullFaceOptions.Front */.Vr.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this.vertexMaterial=null,this.vertexOutlineMaterial=null}forEachExternalMaterial(e){e(this.vertexMaterial),e(this.vertexOutlineMaterial)}}const m=(0,vec3f64.c)();function VerticesVisualElement_v(e,t){return GeometryUtil/* default.createSphereGeometry */.Z.createSphereGeometry(e,16,16,{offset:t})}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/layers/graphics/GraphicState.js\nvar GraphicState = __webpack_require__(75354);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/draw/DrawGraphicTool.js + 2 modules\nvar DrawGraphicTool = __webpack_require__(54027);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/draw/DrawOperation.js + 2 modules\nvar DrawOperation = __webpack_require__(84703);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/draw/drawSurfaces.js\nvar drawSurfaces = __webpack_require__(15991);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/draw/DrawGraphicTool3D.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nlet y=class extends DrawGraphicTool/* DrawGraphicTool */.T{constructor(e){super(e),this._activeVertexVisualElement=null,this._createGraphicState=null,this._outlineVisualElement=null,this._verticesVisualElement=null,this.geometryType=null,this.type="draw-3d"}initialize(){const{mode:e,offset:t}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=new ElevationInfo/* default */.Z({mode:e,offset:t})}normalizeCtorArgs(e){if(!e.elevationInfo){var t;const i=null==(t=e.hasZ)||t;return{...e,elevationInfo:{mode:i?"absolute-height":"on-the-ground",offset:0}}}return e}initializeGraphic(e){return this._createGraphicState=new GraphicState/* GraphicState */.F({graphic:e}),(0,handleUtils/* handlesGroup */.AL)([this.view.maskOccludee(e),this.view.trackGraphicState(this._createGraphicState),(0,watchUtils/* init */.S1)(this._createGraphicState,"isDraped",(e=>{(0,maybe/* isSome */.pC)(this._outlineVisualElement)&&(this._outlineVisualElement.isDraped=e)}))])}makeDrawOperation(){return new DrawOperation/* DrawOperation */.w({view:this.view,manipulators:this.manipulators,geometryType:(0,DrawGraphicTool/* geometryTypeToDrawOperationGeometryType */.I)(this.geometryType),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new drawSurfaces/* SceneDrawSurface */.iW(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new drawSurfaces/* ElevationDrawSurface */.aL(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new g})}onActiveVertexChanged(e){return (0,maybe/* isSome */.pC)(this._activeVertexVisualElement)?(this._activeVertexVisualElement.vertices=[e],null):(this._activeVertexVisualElement=new p({view:this.view,spatialReference:this.view.spatialReference,vertices:[e],elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:settings/* settings.reshapeManipulators.vertex.renderOccluded */.Xd.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._activeVertexVisualElement.color=settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.selected.color */.Xd.reshapeManipulators.selected.color),this._activeVertexVisualElement.attached=!0,(0,handleUtils/* makeHandle */.kB)((()=>{this._activeVertexVisualElement=(0,maybe/* destroyMaybe */.SC)(this._activeVertexVisualElement)})))}onOutlineChanged(e){if((0,maybe/* isSome */.pC)(this._outlineVisualElement))return this._outlineVisualElement.geometry=e,null;const t=this.internalGraphicsLayer.elevationInfo;return this._outlineVisualElement=new OutlineVisualElement/* OutlineVisualElement */.k({view:this.view,geometry:e,elevationInfo:t,isDraped:(0,maybe/* isSome */.pC)(this._createGraphicState)?this._createGraphicState.isDraped:"on-the-ground"===(0,elevationInfoUtils/* getEffectiveElevationMode */.Zz)(this.hasZ,t),attached:!1}),settings/* settings.visualElements.lineGraphics.outline.apply */.Xd.visualElements.lineGraphics.outline.apply(this._outlineVisualElement),settings/* settings.visualElements.lineGraphics.shadowStyle.apply */.Xd.visualElements.lineGraphics.shadowStyle.apply(this._outlineVisualElement),this._outlineVisualElement.attached=!0,this._outlineVisualElement.laserlineEnabled=!0,(0,handleUtils/* makeHandle */.kB)((()=>{this._outlineVisualElement=(0,maybe/* destroyMaybe */.SC)(this._outlineVisualElement)}))}onRegularVerticesChanged(e){return (0,maybe/* isSome */.pC)(this._verticesVisualElement)?(this._verticesVisualElement.vertices=e,null):(this._verticesVisualElement=new p({view:this.view,spatialReference:this.view.spatialReference,vertices:e,elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:settings/* settings.reshapeManipulators.vertex.renderOccluded */.Xd.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._verticesVisualElement.attached=!0,(0,handleUtils/* makeHandle */.kB)((()=>{this._verticesVisualElement=(0,maybe/* destroyMaybe */.SC)(this._verticesVisualElement)})))}};(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],y.prototype,"elevationInfo",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],y.prototype,"geometryType",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],y.prototype,"type",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],y.prototype,"view",void 0),y=(0,tslib_es6._)([(0,subclass/* subclass */.j)("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],y);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Collection.js + 1 modules\nvar Collection = __webpack_require__(66591);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Evented.js\nvar Evented = __webpack_require__(31355);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/HandleOwner.js\nvar HandleOwner = __webpack_require__(53280);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/dehydratedFeatures.js\nvar dehydratedFeatures = __webpack_require__(48358);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/manipulatorUtils.js\nvar manipulatorUtils = __webpack_require__(74390);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/isSupportedGraphicUtils.js\nvar isSupportedGraphicUtils = __webpack_require__(4506);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulatorUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction manipulatorUtils_t(o,t=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(o)){return"on-the-ground"!==t.mode&&!((0,maybe/* isNone */.Wi)(o.geometry)||!o.geometry.hasZ)}function manipulatorUtils_n(e,r){let t=null;const n=e.events.on("grab-changed",(n=>{o(t)&&(t.remove(),t=null),"start"===n.action?(t=e.disableDisplay(),r&&r(n)):r&&r(n)}));return{remove(){o(t)&&t.remove(),n.remove()}}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/Manipulator3D.js\nvar Manipulator3D = __webpack_require__(46707);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/GrabbingState.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nvar N;!function(N){N[N.NONE=0]="NONE",N[N.ANY=1]="ANY",N[N.Z=2]="Z",N[N.XY=4]="XY"}(N||(N={}));\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/ManipulatorType.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nvar ManipulatorType_A;!function(A){A[A.TRANSLATE_Z=0]="TRANSLATE_Z",A[A.TRANSLATE_XY=1]="TRANSLATE_XY",A[A.SCALE=2]="SCALE",A[A.ROTATE=3]="ROTATE",A[A.SCALE_ROTATE=4]="SCALE_ROTATE"}(ManipulatorType_A||(ManipulatorType_A={}));\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/ManipulatorState.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass a{constructor(){this.grabbingState=N.NONE,this.zManipulator=null,this.firstSelected=null,this.numSelected=0,this.firstGrabbedXY=null}update(a){this.grabbingState=N.NONE,this.zManipulator=null,this.numSelected=0,this.firstSelected=null,this.firstGrabbedXY=null,a.forEachManipulator(((a,s)=>{if(s===ManipulatorType_A.TRANSLATE_Z&&(this.zManipulator=a),a instanceof Manipulator3D/* Manipulator3D */.Z&&(a.selected&&(0===this.numSelected&&(this.firstSelected=a),this.numSelected++),(0,maybe/* isNone */.Wi)(this.firstGrabbedXY)&&a.grabbing&&s===ManipulatorType_A.TRANSLATE_XY&&(this.firstGrabbedXY=a)),a.grabbing)switch(this.grabbingState|=N.ANY,s){case ManipulatorType_A.TRANSLATE_Z:this.grabbingState|=N.Z;break;case ManipulatorType_A.TRANSLATE_XY:this.grabbingState|=N.XY}}))}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/visualElements/LaserlineVisualElement.js + 4 modules\nvar LaserlineVisualElement = __webpack_require__(42936);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/lineGraphicVisualElementUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction lineGraphicVisualElementUtils_w(t){const{view:a,graphic:n}=t,i=new GraphicState/* GraphicState */.F({graphic:n}),l=lineGraphicVisualElementUtils_b(t,i),r=[l,j(t,l.visualElement,i),a.maskOccludee(n),a.trackGraphicState(i)];return{visualElement:l.visualElement,remove:()=>(0,handleUtils/* handlesGroup */.AL)(r).remove()}}function lineGraphicVisualElementUtils_b(a,n){const{view:i,graphic:l}=a,r=new OutlineVisualElement/* OutlineVisualElement */.k({view:i,geometry:G(l)?l.geometry:null,elevationInfo:(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(l),attached:!1});settings/* settings.visualElements.lineGraphics.shadowStyle.apply */.Xd.visualElements.lineGraphics.shadowStyle.apply(r);const o=()=>{r.attached=n.displaying};settings/* settings.visualElements.lineGraphics.outline.apply */.Xd.visualElements.lineGraphics.outline.apply(r);const s=[n.watch("displaying",o),n.watch("isDraped",(e=>r.isDraped=e)),n.on("changed",(()=>r.geometry=G(l)?l.geometry:null)),(0,handleUtils/* destroyHandle */.ed)(r)];return o(),{visualElement:r,remove:()=>(0,handleUtils/* handlesGroup */.AL)(s).remove()}}function j(i,l,r){const{graphic:o,view:s}=i,p=[],u=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(o),v="on-the-ground"===u.mode||!u.offset&&"absolute-height"!==u.mode,y=new a,w=new ExtendedLineVisualElement/* ExtendedLineVisualElement */.V({view:s,extensionType:settings/* settings.visualElements.zVerticalLine.extensionType */.Xd.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:Material/* RenderOccludedFlag.OccludeAndTransparent */.yD.OccludeAndTransparent});settings/* settings.visualElements.pointGraphics.shadowStyle.apply */.Xd.visualElements.pointGraphics.shadowStyle.apply(w);const b=(0,mathUtils/* deg2rad */.Vl)(settings/* settings.visualElements.heightPlaneAngleCutoff */.Xd.visualElements.heightPlaneAngleCutoff),j=new LaserlineVisualElement/* LaserlineVisualElement */.W({view:s,attached:!1,angleCutoff:b});settings/* settings.visualElements.heightPlane.apply */.Xd.visualElements.heightPlane.apply(j);let L=1,T=1;const A=()=>{if(y.update(i),!r.displaying||v&&(r.isDraped||!G(o)||!o.geometry.hasZ))return l.laserlineEnabled=!1,w.attached=!1,void(j.attached=!1);l.laserlineEnabled=!0;{const e=y.grabbingState&N.XY?settings/* settings.visualElements.laserlineAlphaMultiplier */.Xd.visualElements.laserlineAlphaMultiplier:1;e!==L&&(L=e,settings/* settings.visualElements.lineGraphics.shadowStyle.apply */.Xd.visualElements.lineGraphics.shadowStyle.apply(l,e),settings/* settings.visualElements.pointGraphics.shadowStyle.apply */.Xd.visualElements.pointGraphics.shadowStyle.apply(w,e))}{const e=y.grabbingState&N.Z?settings/* settings.visualElements.laserlineAlphaMultiplier */.Xd.visualElements.laserlineAlphaMultiplier:1;e!==T&&(T=e,settings/* settings.visualElements.heightPlane.apply */.Xd.visualElements.heightPlane.apply(j,e))}lineGraphicVisualElementUtils_S(w,y),lineGraphicVisualElementUtils_M(i,l,j,y)};settings/* settings.visualElements.zVerticalLine.apply */.Xd.visualElements.zVerticalLine.apply(w),p.push(r.on("changed",A),r.watch("displaying",A),l.events.on("attachment-origin-changed",A),(0,handleUtils/* destroyHandle */.ed)(w),(0,handleUtils/* destroyHandle */.ed)(j));const D=[],C=()=>{(0,handleUtils/* handlesGroup */.AL)(D).remove(),D.length=0,i.forEachManipulator((e=>D.push(e.events.on("grab-changed",A)))),i.forEachManipulator((e=>D.push(e.events.on("select-changed",A)))),A()};return C(),p.push(i.onManipulatorsChanged(C),(0,handleUtils/* refHandle */.iU)((()=>(0,handleUtils/* handlesGroup */.AL)(D)))),(0,handleUtils/* handlesGroup */.AL)(p)}function lineGraphicVisualElementUtils_S(e,t){const a=1===t.numSelected?t.firstSelected:t.numSelected>1&&(0,maybe/* isSome */.pC)(t.firstGrabbedXY)?t.firstGrabbedXY:null;(0,maybe/* isSome */.pC)(a)?(e.setStartEndFromWorldDownAtLocation(a.renderLocation),e.attached=!0):e.attached=!1}function lineGraphicVisualElementUtils_M(e,t,a,n){if(n.numSelected>0){(0,vec3.s)(L,0,0,0);let t=0;e.forEachManipulator(((e,a)=>{a===ManipulatorType_A.TRANSLATE_XY&&e.selected&&e instanceof Manipulator3D/* Manipulator3D */.Z&&((0,vec3.b)(L,L,e.renderLocation),t++)})),t>0?(a.heightManifoldTarget=(0,vec3.a)(L,L,1/t),a.attached=!0):a.attached=!1}else{const n=t.attachmentOrigin;(0,maybe/* isSome */.pC)(n)&&e.view.renderCoordsHelper.toRenderCoords(n,L)?(a.heightManifoldTarget=L,a.attached=!0):a.attached=!1}}function G(e){return (0,maybe/* isSome */.pC)(e.geometry)&&("polygon"===e.geometry.type||"polyline"===e.geometry.type)}const L=(0,vec3f64.c)();\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js\nvar aaBoundingRect = __webpack_require__(24568);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/originGraphicVisualElementUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction originGraphicVisualElementUtils_L(t){const{view:n,graphic:i}=t,o=new GraphicState/* GraphicState */.F({graphic:i}),a=[],r=originGraphicVisualElementUtils_P(t,o,a);return originGraphicVisualElementUtils_M(t,o,a,r),a.push(n.trackGraphicState(o)),{visualElement:r,remove(){(0,handleUtils/* handlesGroup */.AL)(a).remove()}}}function originGraphicVisualElementUtils_M(e,n,r,l){const{view:c,graphic:m}=e,d=new ExtendedLineVisualElement/* ExtendedLineVisualElement */.V({view:c,extensionType:settings/* settings.visualElements.zVerticalLine.extensionType */.Xd.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:Material/* RenderOccludedFlag.OccludeAndTransparent */.yD.OccludeAndTransparent});settings/* settings.visualElements.zVerticalLine.apply */.Xd.visualElements.zVerticalLine.apply(d);const w=new LaserlineVisualElement/* LaserlineVisualElement */.W({view:c,intersectsLineInfinite:!0,attached:!1});settings/* settings.visualElements.pointGraphics.shadowStyle.apply */.Xd.visualElements.pointGraphics.shadowStyle.apply(w);const x=(0,mathUtils/* deg2rad */.Vl)(settings/* settings.visualElements.heightPlaneAngleCutoff */.Xd.visualElements.heightPlaneAngleCutoff),L=new LaserlineVisualElement/* LaserlineVisualElement */.W({view:c,attached:!1,angleCutoff:x});settings/* settings.visualElements.heightPlane.apply */.Xd.visualElements.heightPlane.apply(L);const M=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(e.graphic),P=ElevationContext/* ElevationContext.fromElevationInfo */.o.fromElevationInfo(M),G="on-the-ground"===M.mode||!M.offset&&"absolute-height"!==M.mode,R=new a;let U=1,B=1;const I=()=>{R.update(e);const t=C(m),i=G&&(n.isDraped||(0,maybe/* isNone */.Wi)(t)||!t.hasZ);let r=!0;if(!i&&(0,maybe/* isSome */.pC)(t)){const e=(0,elevationAlignmentUtils/* evaluateElevationAlignmentAtPoint */.w7)(t,c.elevationProvider,P,c.renderCoordsHelper);(0,vec3.s)(D,t.x,t.y,e),(0,projection/* projectVectorToVector */.SH)(D,t.spatialReference,D,c.renderCoordsHelper.spatialReference),d.setStartEndFromWorldDownAtLocation(D),w.intersectsWorldUpAtLocation=D}else r=!1;const f=R.grabbingState&N.Z?settings/* settings.visualElements.laserlineAlphaMultiplier */.Xd.visualElements.laserlineAlphaMultiplier:1;f!==U&&(U=f,settings/* settings.visualElements.heightPlane.apply */.Xd.visualElements.heightPlane.apply(L,f));const v=(0,aaBoundingBox/* empty */.cS)(originGraphicVisualElementUtils_V);!i&&n.displaying&&l.calculateMapBounds(v)&&(0,projection/* projectVectorToVector */.SH)((0,aaBoundingBox/* getMin */.KE)(v,D),c.spatialReference,D,c.renderCoordsHelper.spatialReference)?(L.heightManifoldTarget=D,L.attached=!0):L.attached=!1;const E=R.grabbingState&N.XY?settings/* settings.visualElements.laserlineAlphaMultiplier */.Xd.visualElements.laserlineAlphaMultiplier:1;E!==B&&(B=E,settings/* settings.visualElements.pointGraphics.shadowStyle.apply */.Xd.visualElements.pointGraphics.shadowStyle.apply(w,E));const j=r&&n.displaying&&!i;w.attached=j,d.attached=j};r.push(n.watch(["displaying","isDraped"],I),n.on("changed",I)),e.forEachManipulator((e=>{r.push(e.events.on("grab-changed",I))})),r.push((0,handleUtils/* destroyHandle */.ed)(w)),r.push((0,handleUtils/* destroyHandle */.ed)(d)),r.push((0,handleUtils/* destroyHandle */.ed)(L)),I()}function originGraphicVisualElementUtils_P(e,n,i){const{view:o,graphic:a}=e,r=new S({view:o,geometry:C(a),elevationInfo:(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(a),attached:!1});return originGraphicVisualElementUtils_G(e,r,n,i),i.push((0,handleUtils/* destroyHandle */.ed)(r)),r}function C(e){const t=e.geometry;return (0,maybe/* isNone */.Wi)(t)?null:"point"===t.type?t:"mesh"===t.type?t.anchor.clone():null}function originGraphicVisualElementUtils_G(e,t,n,i){const o=()=>t.attached=n.displaying;originGraphicVisualElementUtils_R(e,t,n,i),settings/* settings.visualElements.pointGraphics.outline.apply */.Xd.visualElements.pointGraphics.outline.apply(t),i.push((0,watchUtils/* init */.S1)(n,"displaying",o))}function originGraphicVisualElementUtils_R(e,t,i,o){const{view:r,graphic:s}=e;let l=null;const p=e=>{(0,maybe/* isSome */.pC)(l)&&(l.remove(),l=null),i.isDraped&&(0,maybe/* isSome */.pC)(e)&&(l=originGraphicVisualElementUtils_U(r,e,(()=>{t.geometry=e})))},c=()=>{const e=C(s);p(e),t.geometry=e};o.push(i.on("changed",c),(0,handleUtils/* refHandle */.iU)((()=>l))),c()}function originGraphicVisualElementUtils_U(e,t,n){const i=e.elevationProvider.spatialReference;(0,projection/* projectPointToVector */.KC)(t,D,i);const o=D[0],a=D[1];return e.elevationProvider.on("elevation-change",(e=>{(0,aaBoundingRect/* containsXY */.jE)(e.extent,o,a)&&n()}))}const D=(0,vec3f64.c)(),originGraphicVisualElementUtils_V=(0,aaBoundingBox/* create */.Ue)();\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/visualElementUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction visualElementUtils_i(i){switch((0,maybe/* unwrap */.Wg)(i.graphic.geometry).type){case"point":case"mesh":return originGraphicVisualElementUtils_L(i);case"polygon":case"polyline":return lineGraphicVisualElementUtils_w(i);default:return null}}\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/config.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nconst config_t=[1,.5,0],config_a=128,config_e=70,h=80,config_M=.02,c=54,config_o=100,config_I=Math.ceil(config_e/3*2),config_P=160,config_i=.5,config_l=24,config_n=9,config_p=config_P+30,config_r=config_P+53,config_s=60,config_x=23,config_b=5*Math.PI/12,config_d=1*Math.PI/3,f=10,config_g=.2,config_j=30,config_k=53,config_m=.2,q=.3,u=200,config_v=3,config_w=1e6;\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/Manipulation.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass Manipulation_t{constructor(){this._available=!0}set location(a){this._forEachManipulator3D((t=>t.location=a))}set elevationAlignedLocation(a){this._forEachManipulator3D((t=>t.elevationAlignedLocation=a))}set elevationInfo(a){this._forEachManipulator3D((t=>t.elevationInfo=a))}get renderLocation(){let a;return this._forEachManipulator3D((t=>{a||(a=t.renderLocation)})),a}get available(){return this._available}set available(a){this._available=a,this._forEachManipulator3D((t=>t.available=a))}get grabbing(){return this.someManipulator((a=>a.grabbing))}get dragging(){return this.someManipulator((a=>a.dragging))}hasManipulator(a){return this.someManipulator((t=>t===a))}someManipulator(a){let t=!1;return this.forEachManipulator((i=>{!t&&a(i)&&(t=!0)})),t}_forEachManipulator3D(t){this.forEachManipulator(((i,o)=>{i instanceof Manipulator3D/* Manipulator3D */.Z&&t(i,o)}))}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/mat4.js\nvar mat4 = __webpack_require__(24455);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/mat4f64.js\nvar mat4f64 = __webpack_require__(39100);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/plane.js\nvar plane = __webpack_require__(69430);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/ray.js\nvar ray = __webpack_require__(97537);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/vector.js\nvar vector = __webpack_require__(5700);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/support/geometryUtils/ray.js\nvar geometryUtils_ray = __webpack_require__(40460);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Intersector.js\nvar Intersector = __webpack_require__(8927);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/IntersectorInterfaces.js\nvar IntersectorInterfaces = __webpack_require__(20757);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/verticalOffsetUtils.js\nvar verticalOffsetUtils = __webpack_require__(5073);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/dragEventPipeline.js\nvar dragEventPipeline = __webpack_require__(76478);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/dragEventPipeline3D.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction dragEventPipeline3D_C(e,r){return dragEventPipeline3D_D(e,(()=>r))}function T(e){return dragEventPipeline3D_D(e,(e=>e.plane))}function dragEventPipeline3D_D(t,s){const c=(0,vec3f64.c)(),l=(0,vec3f64.c)();let i=!1;return a=>{const u=s(a);if("start"===a.action){const r=(0,screenUtils/* screenPointObjectToArray */.md)(a.screenStart,(0,screenUtils/* castScreenPointArray */.c$)(vectorStacks/* sv2d.get */.qW.get())),s=(0,geometryUtils_ray/* fromScreen */.u4)(t.state.camera,r,dragEventPipeline3D_L);(0,maybe/* isSome */.pC)(s)&&(i=(0,plane/* intersectRay */.BR)(u,s,c))}if(!i)return null;const p=(0,screenUtils/* screenPointObjectToArray */.md)(a.screenEnd,(0,screenUtils/* castScreenPointArray */.c$)(vectorStacks/* sv2d.get */.qW.get())),m=(0,geometryUtils_ray/* fromScreen */.u4)(t.state.camera,p,dragEventPipeline3D_L);return (0,maybe/* isNone */.Wi)(m)?null:(0,plane/* intersectRay */.BR)(u,m,l)?{...a,renderStart:c,renderEnd:l,plane:u,ray:m}:null}}function dragEventPipeline3D_M(t,n,o,c=null,l=null){let i=null;return a=>{if("start"===a.action&&(i=t.sceneIntersectionHelper.intersectElevationFromScreen((0,screenUtils/* createScreenPointArray */.s1)(a.screenStart.x,a.screenStart.y),n,o,l),(0,maybe/* isSome */.pC)(i)&&(0,maybe/* isSome */.pC)(c)&&!(0,projection/* projectPoint */.nF)(i,i,c)))return null;if((0,maybe/* isNone */.Wi)(i))return null;const u=t.sceneIntersectionHelper.intersectElevationFromScreen((0,screenUtils/* createScreenPointArray */.s1)(a.screenEnd.x,a.screenEnd.y),n,o,l);return (0,maybe/* isSome */.pC)(u)?(0,maybe/* isSome */.pC)(c)&&!(0,projection/* projectPoint */.nF)(u,u,c)?null:{...a,mapStart:i,mapEnd:u}:null}}function dragEventPipeline3D_N(e,r,t,n=null,o=null){return dragEventPipeline3D_M(e,t,(0,elevationInfoUtils/* getZForElevationMode */.Ou)(r,e,t),n,o)}function dragEventPipeline3D_P(e,r,t,n=null,o=null){return dragEventPipeline3D_N(e,t,(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(r),n,o)}function dragEventPipeline3D_h(r,t,n,o){const s=t.toMap(r.screenStart,{include:[n]});return (0,maybe/* isSome */.pC)(s)?dragEventPipeline3D_P(t,n,s,o):null}function dragEventPipeline3D_k(e,r){const t=J,n=K,o=(0,plane/* create */.Ue)();e.renderCoordsHelper.worldUpAtPosition(r,t);const s=(0,vec3.c)(o,t,(0,vec3.f)(n,r,e.state.camera.eye));return (0,vec3.c)(s,s,t),(0,plane/* fromPositionAndNormal */.Yq)(r,s,o)}function dragEventPipeline3D_G(e,r,t){let n=null;const o=new dragEventPipeline/* EventPipeline */.hM;return o.next(dragEventPipeline3D_C(e,dragEventPipeline3D_k(e,r))).next(dragEventPipeline3D_A(e,r)).next(F(e,t)).next((e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,n=e})),e=>(n=null,o.execute(e),n)}function dragEventPipeline3D_A(e,r){const t=(0,vec3f64.c)(),n=(0,vec3.l)(r);e.renderCoordsHelper.worldUpAtPosition(r,t);const o=(0,vec3f64.c)(),s=(0,vec3f64.c)(),m=o=>{if((0,vec3.f)(o,o,r),(0,vector/* projectPoint */.nF)(t,o,o),"global"===e.viewingMode){(0,vec3.l)(o)*Math.sign((0,vec3.d)(t,o))<.001-n&&(0,vec3.f)(o,(0,vec3.a)(o,t,.001),r)}return (0,vec3.b)(o,o,r),o};return e=>(e.renderStart=m((0,vec3.g)(o,e.renderStart)),e.renderEnd=m((0,vec3.g)(s,e.renderEnd)),e)}function F(r,t){const n=r.renderCoordsHelper;return r=>{const o=n.fromRenderCoords(r.renderStart,t),s=n.fromRenderCoords(r.renderEnd,t);return (0,maybe/* isSome */.pC)(o)&&(0,maybe/* isSome */.pC)(s)?{...r,mapStart:o,mapEnd:s}:null}}var dragEventPipeline3D_q;function dragEventPipeline3D_z(r){let t=null;return n=>{switch(n.action){case"start":t=r.disableDisplay();break;case"end":case"cancel":e(t)&&(t.remove(),t=null)}return n}}function B(o,c=null){const l=I(o.state.viewingMode);l.options.selectionMode=!0,l.options.store=w.MIN,l.options.hud=!1;const i=s(),a={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},u=d(),p=t(c,o.spatialReference),m=e=>{o.map.ground&&o.map.ground.opacity<1?a.exclude.add(U):a.exclude.delete(U),o.sceneIntersectionHelper.intersectIntersectorScreen(n(e,i),l,a);const r=l.results.min;let t;if(r.getIntersectionPoint(u))t=r.intersector===H.TERRAIN?dragEventPipeline3D_q.GROUND:dragEventPipeline3D_q.OTHER;else{if(!l.results.ground.getIntersectionPoint(u))return null;t=dragEventPipeline3D_q.GROUND}return{location:o.renderCoordsHelper.fromRenderCoords(u,p),surfaceType:t}};let f;return t=>{if("start"===t.action){const r=m(t.screenStart);f=e(r)?r.location:null}if(r(f))return null;const n=m(t.screenEnd);return e(n)&&e(n.location)?{...t,mapStart:f,mapEnd:n.location,surfaceType:n.surfaceType}:null}}!function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"}(dragEventPipeline3D_q||(dragEventPipeline3D_q={}));const J=(0,vec3f64.c)(),K=(0,vec3f64.c)(),dragEventPipeline3D_L=(0,ray/* create */.Ue)();\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/moveUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction moveUtils_r(t,r,a,c){const i=t.graphic,o=(t,e)=>r({action:t,graphic:i,dxScreen:e.screenDeltaX,dyScreen:e.screenDeltaY});return a(((t,r,a)=>{const s=r.next((t=>("start"===t.action&&o("start",t),t))).next((0,dragEventPipeline/* dragGraphic */.a9)(i,c)).next((t=>{switch(t.action){case"start":case"update":(t.translationX||t.translationY||t.translationZ)&&o("update",t);break;case"end":o("end",t)}return t}));return a.next((0,dragEventPipeline/* resetGraphic */.bD)(i)).next((()=>{o("end",{screenDeltaX:0,screenDeltaY:0})})),s}))}function moveUtils_a(e){if((0,maybe/* isNone */.Wi)(e)||"polyline"!==e.type&&"polygon"!==e.type)return 0;const n=("polyline"===e.type?e.paths:e.rings)[0];if(!n||n.length<2)return 0;const r=n[0],a=n[1];return Math.atan2(a[1]-r[1],a[0]-r[0])}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ColorMaterial.js + 1 modules\nvar ColorMaterial = __webpack_require__(95793);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/interfaces.js\nvar interfaces = __webpack_require__(91258);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveXYAxisManipulation.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass O extends Manipulation_t{constructor(t){super(),this._handles=new Handles/* default */.Z,this._arrowManipulatorInfos=new Array,this._opaqueMaterial=this._createMaterial(),this._transparentMaterial=this._createMaterial(.5),this._angle=0,this._scale=1,this._radius=config_e,this._updateAfterDrag=!1,this.events=new Evented/* default */.Z,this._tool=t.tool,this._view=t.view,null!=t.radius&&(this._radius=t.radius),this._createManipulators(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}set orthogonalAvailable(t){this._arrowManipulatorInfos[1].manipulator.available=t,this._arrowManipulatorInfos[3].manipulator.available=t}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._handles=(0,maybe/* destroyMaybe */.SC)(this._handles),this._tool=null,this._view=null,this._arrowManipulatorInfos.length=0}forEachManipulator(t){for(const{manipulator:a}of this._arrowManipulatorInfos)t(a,ManipulatorType_A.TRANSLATE_XY)}createGraphicDragPipeline(t,a,r){const e=a.graphic,i=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(e),s=(0,maybe/* unwrap */.Wg)(e.geometry).spatialReference;return moveUtils_r(a,r,(a=>this.createDragPipeline(((r,e,i,o,s)=>a(r,t(r,e,i,o,s),i)),i,s,e)),this._view.state.viewingMode)}createDragPipeline(t,a,r,i){return (0,handleUtils/* handlesGroup */.AL)(this._arrowManipulatorInfos.map((({manipulator:e},o)=>(0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(e,((e,s,n,l,p)=>{const u=s.next((t=>({...t,manipulatorType:ManipulatorType_A.TRANSLATE_XY}))).next((0,dragEventPipeline/* dragAtLocation */.kY)(this._view,e.elevationAlignedLocation)).next(dragEventPipeline3D_N(this._view,e.elevationAlignedLocation,a,r,i)).next((0,dragEventPipeline/* constrainToMapAxis */.M2)(e.location,this.angle+(o+1)*Math.PI*.5)).next((0,dragEventPipeline/* addScreenDelta */.zh)());t(e,u,n,l,p)})))))}get angle(){return this._angle}set angle(t){this._angle=t,this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform()}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get radius(){return this._radius}set radius(t){this._radius!==t&&(this._radius=t,this._updateManipulators())}_updateManipulators(){for(let t=0;t<this._arrowManipulatorInfos.length;t++)this._updateArrowManipulator(this._arrowManipulatorInfos[t],t);this._updateManipulatorTransform()}_updateArrowManipulator({manipulator:t,transform:a},r){const e=this._radius/config_e,i=c*e,o=i*Math.sqrt(3)/2,p=GeometryUtil/* default.createExtrudedTriangle */.Z.createExtrudedTriangle(o,i/2,i/2,config_M);GeometryUtil/* default.transformInPlace */.Z.transformInPlace(p,(0,mat4.f)(vectorStacks/* sm4d.get */.MP.get(),(0,vec3.s)(vectorStacks/* sv3d.get */.WM.get(),0,-o/3,0))),t.renderObjects=[{geometry:p,material:this._opaqueMaterial,stateMask:interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused},{geometry:p,material:this._transparentMaterial,stateMask:interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused}],t.radius=o/3*2*1.2;const u=(0,mat4.b)(vectorStacks/* sm4d.get */.MP.get(),r*Math.PI/2),h=(0,mat4.f)(vectorStacks/* sm4d.get */.MP.get(),(0,vec3.s)(vectorStacks/* sv3d.get */.WM.get(),0,config_o*e,0));(0,mat4.m)(a,u,h)}_createManipulators(){for(let t=0;t<4;t++){const a=this._createArrowManipulator(t);this._arrowManipulatorInfos.push(a)}this._updateManipulatorTransform()}_updateManipulatorTransform(){const t=this.angle,a=(0,mat4.d)(vectorStacks/* sm4d.get */.MP.get(),t,(0,vec3f64.f)(0,0,1)),r=(0,mat4.u)(vectorStacks/* sm4d.get */.MP.get(),(0,vec3.s)(vectorStacks/* sv3d.get */.WM.get(),this.displayScale,this.displayScale,this.displayScale)),e=(0,mat4.m)(vectorStacks/* sm4d.get */.MP.get(),r,a);for(const i of this._arrowManipulatorInfos){const t=(0,mat4.m)(vectorStacks/* sm4d.get */.MP.get(),e,i.transform);i.manipulator.modelTransform=t}}_createArrowManipulator(t){const a=new Manipulator3D/* Manipulator3D */.Z({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,vec3f64.f)(0,0,1)}}),r={manipulator:a,transform:(0,mat4f64.c)()};return this._updateArrowManipulator(r,t),this._handles.add(a.events.on("drag",(t=>{this._updateAfterDrag&&"end"===t.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1)}))),r}_createMaterial(a=1){const r=Color/* default.toUnitRGBA */.Z.toUnitRGBA(settings/* colors.main */.O9.main);return r[3]*=a,new ColorMaterial/* ColorMaterial */.E({color:r,transparent:1!==a,cullFace:basicInterfaces/* CullFaceOptions.Back */.Vr.Back,renderOccluded:Material/* RenderOccludedFlag.Transparent */.yD.Transparent})}get test(){return{arrowManipulators:this._arrowManipulatorInfos.map((({manipulator:t})=>t))}}}\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/snapping/SnapToScene.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass SnapToScene_a{constructor(){this.view=null,this.elevationInfo=null,this.lastDragEvent=null,this.next=new dragEventPipeline/* EventPipeline */.hM,this._enabled=!1}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e&&(0,maybe/* isSome */.pC)(this.lastDragEvent)){const n=this.lastDragEvent.mapEnd,a=this._snap(this.lastDragEvent.screenEnd);if((0,maybe/* isSome */.pC)(a)){const t={action:"update",mapStart:this.lastDragEvent.mapStart,mapEnd:!0===e?a:n,screenStart:this.lastDragEvent.screenEnd,screenEnd:this.lastDragEvent.screenEnd};this.next.execute(t)}}this._enabled=e}_snap(n){const a=(0,maybe/* isSome */.pC)(this.view)?this.view.toMap(n,{exclude:[]}):null;return (0,maybe/* isSome */.pC)(a)&&(0,maybe/* isSome */.pC)(this.view)&&(a.z=(0,elevationInfoUtils/* getZForElevationMode */.Ou)(a,this.view,this.elevationInfo)),a}createDragEventPipelineStep(e,n){return this.view=e,this.elevationInfo=n,this.lastDragEvent=null,e=>{if(this.lastDragEvent="end"!==e.action?{...e}:null,this._enabled){const n=this._snap(e.screenEnd);return (0,maybe/* isSome */.pC)(n)?{action:e.action,mapStart:e.mapStart,mapEnd:n,screenStart:e.screenStart,screenEnd:e.screenEnd}:null}return{action:e.action,mapStart:e.mapStart,mapEnd:e.mapEnd,screenStart:e.screenStart,screenEnd:e.screenEnd}}}}\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveXYDiscManipulation.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass MoveXYDiscManipulation_A extends Manipulation_t{constructor(t){super(),this._handles=new Handles/* default */.Z,this._snapToScene=new SnapToScene_a,this._discMaterial=this._createMaterial(),this._discMaterialTransparent=this._createMaterial(.5),this._scale=1,this._radius=config_e,this._view=t.view,this._tool=t.tool,null!=t.snapToScene&&(this.snapToScene=t.snapToScene),null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._handles.destroy(),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null}forEachManipulator(t){t(this._manipulator,ManipulatorType_A.TRANSLATE_XY)}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get snapToScene(){return this._snapToScene.enabled}set snapToScene(t){this._snapToScene.enabled=t}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator())}createGraphicDragPipeline(t,e,a){const r=e.graphic,s=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(r),o=(0,maybe/* unwrap */.Wg)(r.geometry).spatialReference;return moveUtils_r(e,a,(e=>this.createDragPipeline(((i,a,r,s,o)=>e(i,t(i,a,r,s,o),r)),s,o,r)),this._view.state.viewingMode)}createDragPipeline(t,e,i,a){const r=this._view;return (0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(this._manipulator,((s,o,n,l,p)=>{const c=o.next((0,dragEventPipeline/* dragAtLocation */.kY)(r,s.elevationAlignedLocation)).next(dragEventPipeline3D_N(r,s.elevationAlignedLocation,e,i,a)).next(this._snapToScene.createDragEventPipelineStep(r,e),this._snapToScene.next).next((t=>({...t,manipulatorType:ManipulatorType_A.TRANSLATE_XY}))).next((0,dragEventPipeline/* addScreenDelta */.zh)());t(s,c,n,l,p)}))}_updateManipulatorTransform(){const t=(0,mat4.u)(vectorStacks/* sm4d.get */.MP.get(),(0,vec3.s)(vectorStacks/* sv3d.get */.WM.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=t}_createManipulator(){const t=this._view;this._manipulator=new Manipulator3D/* Manipulator3D */.Z({view:t,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,vec3f64.f)(0,0,1)},worldOriented:!0}),this._updateManipulator()}_updateManipulator(){const t=GeometryUtil/* default.createCylinderGeometry */.Z.createCylinderGeometry(config_M,1,config_a,(0,vec3f64.f)(0,0,1),(0,vec3f64.f)(0,0,0)),e=(0,mat4.u)((0,mat4f64.c)(),(0,vec3f64.f)(this._radius,this._radius,this._radius));this._manipulator.renderObjects=[{geometry:t,material:this._discMaterial,transform:e,stateMask:interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused},{geometry:t,material:this._discMaterialTransparent,transform:e,stateMask:interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused}],this._manipulator.radius=h*(this._radius/config_e)}_createMaterial(e=1){const i=Color/* default.toUnitRGBA */.Z.toUnitRGBA(settings/* colors.main */.O9.main);return i[3]*=e,new ColorMaterial/* ColorMaterial */.E({color:i,transparent:1!==e,cullFace:basicInterfaces/* CullFaceOptions.Back */.Vr.Back,renderOccluded:Material/* RenderOccludedFlag.Transparent */.yD.Transparent})}get test(){return{discManipulator:this._manipulator}}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/colorUtils.js\nvar colorUtils = __webpack_require__(39043);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveZManipulation.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass MoveZManipulation_O extends Manipulation_t{constructor(t){super(),this._handles=new Handles/* default */.Z,this._radius=config_e,this.events=new Evented/* default */.Z,this._tool=t.tool,this._view=t.view,null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._handles.destroy(),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()}))}forEachManipulator(t){t(this._manipulator,ManipulatorType_A.TRANSLATE_Z)}createGraphicDragPipeline(t,e,r){const a=(0,maybe/* unwrap */.Wg)(e.graphic.geometry).spatialReference;return moveUtils_r(e,r,(e=>this.createDragPipeline(((r,a,i,o,s)=>e(r,t(r,a,i,o,s),i)),a)),this._view.state.viewingMode)}createDragPipeline(t,e){const r=this._view;return (0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(this._manipulator,((a,i,o,s,n)=>{const l=i.next((t=>({...t,manipulatorType:ManipulatorType_A.TRANSLATE_Z}))).next(dragEventPipeline3D_G(r,a.renderLocation,e)).next((0,dragEventPipeline/* addScreenDelta */.zh)());t(a,l,o,s,n)}))}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator())}_updateManipulator(){const e=this._radius/config_e,r=settings/* settings.zManipulator.height */.Xd.zManipulator.height*e,a=settings/* settings.zManipulator.coneHeight */.Xd.zManipulator.coneHeight*e,i=settings/* settings.zManipulator.coneWidth */.Xd.zManipulator.coneWidth*e,m=settings/* settings.zManipulator.width */.Xd.zManipulator.width*e,c=[(0,vec3f64.f)(0,0,0),(0,vec3f64.f)(0,0,r)],p=GeometryUtil/* default.createTubeGeometry */.Z.createTubeGeometry(c,m/2,16,!1),u=GeometryUtil/* default.createConeGeometry */.Z.createConeGeometry(a,i/2,16,!1),d=[(0,vec3f64.f)(0,0,0),(0,vec3f64.f)(0,0,r+a)],h=t=>{const e=(0,mat4f64.c)();if((0,mat4.j)(e,e,[0,0,r]),(0,mat4.r)(e,e,Math.PI/2),t){const r=1+2*t/i;(0,mat4.h)(e,e,[r,r,r])}return e},f=h(0),M=(e,r)=>{const a=(0,colorUtils/* darken */._j)(settings/* settings.zManipulator.color */.Xd.zManipulator.color,r);return[a.r/255,a.g/255,a.b/255,settings/* settings.zManipulator.color.a */.Xd.zManipulator.color.a*e]},j=(0,manipulatorUtils/* createManipulatorMaterial */.EA)(M(1,.25),Material/* RenderOccludedFlag.Occlude */.yD.Occlude),y=(0,manipulatorUtils/* createManipulatorMaterial */.EA)(M(1,0),Material/* RenderOccludedFlag.Occlude */.yD.Occlude),b=(0,manipulatorUtils/* createManipulatorMaterial */.EA)(M(.7,0),settings/* settings.zManipulator.renderOccluded */.Xd.zManipulator.renderOccluded),k=(0,manipulatorUtils/* createManipulatorMaterial */.EA)(M(.85,0),settings/* settings.zManipulator.renderOccluded */.Xd.zManipulator.renderOccluded);this._manipulator.renderObjects=[{geometry:u,transform:f,material:j,stateMask:interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused},{geometry:p,material:j,stateMask:interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused},{geometry:u,transform:f,material:y,stateMask:interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused},{geometry:p,material:y,stateMask:interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused},{geometry:u,transform:f,material:b,stateMask:interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused},{geometry:p,material:b,stateMask:interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused},{geometry:u,transform:f,material:k,stateMask:interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused},{geometry:p,material:k,stateMask:interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused}],this._manipulator.radius=m/2+2,this._manipulator.collisionType={type:"line",paths:[d]}}_createManipulator(){const t=new Manipulator3D/* Manipulator3D */.Z({view:this._view,autoScaleRenderObjects:!1,worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});t.applyObjectTransform=t=>{const e=this._view.state.camera,r=MoveZManipulation_A;this._view.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,r);const i=(0,vec3.j)(e.eye,r),o=e.computeRenderPixelSizeAtDist(i),s=(0,vec3.f)(MoveZManipulation_x,r,e.eye);(0,vec3.n)(s,s);const n=MoveZManipulation_D;this._view.renderCoordsHelper.worldUpAtPosition(MoveZManipulation_A,n);const l=Math.abs((0,vec3.d)(s,n)),f=(0,vec3.c)(MoveZManipulation_x,s,n),_=(0,vec3.c)(MoveZManipulation_x,f,n),M=(0,mathUtils/* clamp */.uZ)(l,.01,1),g=1-Math.sqrt(1-M*M)/M/e.fullWidth,j=this._radius/config_e,y=settings/* settings.zManipulator.width */.Xd.zManipulator.width*j;(0,vec3.a)(_,(0,vec3.n)(_,_),(1/g-1)*i+o*y),t[12]-=MoveZManipulation_x[0],t[13]-=MoveZManipulation_x[1],t[14]-=MoveZManipulation_x[2]},this._manipulator=t,this._updateManipulator()}get test(){return{manipulator:this._manipulator}}}const MoveZManipulation_A=(0,vec3f64.c)(),MoveZManipulation_x=(0,vec3f64.c)(),MoveZManipulation_D=(0,vec3f64.c)();\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveManipulation.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass MoveManipulation_u extends Manipulation_t{constructor(a){super(),this._handles=new Handles/* default */.Z,this._angleDeferred=null,this._interactive=!0;const{tool:t,view:e,snapToScene:n,radius:s}=a;this._view=e,this.xyManipulation=new MoveXYDiscManipulation_A({tool:t,view:e,snapToScene:n,radius:s}),this.xyAxisManipulation=new O({tool:t,view:e,radius:s}),this.zManipulation=new MoveZManipulation_O({tool:t,view:e,radius:s}),this.xyManipulation.available=a.xyAvailable,this.xyAxisManipulation.available=a.xyAxisAvailable,this.zManipulation.available=a.zAvailable,this._autoHideXYAxis(),this.forEachManipulator((i=>{this._handles.add(i.events.on("grab-changed",(()=>this._updateManipulatorInteractivity())))}))}destroy(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()}createGraphicDragPipeline(i,t,e){return (0,handleUtils/* handlesGroup */.AL)([this.xyManipulation.createGraphicDragPipeline(((a,t,e,n,s)=>i(MoveManipulation_M.XY,a,t,e,n,s)),t,e),this.xyAxisManipulation.createGraphicDragPipeline(((a,t,e,n,s)=>i(MoveManipulation_M.XY_AXIS,a,t,e,n,s)),t,e),this.zManipulation.createGraphicDragPipeline(((a,t,e,n,s)=>i(MoveManipulation_M.Z,a,t,e,n,s)),t,e)])}createDragPipeline(i,t,e,n){return (0,handleUtils/* handlesGroup */.AL)([this.xyManipulation.createDragPipeline(((a,t,e,n,s)=>i(MoveManipulation_M.XY,a,t,e,n,s)),t,e,n),this.xyAxisManipulation.createDragPipeline(((a,t,e,n,s)=>i(MoveManipulation_M.XY_AXIS,a,t,e,n,s)),t,e,n),this.zManipulation.createDragPipeline(((a,t,e,n,s)=>i(MoveManipulation_M.Z,a,t,e,n,s)),e)])}set snapToScene(i){this.xyManipulation.snapToScene=i}set angle(i){this._angleDeferred=null,this.xyAxisManipulation.angle=i}set angleDeferred(i){this.xyAxisVisible?this.angle=i():this._angleDeferred=i}set interactive(i){this._interactive!==i&&(this._interactive=i,this._updateManipulatorInteractivity())}set radius(i){this.xyAxisManipulation.radius=i,this.xyManipulation.radius=i,this.zManipulation.radius=i}set displayScale(i){this.xyManipulation.displayScale=i,this.xyAxisManipulation.displayScale=i}forEachManipulator(i){this.xyManipulation.forEachManipulator((a=>i(a,ManipulatorType_A.TRANSLATE_XY))),this.xyAxisManipulation.forEachManipulator((a=>i(a,ManipulatorType_A.TRANSLATE_XY))),this.zManipulation.forEachManipulator((a=>i(a,ManipulatorType_A.TRANSLATE_Z)))}get xyAxisVisible(){const i=this.xyManipulation.someManipulator((i=>i.focused))||this.xyAxisManipulation.someManipulator((i=>i.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||i}_autoHideXYAxis(){const i=this.xyAxisManipulation,a=this.xyManipulation;if((0,has/* default */.Z)("esri-mobile"))return;const n=[];a.forEachManipulator((i=>n.push(i))),i.forEachManipulator((i=>n.push(i)));const s=()=>{const a=[];this.xyAxisVisible?(0,maybe/* isSome */.pC)(this._angleDeferred)&&(this.angle=this._angleDeferred()):i.forEachManipulator((i=>a.push(i.disableDisplay()))),this._handles.remove(MoveManipulation_c),this._handles.add(a,MoveManipulation_c)};for(const t of n)this._handles.add(t.events.on("focus-changed",s));this._view.inputManager&&this._handles.add(this._view.inputManager.watch("latestPointerType",s)),s()}_updateManipulatorInteractivity(){const i=this.grabbing;this.forEachManipulator((a=>{a.interactive=!i&&this._interactive||a.grabbing}))}static radiusForSymbol(i){const a=(0,maybe/* isSome */.pC)(i)&&"point-3d"===i.type&&i.symbolLayers;return!!a&&a.length>0&&a.some((i=>"icon"===i.type))?config_I:config_e}}const MoveManipulation_c="disable-xy-axis-display";var MoveManipulation_M;!function(i){i[i.XY=0]="XY",i[i.XY_AXIS=1]="XY_AXIS",i[i.Z=2]="Z"}(MoveManipulation_M||(MoveManipulation_M={}));\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/GraphicManipulator.js\nvar GraphicManipulator = __webpack_require__(4641);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/manipulations/MoveXYGraphicManipulation.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass MoveXYGraphicManipulation_h extends Manipulation_t{constructor(i){super(),this._handles=new Handles/* default */.Z,this._view=i.view,this._tool=i.tool,this._graphicState=i.graphicState,this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._handles.destroy(),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._graphicState=null}forEachManipulator(t){t(this._manipulator,ManipulatorType_A.TRANSLATE_XY)}createGraphicDragPipeline(t){return moveUtils_r(this._graphicState,t,(t=>this.createDragPipeline(t)),this._view.state.viewingMode)}createDragPipeline(t){const r=this._view,a=this._graphicState.graphic,o=(0,maybe/* isSome */.pC)(a.geometry)?a.geometry.spatialReference:null;return (0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(this._manipulator,((i,s,p,h,c)=>{const m=s.next(dragEventPipeline3D_h(c,r,a,o)).next((0,dragEventPipeline/* addMapDelta */.AN)()).next((0,dragEventPipeline/* addScreenDelta */.zh)());t(i,m,p,h,c)}))}_createManipulator(){const t=this._view,i=this._graphicState.graphic;this._manipulator=new GraphicManipulator/* GraphicManipulator */.L({graphic:i,view:t,selectable:!0,cursor:"move"})}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic.js\nvar isSupportedGraphic = __webpack_require__(84123);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/InteractiveToolBase.js + 1 modules\nvar InteractiveToolBase = __webpack_require__(68610);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/editGeometry/EditGeometryOperations.js + 6 modules\nvar EditGeometryOperations = __webpack_require__(62177);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/snapping/SnappingContext.js\nvar SnappingContext = __webpack_require__(73080);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/snapping/SnappingDragPipelineStep.js\nvar SnappingDragPipelineStep = __webpack_require__(73464);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/moveGraphic/GraphicMoveTool.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass Y{constructor(t){this.allGraphics=t,this.type="graphic-move-start"}}class GraphicMoveTool_z{constructor(t,e,i){this.dx=t,this.dy=e,this.allGraphics=i,this.type="graphic-move"}}class GraphicMoveTool_H{constructor(t){this.allGraphics=t,this.type="graphic-move-stop"}}let GraphicMoveTool_R=class extends((0,HandleOwner/* HandleOwnerMixin */.p)(Evented/* default.EventedMixin */.Z.EventedMixin(InteractiveToolBase/* InteractiveToolBase */.m))){constructor(t){super(t),this.graphics=new Collection/* default */.Z,this.enableZ=!0,this.type="move-3d",this._toolHandles=new Handles/* default */.Z,this.snappingPipeline=new SnappingDragPipelineStep/* SnappingPipeline */.n}initialize(){this._toolHandles.add([this.graphics.on("change",(()=>this._refreshManipulators()))]),this._refreshManipulators(),this.finishToolCreation()}destroy(){this._toolHandles.destroy(),this._toolHandles=null,this.graphics.removeAll(),this._set("view",null)}get updating(){return this.updatingHandles.updating}reset(){}_refreshManipulators(){this.handles.removeAll(),this._moveManipulation&&this._moveManipulation.destroy(),this.manipulators.removeAll();const t=this.graphics.toArray().filter((t=>(0,isSupportedGraphic/* isSupportedGraphic */.P)(t)===isSupportedGraphicUtils/* SupportedGraphicResult.SUPPORTED */.e.SUPPORTED)).map((t=>new GraphicMoveTool_U(t)));t.length&&(this._createManipulators(t),this._createVisualElements(t),this.handles.add(t.map((t=>this.view.trackGraphicState(t.state)))),this._updateMoveManipulation(t))}_createManipulators(t){for(const e of t){const i=e.state;e.manipulationXY=new MoveXYGraphicManipulation_h({tool:this,view:this.view,graphicState:i}),e.manipulationXY.forEachManipulator((t=>this.handles.add(t.events.on("immediate-click",(t=>{this.emit("immediate-click",{...t,graphic:i.graphic}),t.stopPropagation()}))))),this.handles.add(e.manipulationXY.createDragPipeline(((e,i,a,n)=>this._buildDragEventPipeline(t,MoveManipulation_M.XY,e,i,a,n))))}this._createMoveManipulation(t)}_createMoveManipulation(t){const e=new MoveManipulation_u({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===t.length?MoveManipulation_u.radiusForSymbol(t[0].graphic.symbol):config_e});this._moveManipulation=e,e.elevationInfo={mode:"absolute-height",offset:0},e.forEachManipulator((t=>{this.handles.add(t.events.on("immediate-click",(i=>{e.zManipulation.hasManipulator(t)||1!==this.graphics.length||this.emit("immediate-click",{...i,graphic:this.graphics.getItemAt(0)}),i.stopPropagation()})))}));const i=()=>this._updateMoveManipulation(t);for(const n of t)this.handles.add([n.state.on("changed",i),n.state.watch("displaying",i)]);const a=t[t.length-1];this.handles.add(a.state.on("changed",(()=>this._updateMoveManipulationAngle(a)))),this.handles.add(e.createDragPipeline(((e,i,a,n,o)=>this._buildDragEventPipeline(t,e,i,a,n,o)),(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(a.graphic),(0,maybe/* unwrap */.Wg)(a.graphic.geometry).spatialReference,a.graphic)),this._updateMoveManipulationAngle(a)}_createVisualElements(t){for(const e of t){const i=e.graphic,a=visualElementUtils_i({view:this.view,graphic:i,forEachManipulator:t=>{e.manipulationXY.forEachManipulator(t),this._moveManipulation.forEachManipulator(t)},onManipulatorsChanged:()=>(0,handleUtils/* makeHandle */.kB)()});(0,maybe/* isNone */.Wi)(a)||(e.geometryRepresentation=a.visualElement,e.geometryRepresentation instanceof OutlineVisualElement/* OutlineVisualElement */.k&&this.handles.add([e.geometryRepresentation.events.on("attachment-origin-changed",(()=>{e.state.isDraped||this._updateMoveManipulation(t)})),e.state.watch("isDraped",(()=>this._updateMoveManipulation(t)))]),this.handles.add(a))}}_updateMoveManipulationAngle(t){this._moveManipulation.angleDeferred=()=>moveUtils_a(t.graphic.geometry)}_updateMoveManipulation(t){const e=(0,dehydratedFeatures/* makeDehydratedPoint */.Tx)(0,0,0,this.view.spatialReference);let i=0,a=!1;const n=this._moveManipulation;for(const o of t){if(!o.state.displaying)continue;const t=o.state.graphic;this.enableZ&&manipulatorUtils_t(t)&&(a=!0);const n=o.geometryRepresentation instanceof OutlineVisualElement/* OutlineVisualElement */.k&&!o.state.isDraped?o.geometryRepresentation.attachmentOrigin:(0,manipulatorUtils/* getGraphicAttachmentOrigin */.du)(this.view,t);(0,maybe/* isSome */.pC)(n)&&(e.x+=n.x,e.y+=n.y,e.z+=n.z,i++)}i>0?(e.x/=i,e.y/=i,e.z/=i,n.location=e,n.xyManipulation.available=!0,n.xyAxisManipulation.available=!0,n.zManipulation.available=a):n.available=!1}_buildDragEventPipeline(t,e,i,a,n,o){const s=[],r=[];let p=null,l=null;const h=()=>{for(const t of s)t.dragging=!1;s.length=0,r.length=0,p=null,l=null,this._moveManipulation.interactive=!0};if(1===t.length&&e===MoveManipulation_M.XY){const e=t[0].graphic;a=this._buildSnappingPipelineSteps(e,(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(e),a,n,o)}const c=a.next((e=>{if("start"===e.action){s.length=0,r.length=0;for(const e of t)e.dragging||!e.manipulationXY.hasManipulator(i)&&e.manipulationXY.grabbing||(s.push(e),r.push(e.graphic),e.dragging=!0);if(0!==r.length&&(this._moveManipulation.interactive=!1,p=(0,dragEventPipeline/* dragGraphicMany */.oq)(r,this.view.state.viewingMode),l=(0,dragEventPipeline/* resetGraphicMany */.QY)(r),this.emit("graphic-move-start",new Y(r)),this.destroyed))return null}return 0!==r.length?e:null})).next((t=>p(t))).next((t=>{switch(t.action){case"start":case"update":if(t.translationX||t.translationY||t.translationZ){const e=this.view.toScreen(t.mapStart),i=this.view.toScreen(t.mapEnd),a=i.x-e.x,n=i.y-e.y;if(this.emit("graphic-move",new GraphicMoveTool_z(a,n,r)),this.destroyed)return null}break;case"end":if(this.emit("graphic-move-stop",new GraphicMoveTool_H(r)),this.destroyed)return null;h()}}));return n.next((t=>l(t))).next((()=>{if(this.emit("graphic-move-stop",new GraphicMoveTool_H(r)),this.destroyed)return null;h()})),c}_buildSnappingPipelineSteps(t,e,i,a,n){const o=t.geometry;if((0,maybe/* isNone */.Wi)(o)||"point"!==o.type&&"mesh"!==o.type)return i;const s=("point"===o.type?o:o.anchor).clone(),p=new SnappingContext/* SnappingContext */.N({elevationInfo:e,pointer:n,editGeometryOperations:EditGeometryOperations/* EditGeometryOperations.fromGeometry */.c.fromGeometry(s,this.view.state.viewingMode),visualizer:new g,excludeFeature:t}),l=this.snappingManager;return i.next((e=>{s.z=(0,elevationInfoUtils/* getConvertedElevation */.vQ)(this.view,s,(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(t),{mode:"absolute-height",offset:0});return{...e,snapOrigin:p.coordinateHelper.pointToVector(s)}})).next(this.snappingPipeline.createSnapDragEventPipelineStep({snappingContext:p,snappingManager:l,cancel:a,updatingHandles:this.updatingHandles}),this.snappingPipeline.next)}};(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicMoveTool_R.prototype,"view",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],GraphicMoveTool_R.prototype,"graphics",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicMoveTool_R.prototype,"enableZ",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],GraphicMoveTool_R.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],GraphicMoveTool_R.prototype,"type",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],GraphicMoveTool_R.prototype,"updating",null),GraphicMoveTool_R=(0,tslib_es6._)([(0,subclass/* subclass */.j)("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMoveTool")],GraphicMoveTool_R);class GraphicMoveTool_U{constructor(t){this.state=null,this.geometryRepresentation=null,this.manipulationXY=null,this.dragging=!1,this.state=new GraphicState/* GraphicState */.F({graphic:t})}get graphic(){return this.state.graphic}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic.js\nvar reshapeGraphic_isSupportedGraphic = __webpack_require__(38950);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Polyline.js\nvar Polyline = __webpack_require__(90819);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/symbols/support/utils.js\nvar utils = __webpack_require__(59672);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/editGeometry/operations/OffsetEdgeVertex.js\nvar OffsetEdgeVertex = __webpack_require__(77571);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/reshapeGraphic/edgeOffsetUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction edgeOffsetUtils_j(e,r,o){const n="on-the-ground"===o.mode?OffsetEdgeVertex/* PlaneType.XY */.v.XY:OffsetEdgeVertex/* PlaneType.XYZ */.v.XYZ;return new OffsetEdgeVertex/* OffsetEdgeVertex */.A(e,n,r,0)}function edgeOffsetUtils_h(r,o,n){const s=(0,vec3f64.c)();if(!r.renderCoordsHelper.toRenderCoords(o,s))return null;const c=edgeOffsetUtils_y(r,o,(0,plane/* normal */.mJ)(n.plane)),i=edgeOffsetUtils_y(r,o,n.edgeDirection);if((0,maybe/* isNone */.Wi)(c)||(0,maybe/* isNone */.Wi)(i))return null;const u=(0,vec3.c)((0,vec3f64.c)(),c,i);return (0,plane/* fromPositionAndNormal */.Yq)(s,u,(0,plane/* create */.Ue)())}function edgeOffsetUtils_y(e,r,o){const n=(0,dehydratedFeatures/* makeDehydratedPoint */.Tx)(r.x+o[0],r.y+o[1],r.z+o[2],r.spatialReference),t=(0,vec3f64.c)(),c=(0,vec3f64.c)();return e.renderCoordsHelper.toRenderCoords(r,t)&&e.renderCoordsHelper.toRenderCoords(n,c)?(0,vec3.r)(c,t,c):null}function edgeOffsetUtils_C(e,r,o){const c=(0,plane/* normal */.mJ)(e),i=(0,vec3.r)((0,vec3f64.c)(),r,o),p=(0,vec3.c)((0,vec3f64.c)(),i,c),m=(0,vec3.c)((0,vec3f64.c)(),i,p);return (0,mat4f64.f)(i[0],i[1],i[2],0,p[0],p[1],p[2],0,m[0],m[1],m[2],0,0,0,0,1)}function edgeOffsetUtils_R(e,n,t){const s=t.projectToRenderScreen(e,(0,screenUtils/* createRenderScreenPointArray3 */.J$)()),d=t.projectToRenderScreen(n,(0,screenUtils/* createRenderScreenPointArray3 */.J$)());return (0,maybe/* isSome */.pC)(s)&&(0,maybe/* isSome */.pC)(d)?(0,vec3.p)((0,vec3.f)(s,s,d)):0}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/input/IViewEvents.js\nvar IViewEvents = __webpack_require__(51986);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/editGeometry/interfaces.js\nvar editGeometry_interfaces = __webpack_require__(26817);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/reshapeGraphic/ReshapeOperation.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nlet pe=class extends(Evented/* default.EventedMixin */.Z.EventedMixin(HandleOwner/* HandleOwner */.r)){constructor(e){super(e),this._vertexManipulatorMaterial=(0,manipulatorUtils/* createManipulatorMaterial */.EA)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.vertex.color */.Xd.reshapeManipulators.vertex.color),settings/* settings.reshapeManipulators.vertex.renderOccluded */.Xd.reshapeManipulators.vertex.renderOccluded),this._vertexManipulatorOutlineMaterial=(0,manipulatorUtils/* createManipulatorOutlineMaterial */.qJ)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.vertex.outlineColor */.Xd.reshapeManipulators.vertex.outlineColor),settings/* settings.reshapeManipulators.vertex.renderOccluded */.Xd.reshapeManipulators.vertex.renderOccluded),this._vertexManipulatorHoverOutlineMaterial=(0,manipulatorUtils/* createManipulatorOutlineMaterial */.qJ)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.vertex.hoverOutlineColor */.Xd.reshapeManipulators.vertex.hoverOutlineColor),settings/* settings.reshapeManipulators.vertex.renderOccluded */.Xd.reshapeManipulators.vertex.renderOccluded),this._edgeManipulatorMaterial=(0,manipulatorUtils/* createManipulatorMaterial */.EA)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.edge.color */.Xd.reshapeManipulators.edge.color),settings/* settings.reshapeManipulators.edge.renderOccluded */.Xd.reshapeManipulators.edge.renderOccluded),this._edgeManipulatorOutlineMaterial=(0,manipulatorUtils/* createManipulatorOutlineMaterial */.qJ)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.edge.outlineColor */.Xd.reshapeManipulators.edge.outlineColor),settings/* settings.reshapeManipulators.edge.renderOccluded */.Xd.reshapeManipulators.edge.renderOccluded),this._edgeOffsetManipulatorMaterial=(0,manipulatorUtils/* createManipulatorMaterial */.EA)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.edgeOffset.color */.Xd.reshapeManipulators.edgeOffset.color),settings/* settings.reshapeManipulators.edgeOffset.renderOccluded */.Xd.reshapeManipulators.edgeOffset.renderOccluded,!1),this._edgeOffsetManipulatorHoverMaterial=(0,manipulatorUtils/* createManipulatorMaterial */.EA)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.edgeOffset.hoverColor */.Xd.reshapeManipulators.edgeOffset.hoverColor),settings/* settings.reshapeManipulators.edgeOffset.renderOccluded */.Xd.reshapeManipulators.edgeOffset.renderOccluded,!1),this._selectedManipulatorMaterial=(0,manipulatorUtils/* createManipulatorMaterial */.EA)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.selected.color */.Xd.reshapeManipulators.selected.color),settings/* settings.reshapeManipulators.selected.renderOccluded */.Xd.reshapeManipulators.selected.renderOccluded),this._selectedManipulatorOutlineMaterial=(0,manipulatorUtils/* createManipulatorOutlineMaterial */.qJ)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.selected.outlineColor */.Xd.reshapeManipulators.selected.outlineColor),settings/* settings.reshapeManipulators.selected.renderOccluded */.Xd.reshapeManipulators.selected.renderOccluded),this._selectedManipulatorHoverOutlineMaterial=(0,manipulatorUtils/* createManipulatorOutlineMaterial */.qJ)(settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* settings.reshapeManipulators.selected.hoverOutlineColor */.Xd.reshapeManipulators.selected.hoverOutlineColor),settings/* settings.reshapeManipulators.selected.renderOccluded */.Xd.reshapeManipulators.selected.renderOccluded),this._selectedIndex=0,this._vertexManipulatorGeometry=null,this._vertexManipulatorOutlineGeometry=null,this._edgeManipulatorGeometry=null,this._edgeManipulatorOutlineGeometry=null,this._edgeOffsetManipulatorGeometryInside=null,this._edgeOffsetManipulatorGeometryOutside=null,this._manipulatorHandles=new Handles/* default */.Z,this._manipulatorInfos=[],this._editGeometryOperations=null,this._graphicMoveManipulation=null,this._moveManipulation=null,this._numGrabbing=0,this._numDragging=0,this._reshapeEventState=_e.NONE,this._outlineVisualElement=null,this.tool=null,this.outputGeometry=null,this._snappingPipeline=new SnappingDragPipelineStep/* SnappingPipeline */.n,this._snappingPipelineHandle=new SnappingDragPipelineStep/* SnappingPipeline */.n,this._vertexLaserLineVisualElement=null}initialize(){const e=new GraphicState/* GraphicState */.F({graphic:this.graphic});this._graphicState=e,this.handles.add([e.watch("displaying",(e=>{for(const t of this._manipulatorInfos)t.manipulator.available=e})),this.view.trackGraphicState(e)])}destroy(){this._editGeometryOperations=(0,maybe/* destroyMaybe */.SC)(this._editGeometryOperations),this._moveManipulation=(0,maybe/* destroyMaybe */.SC)(this._moveManipulation),this._graphicMoveManipulation=(0,maybe/* destroyMaybe */.SC)(this._graphicMoveManipulation),this._manipulatorHandles=(0,maybe/* destroyMaybe */.SC)(this._manipulatorHandles),this.manipulators.removeAll(),this._manipulatorInfos=[],this._resetGrabbingDragging()}get inputGeometry(){return (0,maybe/* isSome */.pC)(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null}set inputGeometry(e){this._recreateEditGeometryAndManipulators(e)}get updating(){return this.updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get graphic(){return this.tool.graphic}get enableZShape(){return this.tool.enableZShape}get enableZVertex(){return this.tool.enableZVertex}get enableMoveGraphic(){return this.tool.enableMoveGraphic}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}removeSelectedVertices(){const e=this._manipulatorInfos.filter((e=>e.manipulator.selected&&"vertex"===e.handle.type));this._removeVertices(e)}manipulatorSelectionChanged(){this.emit("manipulators-changed")}_removeManipulators(){this._moveManipulation=(0,maybe/* destroyMaybe */.SC)(this._moveManipulation),this._graphicMoveManipulation=(0,maybe/* destroyMaybe */.SC)(this._graphicMoveManipulation),this._manipulatorHandles.removeAll(),this.manipulators.removeAll(),this._manipulatorInfos=[]}_resetGrabbingDragging(){this._numGrabbing=0,this._numDragging=0}_createManipulators(){if((0,maybe/* isNone */.Wi)(this._editGeometryOperations))return;const e=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(this.graphic);for(const t of this._editGeometryOperations.data.components){for(const i of t.vertices)this._createVertexOrEdgeManipulator(i,e);for(const i of t.edges)this._createVertexOrEdgeManipulator(i,e)}this._createGraphicMoveManipulators(e)}get canRedo(){return (0,maybe/* isSome */.pC)(this._editGeometryOperations)&&this._editGeometryOperations.canRedo}get canUndo(){return (0,maybe/* isSome */.pC)(this._editGeometryOperations)&&this._editGeometryOperations.canUndo}redo(){if((0,maybe/* isNone */.Wi)(this._editGeometryOperations))return null;const e=this._editGeometryOperations.redo();return (0,maybe/* isSome */.pC)(e)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),e}undo(){if((0,maybe/* isNone */.Wi)(this._editGeometryOperations))return null;this.emit("undo");const e=this._editGeometryOperations.undo();return (0,maybe/* isSome */.pC)(e)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),e}_recreateManipulators(){this._removeManipulators(),this._resetGrabbingDragging(),this._createManipulators()}_recreateEditGeometryAndManipulators(e=this.inputGeometry){this._removeManipulators(),this._resetGrabbingDragging(),(0,maybe/* isNone */.Wi)(e)||((0,maybe/* destroyMaybe */.SC)(this._editGeometryOperations),this._editGeometryOperations=EditGeometryOperations/* EditGeometryOperations.fromGeometry */.c.fromGeometry(e,this.view.state.viewingMode),this._createManipulators())}_perGraphicManipulatorDragAction(e,t){if("end"===t.action)return;let i=0;const a=[],n=this._manipulatorInfos.some((e=>"vertex"===e.handle.type&&e.manipulator.selected)),r=e===fe.SELECTED_OR_ALL&&n;for(const o of this._manipulatorInfos)de(o)&&(o.manipulator.grabbing||r&&!o.manipulator.selected||a.push(o),i++);if(0===a.length)return;this._moveVertices(a,t);if(a.length===i){if(this._updateEventState(_e.MOVING),this.destroyed)return;this.emit("move",{type:"move",dx:t.screenDeltaX,dy:t.screenDeltaY,mover:this.graphic})}else{if(this._updateEventState(_e.RESHAPING),this.destroyed)return;this.emit("reshape",{type:"reshape",mover:this.graphic})}}_isMultiVertexSelection(){let e=0;for(const t of this._manipulatorInfos)de(t)&&t.manipulator.selected&&e++;return e>1}_perVertexManipulatorDragAction(e){if(this._updateEventState(_e.RESHAPING),this.destroyed)return;const{mapDeltaX:t,mapDeltaY:i,mapDeltaZ:a}=e;if(!t&&!i&&!a)return;const n=[];for(const r of this._manipulatorInfos)de(r)&&(r.manipulator.selected&&!r.manipulator.grabbing||r===e.info)&&n.push(r);this._moveVertices(n,e,editGeometry_interfaces/* AccumulationBehaviour.ACCUMULATE_STEPS */.O.ACCUMULATE_STEPS),this.emit("reshape",{type:"reshape",mover:this.graphic})}_updateEventState(e){if(e===this._reshapeEventState)return!1;switch(e){case _e.NONE:if(0!==this._numGrabbing||0!==this._numDragging)return!1;switch(this._reshapeEventState){case _e.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic});break;case _e.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic})}break;case _e.MOVING:switch(this._reshapeEventState){case _e.NONE:this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});break;case _e.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic}),this.destroyed||this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic})}break;case _e.RESHAPING:switch(this._reshapeEventState){case _e.NONE:this.emit("reshape",{type:"reshape-start",mover:this.graphic});break;case _e.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic}),this.destroyed||this.emit("reshape",{type:"reshape-start",mover:this.graphic})}}if(this.destroyed)return!1;const t=this._reshapeEventState!==e;return this._reshapeEventState=e,t}_createGraphicMoveManipulators(e){if(this._graphicMoveManipulation=new MoveXYGraphicManipulation_h({tool:this.tool,view:this.view,graphicState:this._graphicState}),this.enableMoveGraphic){let e=null;this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline(((t,i,a)=>{i.next((e=>this._trackNumDragging(e))).next((t=>("start"===t.action&&(e=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations).createUndoGroup()),t))).next((t=>{this._perGraphicManipulatorDragAction(fe.ALL,t),"end"===t.action&&(e=(0,maybe/* removeMaybe */.hw)(e))})),a.next(this._cancelDragOperation((()=>e=(0,maybe/* removeMaybe */.hw)(e))))})))}else this._graphicMoveManipulation.forEachManipulator((e=>{e.grabbable=!1,e.cursor=null}));this._graphicMoveManipulation.forEachManipulator((e=>this._manipulatorHandles.add([this._watchAndUpdateGrabState(e,!1),e.events.on("immediate-click",(e=>{this._manipulatorInfos.some((e=>e.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...e,graphic:this.graphic}),e.stopPropagation()}))]))),this._moveManipulation=new MoveManipulation_u({tool:this.tool,view:this.view,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&manipulatorUtils_t(this.graphic),snapToScene:!1,radius:MoveManipulation_u.radiusForSymbol(this.graphic.symbol)}),this._moveManipulation.forEachManipulator((e=>{this.handles.add([this._watchAndUpdateGrabState(e,!1),e.events.on("immediate-click",(t=>{this._moveManipulation.zManipulation.hasManipulator(e)||this._manipulatorInfos.some((e=>e.manipulator.selected))||this.emit("immediate-click",{...t,graphic:this.graphic}),t.stopPropagation()}))])})),this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};const t=(0,maybe/* unwrap */.Wg)(this.graphic.geometry).spatialReference;this.handles.add([this._moveManipulation.createDragPipeline(((t,i,a,n,r)=>{const o=a.next((e=>this._trackNumDragging(e))).next((e=>{const t=this._manipulatorInfos.filter((e=>de(e)&&e.manipulator.selected));return e.manipulatorType===ManipulatorType_A.TRANSLATE_XY&&1===t.length?{...e,info:t[0],snapOrigin:t[0].handle.pos}:{...e,info:null}})).next(this._snappingPipelineHandle.createSnapDragEventPipelineStep({predicate:e=>!!e.info,cancel:n,snappingManager:this.tool.snappingManager,snappingContext:new SnappingContext/* SnappingContext */.N({editGeometryOperations:(0,maybe/* unwrap */.Wg)(this._editGeometryOperations),elevationInfo:e,pointer:r,excludeFeature:this.graphic,visualizer:new g}),updatingHandles:this.updatingHandles}),this._snappingPipelineHandle.next).next((0,dragEventPipeline/* addMapDelta */.AN)()).next((e=>(this._perGraphicManipulatorDragAction(fe.SELECTED_OR_ALL,e),e)));return n.next(this._cancelDragOperation()),o}),e,t,this.graphic),(0,watchUtils/* init */.S1)(this._graphicState,"displaying",(()=>{this._updateMoveManipulationPosition()})),this._graphicState.on("changed",(()=>this._updateMoveManipulationPosition())),(0,watchUtils/* init */.S1)(this._graphicState,"isDraped",(()=>{const e="align-move-manipulation";this._graphicState.isDraped?this.handles.add(this.view.elevationProvider.on("elevation-change",(()=>this._updateMoveManipulationPosition())),e):this.handles.remove(e)}))]),this._updateMoveManipulationPosition();const i=visualElementUtils_i({view:this.view,graphic:this.graphic,forEachManipulator:e=>{if(!this.destroyed){(0,maybe/* isSome */.pC)(this._graphicMoveManipulation)&&this._graphicMoveManipulation.forEachManipulator(e);for(const t of this._manipulatorInfos)e(t.manipulator,ManipulatorType_A.TRANSLATE_XY);this._moveManipulation.forEachManipulator(e)}},onManipulatorsChanged:e=>this.on("manipulators-changed",e)});(0,maybe/* isSome */.pC)(i)&&(this._outlineVisualElement=i.visualElement instanceof OutlineVisualElement/* OutlineVisualElement */.k?i.visualElement:null),(0,maybe/* isSome */.pC)(this._outlineVisualElement)&&this._manipulatorHandles.add([this._outlineVisualElement.events.on("attachment-origin-changed",(()=>{this._graphicState.isDraped||this._updateMoveManipulationPosition()})),this._graphicState.watch("isDraped",(()=>this._updateMoveManipulationPosition()))]),this._manipulatorHandles.add(i)}_createEdgeOffsetManipulator(e,t=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(this.graphic)){const i=settings/* settings.reshapeManipulators.edgeOffset */.Xd.reshapeManipulators.edgeOffset,a=i.size/2,r=a+i.collisionPadding;if((0,maybe/* isNone */.Wi)(this._edgeOffsetManipulatorGeometryInside)||(0,maybe/* isNone */.Wi)(this._edgeOffsetManipulatorGeometryOutside)){const e=a/r,t=e*Math.sqrt(3)/2;this._edgeOffsetManipulatorGeometryInside=GeometryUtil/* default.createExtrudedTriangle */.Z.createExtrudedTriangle(t,e/2,e/2,i.height,i.offset),this._edgeOffsetManipulatorGeometryOutside=GeometryUtil/* default.createExtrudedTriangle */.Z.createExtrudedTriangle(-t,e/2,e/2,i.height,-i.offset)}const o=[{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorMaterial,stateMask:interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorHoverMaterial,stateMask:interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused},{geometry:this._edgeOffsetManipulatorGeometryOutside,material:this._edgeOffsetManipulatorMaterial,stateMask:interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryOutside,material:this._edgeOffsetManipulatorHoverMaterial,stateMask:interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused}],p=new Manipulator3D/* Manipulator3D */.Z({view:this.view,renderObjects:o,elevationInfo:"on-the-ground"!==t.mode||(0,utils/* isVolumetricSymbol */.YW)(this.graphic.symbol)?{mode:"absolute-height",offset:0}:t,worldOriented:!1,focusMultiplier:1,radius:r,available:!(!this.graphic.visible||!this.graphic.layer.visible),collisionType:{type:"disc",direction:(0,vec3f64.f)(0,0,1)},collisionPriority:1}),h=new Manipulator3D/* Manipulator3D */.Z({view:this.view,renderObjects:[],worldSized:!0,worldOriented:!1,available:!(!this.graphic.visible||!this.graphic.layer.visible),collisionPriority:-10,cursor:this.enableMoveGraphic?"move":"default"}),d={manipulator:p,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:h,elevationInfo:t,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(d,i.minSquaredEdgeLength),this._updateEdgeOffsetManipulator(d);const u=this._getManipulatorInfoFromHandle(d.handle.leftVertex).manipulator.events.on("location-update",(()=>this._updateEdgeOffsetManipulator(d))),c=this._getManipulatorInfoFromHandle(d.handle.rightVertex).manipulator.events.on("location-update",(()=>this._updateEdgeOffsetManipulator(d)));d.locationUpdateHandle=(0,handleUtils/* handlesGroup */.AL)([u,c]),this._manipulatorHandles.add(d.locationUpdateHandle,p),this._manipulatorHandles.add([this._watchAndUpdateGrabState(p,!0),this._watchAndUpdateGrabState(h,!0)],p),this._manipulatorHandles.add((0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(p,this._createEdgeOffsetPipeline(d,t)),p),this._manipulatorHandles.add((0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(h,((e,i,a,n)=>{if("touch"===n){this._createEdgeOffsetPipeline(d,t)(e,i,a)}else if(this.enableMoveGraphic){const n=this.graphic,r=(0,maybe/* isSome */.pC)(n.geometry)?n.geometry.spatialReference:null;i.next((e=>this._trackNumDragging(e))).next((0,dragEventPipeline/* dragAtLocation */.kY)(this.view,e.elevationAlignedLocation)).next(dragEventPipeline3D_N(this.view,e.elevationAlignedLocation,t,r,n)).next((0,dragEventPipeline/* addScreenDelta */.zh)()).next((0,dragEventPipeline/* addMapDelta */.AN)()).next((e=>this._perGraphicManipulatorDragAction(fe.ALL,e))),a.next(this._cancelDragOperation())}})),p);const m=e=>{this._manipulatorInfos.some((e=>e.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...e,graphic:this.graphic}),e.stopPropagation()};return this._manipulatorHandles.add([p.events.on("immediate-click",m),h.events.on("immediate-click",m)],p),this._manipulatorInfos.push(d),this.manipulators.add(p),this.manipulators.add(h),this.emit("manipulators-changed"),d}_autoHideEdgeOffsetManipulator(e,t){const i=e.manipulator,a=e.edgeManipulator,r=()=>{(0,maybe/* removeMaybe */.hw)(e.visibilityHandle);const r=edgeOffsetUtils_R(this._getManipulatorInfoFromHandle(e.handle.leftVertex).manipulator.renderLocation,this._getManipulatorInfoFromHandle(e.handle.rightVertex).manipulator.renderLocation,this.view.state.camera)<t;(!i.focused&&!a.focused||r)&&(i.grabbable=!r,a.grabbable=!r,e.visibilityHandle=(0,handleUtils/* handlesGroup */.AL)([i.disableDisplay(),{remove:()=>{i.grabbable=!0,a.grabbable=this.enableMoveGraphic}}]))};this._manipulatorHandles.add([i.events.on("focus-changed",r),a.events.on("focus-changed",r),{remove:()=>{(0,maybe/* removeMaybe */.hw)(e.visibilityHandle),this.manipulators.remove(a)}}],i),r()}_updateEdgeOffsetManipulator(e){this._updateManipulatorPosition(e);const t=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations).data.coordinateHelper,i=edgeOffsetUtils_h(this.view,e.manipulator.elevationAlignedLocation,edgeOffsetUtils_j(t,e.handle,(0,maybe/* unwrap */.Wg)(e.manipulator.elevationInfo))),a=this._getManipulatorInfoFromHandle(e.handle.leftVertex).manipulator.renderLocation,n=this._getManipulatorInfoFromHandle(e.handle.rightVertex).manipulator.renderLocation,r=(0,maybe/* isSome */.pC)(i)?edgeOffsetUtils_C(i,a,n):mat4f64.I;e.manipulator.modelTransform=r,e.edgeManipulator.elevationAlignedLocation=e.manipulator.elevationAlignedLocation,e.edgeManipulator.modelTransform=r;const o=(0,vec3.l)((0,vec3.f)(me,a,n))/2;e.edgeManipulator.collisionType={type:"line",paths:[[[-o,0,0],[o,0,0]]]}}_createEdgeOffsetPipeline(e,t){return(i,a,n)=>{this._clearSelection();const{step:r,cleanup:o}=this._initializeEdgeOffset(e,t);a.next((e=>this._trackNumDragging(e))).next((0,dragEventPipeline/* dragAtLocation */.kY)(this.view,i.elevationAlignedLocation)).next(r).next(T(this.view)).next(F(this.view,(0,maybe/* unwrap */.Wg)(this._editGeometryOperations).data.spatialReference)).next((0,dragEventPipeline/* addMapDelta */.AN)()).next(this._applyEdgeOffsetStep(e)).next((e=>{"end"===e.action&&o()})),n.next((e=>(o(),e))).next(this._cancelDragOperation())}}_initializeEdgeOffset(e,t){const i=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations),a=edgeOffsetUtils_j(i.data.coordinateHelper,e.handle,t),o=i.createUndoGroup(),s=edgeOffsetUtils_h(this.view,e.manipulator.elevationAlignedLocation,a);a.requiresSplitEdgeLeft&&this._splitEdgeManipulator(this._getManipulatorInfoFromHandle(e.handle.leftVertex.leftEdge),1),a.requiresSplitEdgeRight&&this._splitEdgeManipulator(this._getManipulatorInfoFromHandle(e.handle.rightVertex.rightEdge),0);const d=()=>new Polyline/* default */.Z({paths:[[e.handle.leftVertex.pos,e.handle.rightVertex.pos]],spatialReference:(0,maybe/* unwrap */.Wg)(this._editGeometryOperations).data.spatialReference}),u=new OutlineVisualElement/* OutlineVisualElement */.k({view:this.view,isDraped:this._graphicState.isDraped,geometry:d(),elevationInfo:e.elevationInfo,width:settings/* settings.visualElements.lineGraphics.outline.width */.Xd.visualElements.lineGraphics.outline.width,color:settings/* settings.colorToVec4 */.Xd.colorToVec4(settings/* colors.main */.O9.main),attached:!0});let c;const m=()=>{this._cleanEdgeOffsetCollapsedEdges(e),c=(0,maybe/* removeMaybe */.hw)(c)},g=this.on("undo",m);return c=(0,handleUtils/* handlesGroup */.AL)([(0,handleUtils/* destroyHandle */.ed)(u),this._graphicState.watch("isDraped",(e=>u.isDraped=e)),this._graphicState.on("changed",(()=>u.geometry=d())),o,g]),{step:e=>(0,maybe/* isNone */.Wi)(a)||(0,maybe/* isNone */.Wi)(s)?(m(),null):{...e,operation:a,plane:s},cleanup:m}}_applyEdgeOffsetStep(e){return t=>{if(this.destroyed||(0,maybe/* isNone */.Wi)(t.operation))return t;this._updateEventState(_e.RESHAPING);const{mapDeltaX:i,mapDeltaY:a,mapDeltaZ:n}=t;return(i||a||n)&&(this._offsetEdge(e,t),this.emit("reshape",{type:"reshape",mover:this.graphic})),t}}_cleanEdgeOffsetCollapsedEdges(e){var t,i;const a=null==(t=e.handle.leftVertex.leftEdge)?void 0:t.leftVertex,n=e.handle.leftVertex,r=null==(i=e.handle.rightVertex.rightEdge)?void 0:i.rightVertex,o=e.handle.rightVertex,s=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations).data.coordinateHelper,l=1e-6,h=[];a&&s.distance(a.pos,n.pos)<l&&h.push(this._getManipulatorInfoFromHandle(n)),(s.distance(n.pos,o.pos)<l||r&&s.distance(r.pos,o.pos)<l)&&h.push(this._getManipulatorInfoFromHandle(o)),h.length&&this._removeVertices(h)}_computeVertexManipulatorSizeAndOutline(e){const t=e.size/2,i=t+e.collisionPadding;return{size:t/i,outlineSize:(t+e.outlineSize)/i}}_createVertexOrEdgeManipulator(e,t=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(this.graphic)){if("edge"===e.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(e,t);if(!this.enableMidpoints)return null}if((0,maybe/* isNone */.Wi)(this._vertexManipulatorGeometry)||(0,maybe/* isNone */.Wi)(this._vertexManipulatorOutlineGeometry)){const{size:e,outlineSize:t}=this._computeVertexManipulatorSizeAndOutline(settings/* settings.reshapeManipulators.vertex */.Xd.reshapeManipulators.vertex);this._vertexManipulatorGeometry=GeometryUtil/* default.createSphereGeometry */.Z.createSphereGeometry(e,16,16),this._vertexManipulatorOutlineGeometry=GeometryUtil/* default.createSphereGeometry */.Z.createSphereGeometry(t,16,16)}if((0,maybe/* isNone */.Wi)(this._edgeManipulatorGeometry)||(0,maybe/* isNone */.Wi)(this._edgeManipulatorOutlineGeometry)){const{size:e,outlineSize:t}=this._computeVertexManipulatorSizeAndOutline(settings/* settings.reshapeManipulators.edge */.Xd.reshapeManipulators.edge);this._edgeManipulatorGeometry=GeometryUtil/* default.createSphereGeometry */.Z.createSphereGeometry(e,16,16),this._edgeManipulatorOutlineGeometry=GeometryUtil/* default.createSphereGeometry */.Z.createSphereGeometry(t,16,16)}const i=(0,maybe/* isSome */.pC)(this.graphic.geometry)&&"point"===this.graphic.geometry.type?[]:[{geometry:this._vertexManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:ge.Vertex|interfaces/* ManipulatorStateFlags.Unselected */.Q9.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorOutlineMaterial,stateMask:ge.Vertex|interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused|interfaces/* ManipulatorStateFlags.Unselected */.Q9.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,stateMask:ge.Vertex|interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused|interfaces/* ManipulatorStateFlags.Unselected */.Q9.Unselected},{geometry:this._vertexManipulatorGeometry,material:this._selectedManipulatorMaterial,stateMask:interfaces/* ManipulatorStateFlags.Selected */.Q9.Selected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorOutlineMaterial,stateMask:interfaces/* ManipulatorStateFlags.Selected */.Q9.Selected|interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorHoverOutlineMaterial,stateMask:interfaces/* ManipulatorStateFlags.Selected */.Q9.Selected|interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused}];this.enableMidpoints&&i.push({geometry:this._edgeManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:ge.Edge|interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused|interfaces/* ManipulatorStateFlags.Unselected */.Q9.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,stateMask:ge.Edge|interfaces/* ManipulatorStateFlags.Focused */.Q9.Focused|interfaces/* ManipulatorStateFlags.Unselected */.Q9.Unselected},{geometry:this._edgeManipulatorGeometry,material:this._edgeManipulatorMaterial,stateMask:ge.Edge|interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused|interfaces/* ManipulatorStateFlags.Unselected */.Q9.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._edgeManipulatorOutlineMaterial,stateMask:ge.Edge|interfaces/* ManipulatorStateFlags.Unfocused */.Q9.Unfocused|interfaces/* ManipulatorStateFlags.Unselected */.Q9.Unselected});const a=new Manipulator3D/* Manipulator3D */.Z({view:this.view,renderObjects:i,elevationInfo:t,focusMultiplier:1,touchMultiplier:1,available:!(!this.graphic.visible||!this.graphic.layer.visible)});this._setTypeSpecificManipulatorSettings(a,e,t);const r="edge"===e.type?{manipulator:a,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:a,handle:e,type:"vertex",selectedIndex:0};if(this._manipulatorInfos.push(r),this.manipulators.add(a),this._updateManipulatorPosition(r),"edge"===r.type){const e=this._getManipulatorInfoFromHandle(r.handle.leftVertex).manipulator.events.on("location-update",(()=>this._updateManipulatorPosition(r))),t=this._getManipulatorInfoFromHandle(r.handle.rightVertex).manipulator.events.on("location-update",(()=>this._updateManipulatorPosition(r)));r.locationUpdateHandle=(0,handleUtils/* handlesGroup */.AL)([e,t]),this._manipulatorHandles.add(r.locationUpdateHandle,a)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(a,!0),a);const o=(0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(a,((e,i,a,n)=>{let o=null;i.next((e=>this._trackNumDragging(e))).next((e=>{if("start"===e.action&&(o=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations).createUndoGroup()),ue(r)){const t=this._splitEdgeManipulator(r);return{...e,info:t,snapOrigin:t.handle.pos}}return{...e,info:r,snapOrigin:r.handle.pos}})).next((0,dragEventPipeline/* dragAtLocation */.kY)(this.view,e.elevationAlignedLocation)).next(dragEventPipeline3D_P(this.view,this.graphic,e.elevationAlignedLocation,e.location.spatialReference,this.graphic)).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>!this._isMultiVertexSelection(),cancel:a,snappingManager:this.tool.snappingManager,snappingContext:new SnappingContext/* SnappingContext */.N({editGeometryOperations:(0,maybe/* unwrap */.Wg)(this._editGeometryOperations),elevationInfo:t,pointer:n,excludeFeature:this.graphic,visualizer:new g}),updatingHandles:this.updatingHandles}),this._snappingPipeline.next).next((0,dragEventPipeline/* addMapDelta */.AN)()).next((e=>{this._perVertexManipulatorDragAction(e),"end"===e.action&&(o=(0,maybe/* removeMaybe */.hw)(o))})),a.next(this._cancelDragOperation((()=>o=(0,maybe/* removeMaybe */.hw)(o))))}));return this._manipulatorHandles.add(o,a),this._manipulatorHandles.add([a.events.on("immediate-click",(e=>this._manipulatorClickCallback(e,r))),a.events.on("select-changed",(()=>{r.selectedIndex=++this._selectedIndex,this._updateMoveManipulationPosition()}))],a),this.emit("manipulators-changed"),r}_trackNumDragging(e){switch(e.action){case"start":this._numDragging++;break;case"end":this._numDragging--}return e}_cancelDragOperation(e){return()=>{switch(this._numDragging--,this.undo(),this.outputGeometry=(0,maybe/* isSome */.pC)(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null,(0,maybe/* isSome */.pC)(this.tool.snappingManager)&&this.tool.snappingManager.doneSnapping(),this._reshapeEventState){case _e.NONE:break;case _e.MOVING:this.emit("move",{type:"move",dx:0,dy:0,mover:this.graphic});break;case _e.RESHAPING:this.emit("reshape",{type:"reshape",mover:this.graphic})}e&&e(),this.destroyed||this._updateEventState(_e.NONE)}}_setTypeSpecificManipulatorSettings(e,t,i){switch(t.type){case"vertex":e.state=ge.Vertex,e.selectable=!0,e.cursor="move",e.collisionPriority=2,e.radius=settings/* settings.reshapeManipulators.vertex.size */.Xd.reshapeManipulators.vertex.size/2+settings/* settings.reshapeManipulators.vertex.collisionPadding */.Xd.reshapeManipulators.vertex.collisionPadding,e.elevationInfo=i,e.interactive=(0,maybe/* isSome */.pC)(this.graphic.geometry)&&"point"!==this.graphic.geometry.type;break;case"edge":e.state=ge.Edge,e.selectable=!1,e.cursor="copy",e.collisionPriority=-1,e.radius=settings/* settings.reshapeManipulators.edge.size */.Xd.reshapeManipulators.edge.size/2+settings/* settings.reshapeManipulators.edge.collisionPadding */.Xd.reshapeManipulators.edge.collisionPadding,e.elevationInfo="on-the-ground"!==i.mode||(0,utils/* isVolumetricSymbol */.YW)(this.graphic.symbol)?{mode:"absolute-height",offset:0}:i}}_watchAndUpdateGrabState(e,t){return e.events.on("grab-changed",(i=>{if("start"===i.action)t&&this._updateSelection(e),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(_e.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing,("touch"!==i.pointerType||this.enableEdgeOffset)&&(this._manipulatorInfos.forEach((e=>{e.manipulator.interactive=!this._numGrabbing&&(0,maybe/* isSome */.pC)(this.graphic.geometry)&&"point"!==this.graphic.geometry.type,"edgeManipulator"in e&&(e.edgeManipulator.interactive=!this._numGrabbing)})),(0,maybe/* unwrap */.Wg)(this._graphicMoveManipulation).forEachManipulator((e=>e.interactive=!this._numGrabbing)))}))}_clearSelection(){for(const e of this._manipulatorInfos)e.manipulator.grabbing||(e.manipulator.selected=!1)}_updateSelection(e){e.grabbing&&!e.selected&&e.selectable&&(this._clearSelection(),e.selected=!0,this.emit("manipulators-changed"))}_removeManipulator(e){e&&(this._manipulatorHandles.remove(e.manipulator),this._manipulatorInfos.splice(this._manipulatorInfos.indexOf(e),1),this.manipulators.remove(e.manipulator),this.emit("manipulators-changed"))}_getManipulatorInfoFromHandle(e){if(e)for(const t of this._manipulatorInfos)if(e===t.handle)return t;return null}_updateManipulatorPosition(e){if(!e)return;const t=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations);if("vertex"===e.handle.type)e.manipulator.location=t.data.coordinateHelper.vectorToDehydratedPoint(e.handle.pos,ce),e.manipulator.grabbing&&(0,maybe/* isSome */.pC)(this._vertexLaserLineVisualElement)&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=e.manipulator.renderLocation);else if("edge"===e.handle.type){const i=this._getManipulatorInfoFromHandle(e.handle.leftVertex).manipulator,a=this._getManipulatorInfoFromHandle(e.handle.rightVertex).manipulator;if((0,maybe/* isSome */.pC)(e.manipulator.elevationInfo)&&"on-the-ground"===e.manipulator.elevationInfo.mode){const n=i.location,r=a.location,o=.5,s=n.x+o*(r.x-n.x),l=n.y+o*(r.y-n.y),p=n.hasZ&&r.hasZ?0:void 0;e.manipulator.location=(0,dehydratedFeatures/* makeDehydratedPoint */.Tx)(s,l,p,t.data.spatialReference)}else (0,vec3.e)(me,i.renderLocation,a.renderLocation,.5),e.manipulator.renderLocation=me}}_splitEdgeManipulator(e,t=.5){const i=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations),a=(0,maybe/* unwrap */.Wg)(i.splitEdge(e.handle,t).createdVertex);e.locationUpdateHandle.remove(),e.locationUpdateHandle=void 0;const n=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(this.graphic);let r;this.enableEdgeOffset?(this._removeManipulator(e),r=this._createVertexOrEdgeManipulator(a)):(r=e,r.handle=a,r.type="vertex",this._setTypeSpecificManipulatorSettings(e.manipulator,e.handle,n)),a.leftEdge&&this._createVertexOrEdgeManipulator(a.leftEdge),a.rightEdge&&this._createVertexOrEdgeManipulator(a.rightEdge),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(r),this._updateSelection(e.manipulator);const o=this._updateEventState(_e.RESHAPING),s=i.data.coordinateHelper.vectorToArray(r.handle.pos),l=i.data.components.indexOf(a.component);return this.emit("vertex-add",{type:"vertex-add",vertices:[{coordinates:s,componentIndex:l,vertexIndex:(0,maybe/* unwrap */.Wg)(a.index)}],added:s}),o&&this._updateEventState(_e.NONE),r}_updateMoveManipulationPosition(){const e=(0,vec3.s)(me,0,0,0);let t=0,i=!1,a=null,n=null;for(const r of this._manipulatorInfos)de(r)&&(r.manipulator.selected?(t++,(0,vec3.b)(e,e,r.manipulator.renderLocation),(0,maybe/* isNone */.Wi)(a)||r.selectedIndex>a.selectedIndex?(n=a,a=r):((0,maybe/* isNone */.Wi)(n)||r.selectedIndex>n.selectedIndex)&&(n=r)):i=!0);if(0!==t){const e=this._graphicState.displaying;this._moveManipulation.xyManipulation.available=e,this._moveManipulation.xyAxisManipulation.available=e,this._moveManipulation.zManipulation.available=e&&this.enableZVertex&&manipulatorUtils_t(this.graphic),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=e&&1!==t}else{const e=this._graphicState.displaying&&this.enableMoveGraphic;this._moveManipulation.xyManipulation.available=e,this._moveManipulation.xyAxisManipulation.available=e,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=e,this._moveManipulation.zManipulation.available=e&&this.enableZShape&&manipulatorUtils_t(this.graphic)}if(0!==t){let e=0;if((0,maybe/* isSome */.pC)(a)){const t=a.handle.pos,i=(0,maybe/* isSome */.pC)(n)?n.handle.pos:a.handle.leftEdge&&a.handle.leftEdge.leftVertex?a.handle.leftEdge.leftVertex.pos:null,r=!(0,maybe/* isSome */.pC)(n)&&a.handle.rightEdge&&a.handle.rightEdge.rightVertex?a.handle.rightEdge.rightVertex.pos:null;i&&r?this._moveManipulation.xyAxisManipulation.available=!1:i?e=he(i,t):r&&(e=he(t,r))}this._moveManipulation.angle=e,this._moveManipulation.radius=config_I}else this._moveManipulation.angleDeferred=()=>moveUtils_a((0,maybe/* unwrap */.Wg)(this.graphic.geometry)),this._moveManipulation.radius=MoveManipulation_u.radiusForSymbol(this.graphic.symbol);0!==t&&i?((0,vec3.a)(e,e,1/t),ce.spatialReference=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations).data.spatialReference,ce.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(e,ce),this._moveManipulation.elevationAlignedLocation=ce):(0,maybe/* isSome */.pC)(this._outlineVisualElement)&&!this._graphicState.isDraped&&(0,maybe/* isSome */.pC)(this._outlineVisualElement.attachmentOrigin)?this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin:(0,manipulatorUtils/* placeAtGraphic */.u2)(this.view,this._moveManipulation,this.graphic)}_removeVertices(e){const t=[],i=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations);for(const a of e)if("vertex"===a.handle.type&&i.canRemoveVertex()){t.push(a.handle),this._removeManipulator(a),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.rightEdge));const e=(0,maybe/* unwrap */.Wg)(i.removeVertices([a.handle]).removedVertices[0].createdEdge);e&&this._createVertexOrEdgeManipulator(e)}if(t.length>0){const e=t.map((e=>{const t=i.data.components.indexOf(e.component);return{coordinates:i.data.coordinateHelper.vectorToArray(e.pos),componentIndex:t,vertexIndex:(0,maybe/* unwrap */.Wg)(e.index)}}));this.outputGeometry=i.data.geometry;const a=this._updateEventState(_e.RESHAPING);if(this.destroyed)return;if(this.emit("vertex-remove",{type:"vertex-remove",removed:e.map((e=>e.coordinates)),vertices:e}),this.destroyed)return;if(a&&(this._updateEventState(_e.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}_moveVertices(e,t,i=("start"===t.action?editGeometry_interfaces/* AccumulationBehaviour.NEW_STEP */.O.NEW_STEP:editGeometry_interfaces/* AccumulationBehaviour.ACCUMULATE_STEPS */.O.ACCUMULATE_STEPS)){const a=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations);a.moveVertices(e.map((e=>e.handle)),t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,i),this.outputGeometry=a.data.geometry;for(const n of e)this._updateManipulatorPosition(n)}_offsetEdge(e,t){if((0,maybe/* isNone */.Wi)(t.operation))return;const i=(0,maybe/* unwrap */.Wg)(this._editGeometryOperations),a=t.operation.clone();a.distance=t.operation.signedDistanceToPoint(t.mapEnd),i.updateVertices([e.handle.leftVertex,e.handle.rightVertex],a),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.rightVertex))}_manipulatorClickCallback(e,t){e.shiftKey||this._clearSelection(),"vertex"===t.handle.type&&(t.manipulator.selected=!t.manipulator.selected),"vertex"===t.handle.type&&e.button===IViewEvents/* MouseButton.Right */.t.Right&&this._removeVertices([t]),ue(t)&&e.button===IViewEvents/* MouseButton.Left */.t.Left&&this._splitEdgeManipulator(t),e.stopPropagation()}};function he(e,t){return Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI/2}function de(e){return"vertex"===e.handle.type}function ue(e){return"edge"===e.handle.type}(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],pe.prototype,"tool",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],pe.prototype,"inputGeometry",null),(0,tslib_es6._)([(0,property/* property */.Cb)()],pe.prototype,"outputGeometry",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],pe.prototype,"updating",null),pe=(0,tslib_es6._)([(0,subclass/* subclass */.j)("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")],pe);const ce=(0,dehydratedFeatures/* makeDehydratedPoint */.Tx)(0,0,null,null),me=(0,vec3f64.c)();var ge,_e,fe;!function(e){e.Vertex=interfaces/* ManipulatorStateCustomFlags.Custom1 */.jg.Custom1,e.Edge=interfaces/* ManipulatorStateCustomFlags.Custom2 */.jg.Custom2}(ge||(ge={})),function(e){e[e.NONE=0]="NONE",e[e.MOVING=1]="MOVING",e[e.RESHAPING=2]="RESHAPING"}(_e||(_e={})),function(e){e[e.ALL=0]="ALL",e[e.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"}(fe||(fe={}));\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/reshapeGraphic/GraphicReshapeTool.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nlet GraphicReshapeTool_u=class extends(Evented/* default.EventedMixin */.Z.EventedMixin(InteractiveToolBase/* InteractiveToolBase */.m)){constructor(e){super(e),this._handles=new Handles/* default */.Z,this._reshapeOperation=null,this._internalGeometryUpdate=!1,this.enableZShape=!0,this.enableZVertex=!0,this.enableMoveGraphic=!0,this.enableMidpoints=!0,this.enableEdgeOffset=!1,this.type="reshape-3d",this.snappingManager=null,this.automaticManipulatorSelection=!1}destroy(){this._handles=(0,maybe/* destroyMaybe */.SC)(this._handles),this._reshapeOperation=(0,maybe/* destroyMaybe */.SC)(this._reshapeOperation),this._set("view",null),this._set("graphic",null)}get updating(){var e,t;return null!=(e=null==(t=this._reshapeOperation)?void 0:t.updating)&&e}_updateGeometry(){const e=(0,reshapeGraphic_isSupportedGraphic/* geometryOfSupportedGraphic */.b)(this.graphic);this._reshapeOperation.inputGeometry=(0,maybe/* isSome */.pC)(e)?e.clone():null}_updateGraphic(){if(this._handles.remove("onGraphicGeometryChange"),this._updateGeometry(),(0,reshapeGraphic_isSupportedGraphic/* isSupportedGraphic */.P)(this.graphic)!==isSupportedGraphicUtils/* SupportedGraphicResult.SUPPORTED */.e.SUPPORTED)return;const e=this.watch("graphic.geometry",(()=>{!1===this._internalGeometryUpdate&&this._updateGeometry()}),!0);this._handles.add(e,"onGraphicGeometryChange")}manipulatorSelectionChanged(){this._reshapeOperation&&this._reshapeOperation.manipulatorSelectionChanged()}_updateGeometryInternally(e){this._internalGeometryUpdate=!0,this.graphic.geometry=e,this._internalGeometryUpdate=!1}_onReshapeGeometryChanged(){(0,maybe/* isNone */.Wi)(this.graphic)||this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone())}initialize(){this._reshapeOperation=new pe({tool:this}),this._handles.add([this._reshapeOperation.on("reshape",(e=>{"reshape"===e.type&&this._onReshapeGeometryChanged(),this.emit("reshape",e)})),this._reshapeOperation.on("move",(e=>{"move"===e.type&&this._onReshapeGeometryChanged(),this.emit("move",e)})),this._reshapeOperation.on("vertex-add",(e=>{this._onReshapeGeometryChanged(),this.emit("vertex-add",e)})),this._reshapeOperation.on("vertex-remove",(e=>{this._onReshapeGeometryChanged(),this.emit("vertex-remove",e)})),this._reshapeOperation.on("immediate-click",(e=>this.emit("immediate-click",e))),this.view.on("pointer-down",["Shift"],(e=>{e.stopPropagation()})),(0,watchUtils/* init */.S1)(this,"graphic",(()=>{this._updateGraphic()}),!0)]),this.finishToolCreation()}get canUndo(){var e,t;return null!=(e=null==(t=this._reshapeOperation)?void 0:t.canUndo)&&e}undo(){(0,maybe/* isSome */.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),(0,maybe/* isSome */.pC)(this._reshapeOperation.undo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone())}get canRedo(){var e,t;return null!=(e=null==(t=this._reshapeOperation)?void 0:t.canRedo)&&e}redo(){(0,maybe/* isSome */.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),(0,maybe/* isSome */.pC)(this._reshapeOperation.redo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone())}onInputEvent(e){"key-down"!==e.type||"Delete"!==e.key&&"Backspace"!==e.key||this._reshapeOperation.removeSelectedVertices()}reset(){}get test(){return{snappingManager:this.snappingManager}}};(0,tslib_es6._)([(0,property/* property */.Cb)()],GraphicReshapeTool_u.prototype,"_reshapeOperation",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"view",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],GraphicReshapeTool_u.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableZShape",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableZVertex",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableMoveGraphic",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableMidpoints",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableEdgeOffset",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],GraphicReshapeTool_u.prototype,"type",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],GraphicReshapeTool_u.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],GraphicReshapeTool_u.prototype,"updating",null),(0,tslib_es6._)([(0,property/* property */.Cb)()],GraphicReshapeTool_u.prototype,"automaticManipulatorSelection",void 0),GraphicReshapeTool_u=(0,tslib_es6._)([(0,subclass/* subclass */.j)("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],GraphicReshapeTool_u);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Point.js + 2 modules\nvar Point = __webpack_require__(53446);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/ViewingMode.js\nvar ViewingMode = __webpack_require__(65684);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/scheduling.js\nvar scheduling = __webpack_require__(17262);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/support/mathUtils.js\nvar support_mathUtils = __webpack_require__(35369);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/GraphicScaleRotateTransform.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nvar ct,ht;!function(t){t.ScaleIn=interfaces/* ManipulatorStateCustomFlags.Custom2 */.jg.Custom2,t.ScaleOut=interfaces/* ManipulatorStateCustomFlags.Custom3 */.jg.Custom3,t.RotateLeft=interfaces/* ManipulatorStateCustomFlags.Custom4 */.jg.Custom4,t.RotateRight=interfaces/* ManipulatorStateCustomFlags.Custom5 */.jg.Custom5,t.Unlocked=interfaces/* ManipulatorStateCustomFlags.Custom7 */.jg.Custom7,t.DelayedFocused=interfaces/* ManipulatorStateCustomFlags.Custom8 */.jg.Custom8,t.TouchInput=interfaces/* ManipulatorStateCustomFlags.Custom12 */.jg.Custom12}(ct||(ct={}));class gt{constructor(a){this.mode=null,this._handles=new Handles/* default */.Z,this._scaleRotateDragData=null,this._activeAnimation=null,this.events=new Evented/* default */.Z,this.getFocused=()=>this.ringManipulator.focused,this.getScale=()=>(0,maybe/* isSome */.pC)(this._scaleRotateDragData)&&"scale"===this._scaleRotateDragData.mode?this.adapter.scale:1,this.tool=a.tool,this.mode=a.mode,this.adapter=a.adapter,this._createManipulator(),this._updateDragState(),this._updateManipulatorTransform()}get angle(){return this.adapter.angle}get scale(){return this.adapter.scale}set location(t){this.ringManipulator.location=t}set elevationAlignedLocation(t){this.ringManipulator.elevationAlignedLocation=t}get grabbing(){return this.ringManipulator.grabbing}set interactive(t){this.ringManipulator.interactive=t}destroy(){(0,maybe/* isSome */.pC)(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=null),this._handles=(0,maybe/* destroyMaybe */.SC)(this._handles),this.tool.manipulators.remove(this.ringManipulator),this.ringManipulator=null}startAnimation(t){this.cancelActiveAnimation(),t.start();const e=(0,scheduling/* addFrameTask */.A)({update:({deltaTime:e})=>{t.update(e)&&this.cancelActiveAnimation()}});this._activeAnimation={...t,frameTask:e}}cancelActiveAnimation(){(0,maybe/* isSome */.pC)(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=(0,maybe/* destroyMaybe */.SC)(this._activeAnimation))}forEachManipulator(t){t(this.ringManipulator,ManipulatorType_A.SCALE_ROTATE)}_createManipulator(){this.ringManipulator=this._createRingManipulator(),this.tool.manipulators.add(this.ringManipulator);const t=this.ringManipulator,e=this.tool.graphicState.graphic,o=(0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(t,((t,o,s)=>{this._scaleRotateDragData=null,this.adapter.restart();const n={mode:"none",origin:(0,vec3f64.a)(t.renderLocation),initialAngle:this.adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=n,this._updateDragState();const l=vectorStacks/* sv3d.get */.WM.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(t.renderLocation,l),o.next(dragEventPipeline3D_C(this.tool.view,(0,plane/* fromPositionAndNormal */.Yq)(t.renderLocation,l,(0,plane/* create */.Ue)()))).next((t=>{const o=(0,plane/* normal */.mJ)(t.plane),s=(0,manipulatorUtils/* calculateInputRotationTransform */.Gd)(t.renderStart,t.renderEnd,n.origin,o),l=support_mathUtils/* cyclicalPI.shortestSignedDiff */.Q4.shortestSignedDiff(n.angle,s);n.angleDir=(0,mathUtils/* clamp */.uZ)(n.angleDir+l,-q,q),n.angle=s;const c=dt(n,t),h=c-this.adapter.scale;if(n.scaleDir=(0,mathUtils/* clamp */.uZ)(n.scaleDir+h,-config_m,config_m),this._onScaleChanged(),"none"===n.mode){const a=this.mode||pt(t,t.plane,n.origin,this.tool.view.state.camera);if((0,maybe/* isSome */.pC)(a)){switch(a){case"rotate":this.tool.emit("graphic-rotate-start",{graphic:e,angle:0}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()});break;case"scale":this.tool.emit("graphic-scale-start",{graphic:e,xScale:1,yScale:1}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()})}n.mode=a}}switch(n.mode){case"rotate":this.adapter.angle=n.initialAngle+s;break;case"scale":this.adapter.scale=c,this._onScaleChanged()}switch(this._updateDragState(),this._updateManipulatorTransform(),t.action){case"start":case"update":switch(n.mode){case"rotate":this.tool.emit("graphic-rotate",{graphic:e,angle:(0,mathUtils/* rad2deg */.BV)(n.angle)});break;case"scale":this.tool.emit("graphic-scale",{graphic:e,xScale:c,yScale:c})}break;case"end":switch(n.mode){case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:e,angle:(0,mathUtils/* rad2deg */.BV)(n.angle)});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:e,xScale:c,yScale:c})}}"end"===t.action&&(this.startAnimation(mt(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState())})),s.next((()=>{if(this.adapter.cancel(),(0,maybe/* isSome */.pC)(this._scaleRotateDragData)){switch(this._scaleRotateDragData.mode){case"none":break;case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:e,angle:0});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:e,xScale:1,yScale:1})}this.startAnimation(mt(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState()}}))}));this._handles.add(o),this._handles.add([this.ringManipulator.events.on("focus-changed",(t=>{"focus"===t.action?this.startAnimation(ft(this,(()=>this._updateDelayedFocusedState()))):this._updateDelayedFocusedState()})),this.ringManipulator.events.on("immediate-click",(t=>{t.stopPropagation()})),(0,watchUtils/* init */.S1)(this.tool.graphicState,"displaying",(t=>this.ringManipulator.available=t))])}_onScaleChanged(){this.events.emit("scale-changed"),this._updateManipulatorTransform()}_updateDelayedFocusedState(){this.ringManipulator.updateStateEnabled(ct.DelayedFocused,this.getFocused())}_updateDragState(){if(this.ringManipulator.updateStateEnabled(ct.Unlocked,!((0,maybe/* isSome */.pC)(this._scaleRotateDragData)&&"none"!==this._scaleRotateDragData.mode)),(0,maybe/* isSome */.pC)(this._scaleRotateDragData))switch(this._scaleRotateDragData.mode){case"rotate":this.ringManipulator.updateStateEnabled(ct.ScaleIn|ct.ScaleOut,!1),this.ringManipulator.updateStateEnabled(ct.RotateLeft,this._scaleRotateDragData.angleDir<0),this.ringManipulator.updateStateEnabled(ct.RotateRight,this._scaleRotateDragData.angleDir>=0);break;case"scale":this.ringManipulator.updateStateEnabled(ct.RotateLeft|ct.RotateRight,!1),this.ringManipulator.updateStateEnabled(ct.ScaleIn,this._scaleRotateDragData.scaleDir<0),this.ringManipulator.updateStateEnabled(ct.ScaleOut,this._scaleRotateDragData.scaleDir>=0)}else this.ringManipulator.updateStateEnabled(ct.ScaleIn|ct.ScaleOut|ct.RotateLeft|ct.RotateRight,!1)}_updateManipulatorTransform(){const t=(0,mat4.d)(vectorStacks/* sm4d.get */.MP.get(),this.adapter.angle,(0,vec3f64.f)(0,0,1)),e=this.getScale(),a=(0,mat4.u)(vectorStacks/* sm4d.get */.MP.get(),(0,vec3.s)(vectorStacks/* sv3d.get */.WM.get(),e,e,e));this.ringManipulator.modelTransform=(0,mat4.m)(vectorStacks/* sm4d.get */.MP.get(),a,t)}_createRingManipulator(){const t=(t,e,a)=>{const i=[],r=Math.ceil(config_a*(e-t)/(2*Math.PI));for(let o=0;o<r+1;o++){const s=t+o*(e-t)/r;i.push((0,vec3f64.f)(a*Math.cos(s),a*Math.sin(s),0))}return i},e=e=>t(0,2*Math.PI,e),a=t=>[[-t/2,0],[t/2,0],[t/2,config_i/2],[-t/2,config_i/2]],i=(t,e)=>GeometryUtil/* default.createPathExtrusionGeometry */.Z.createPathExtrusionGeometry(a(e),t,[],[],!1),r=e(config_P),o=i(r,config_l),s={left:[],right:[]},n=[];for(let v=0;v<2;v++){const e=v*Math.PI-Math.PI/4,a=Math.PI/2-config_b,r=e+a,o=e+Math.PI/2-a,l=t(r,o,config_p),c=i(l,config_n);n.push(l),n.push(t(r,o,config_r-config_l/2)),s.left.push(c),s.right.push(c);for(let t=0;t<2;t++){const e=0===t,a=(0,mat4f64.c)();if(e){(0,mat4.h)(a,a,[1,-1,1]),(0,mat4.e)(a,a,-r,[0,0,1]);const t=Math.round(config_g*(l.length-1));a[12]=l[t][0],a[13]=l[t][1],a[14]=l[t][2]}else{(0,mat4.e)(a,a,o,[0,0,1]);const t=Math.round((1-config_g)*(l.length-1));a[12]=l[t][0],a[13]=l[t][1],a[14]=l[t][2]}const i=GeometryUtil/* default.createExtrudedTriangle */.Z.createExtrudedTriangle(config_s,0,config_x,config_i);GeometryUtil/* default.transformInPlace */.Z.transformInPlace(i,a),(e?s.left:s.right).push(i)}}const l=[];for(let d=0;d<2;d++){const e=d*Math.PI-Math.PI/4,a=Math.PI/2-config_d,r=e+a,o=e+Math.PI/2-a,s=t(r,o,config_r);l.push(i(s,config_n))}const c=e(config_P+config_j),h=e(config_P+config_k),g=i(c,config_n),m=i(h,config_n),f=e(config_P-config_j),M=e(config_P-config_k),D=i(f,config_n),S=i(M,config_n),_=this._createMaterial(),y=this._createMaterial(.66),R=this._createMaterial(.5),b=this._createMaterial(.33);let k=[{geometry:o,material:_,stateMask:ct.DelayedFocused},{geometry:o,material:R,stateMask:interfaces/* ManipulatorStateFlags.None */.Q9.None}];this.mode&&"scale"!==this.mode||(k=k.concat([{geometry:l,material:_,stateMask:ct.DelayedFocused|ct.Unlocked},{geometry:g,material:y,stateMask:ct.DelayedFocused|ct.ScaleIn},{geometry:m,material:b,stateMask:ct.DelayedFocused|ct.ScaleIn},{geometry:D,material:y,stateMask:ct.DelayedFocused|ct.ScaleOut},{geometry:S,material:b,stateMask:ct.DelayedFocused|ct.ScaleOut}])),this.mode&&"rotate"!==this.mode||(k=k.concat([{geometry:s.right,material:_,stateMask:ct.DelayedFocused|ct.Unlocked},{geometry:s.left,material:_,stateMask:ct.DelayedFocused|ct.RotateLeft},{geometry:s.right,material:_,stateMask:ct.DelayedFocused|ct.RotateRight}]));const j=[r,...n];return new Manipulator3D/* Manipulator3D */.Z({view:this.tool.view,renderObjects:k,autoScaleRenderObjects:!1,worldOriented:!0,radius:config_l,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(this.tool.graphicState.graphic),collisionType:{type:"ribbon",paths:j,direction:(0,vec3f64.f)(0,0,1)}})}_createMaterial(t=1){const e=[...config_t,t];return new ColorMaterial/* ColorMaterial */.E({color:e,transparent:1!==t,cullFace:basicInterfaces/* CullFaceOptions.Back */.Vr.Back,renderOccluded:Material/* RenderOccludedFlag.Transparent */.yD.Transparent})}get test(){return{ringManipulator:this.ringManipulator}}}function dt(t,e){const a=(0,vec3.f)(vectorStacks/* sv3d.get */.WM.get(),e.renderStart,t.origin),i=(0,vec3.f)(vectorStacks/* sv3d.get */.WM.get(),e.renderEnd,t.origin),r=(0,vec3.l)(a),o=(0,vec3.l)(i);return 0===r?0:o/r}function pt(t,e,a,i){const{renderStart:r,renderEnd:o}=t,s=ut(r,i,vectorStacks/* sv3d.get */.WM.get()),n=ut(o,i,vectorStacks/* sv3d.get */.WM.get());if((0,vec3.h)(s,n)<f*f)return null;const l=(0,vec3.f)(vectorStacks/* sv3d.get */.WM.get(),r,a),c=(0,vec3.c)(vectorStacks/* sv3d.get */.WM.get(),l,(0,plane/* normal */.mJ)(e)),h=r,g=(0,vec3.b)(vectorStacks/* sv3d.get */.WM.get(),h,c),d=ut(a,i,vectorStacks/* sv3d.get */.WM.get()),p=s,u=ut(g,i,vectorStacks/* sv3d.get */.WM.get()),m=(0,vec3.f)(vectorStacks/* sv3d.get */.WM.get(),u,p),M=(0,vec3.f)(vectorStacks/* sv3d.get */.WM.get(),s,d),y=(0,ray/* wrap */.re)(p,m),v=(0,ray/* wrap */.re)(d,M);return (0,ray/* distance2 */.Jk)(y,n)<(0,ray/* distance2 */.Jk)(v,n)?"rotate":"scale"}function ut(t,e,a){return e.projectToScreen(t,Mt),(0,vec3.s)(a,Mt[0],Mt[1],0)}function mt(t,e){let a=null,i=1;const r=()=>i;return{start:()=>{i=t.getScale(),a=t.getScale,t.getScale=r,e()},update:t=>(i+=((i+1)/2-i)*Math.min(t*config_v,1),e(),Math.abs(i-1)<.01?ht.STOP:ht.CONTINUE),destroy:()=>{t.getScale=a,e()}}}function ft(t,e){let a=0,i=null;const r=()=>!1;return{start:()=>{i=t.getFocused,t.getFocused=r,a=0,e()},update:t=>(a+=t,!i()||a>u?ht.STOP:ht.CONTINUE),destroy:()=>{t.getFocused=i,e()}}}!function(t){t[t.CONTINUE=0]="CONTINUE",t[t.STOP=1]="STOP"}(ht||(ht={}));const Mt=(0,screenUtils/* createScreenPointArray */.s1)();\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/reactiveUtils.js\nvar reactiveUtils = __webpack_require__(76868);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/axisAngleDegrees.js\nvar axisAngleDegrees = __webpack_require__(34218);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/undoRecords.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction undoRecords_r(t){return (0,maybe/* isSome */.pC)(t.geometry)&&"mesh"===t.geometry.type?undoRecords_o(t.geometry):undoRecords_n(t)}function undoRecords_o(t){return (0,maybe/* isSome */.pC)(t.transform)?undoRecords_m(t,t.transform):i(t)}function undoRecords_n(e){let r=e.geometry,o=maybe/* none */.YP;return{undo(e){o=e.geometry,e.geometry=r},redo(e){r=e.geometry,e.geometry=o}}}function undoRecords_m(t,r){let o=r.clone(),n=null;return{undo:r=>{n=(0,maybe/* isSome */.pC)(t.transform)?t.transform.clone():null,t.transform=o,r.notifyGeometryChanged()},redo:r=>{o=(0,maybe/* isSome */.pC)(t.transform)?t.transform.clone():null,t.transform=n,r.notifyGeometryChanged()}}}function i(e){let t,r=e.vertexAttributes.clonePositional();return{undo:o=>{t=e.vertexAttributes.clonePositional(),e.vertexAttributes=r,o.notifyGeometryChanged()},redo:o=>{r=e.vertexAttributes.clonePositional(),e.vertexAttributes=t,o.notifyGeometryChanged()}}}\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/ScaleRotateMeshAdapter.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nlet ScaleRotateMeshAdapter_m=class extends HandleOwner/* HandleOwner */.r{constructor(e){super(e),this.angle=0,this.scale=1,this.initialAngle=0,this.previousAngle=0,this.previousScale=1}initialize(){this.restart()}restart(){this.handles.remove(ScaleRotateMeshAdapter_d);const e=this.geometry.transform;if(this.scale=1,(0,maybe/* isSome */.pC)(e)){const t=(0,axisAngleDegrees/* axis */.ZZ)(e.rotation)[2];Math.abs(t)>.999999&&(this.angle=(0,mathUtils/* deg2rad */.Vl)((0,axisAngleDegrees/* angle */.EU)(e.rotation))*Math.sign(t))}this.initialAngle=this.angle,this.previousAngle=this.angle,this.previousScale=this.scale,this.handles.add((0,reactiveUtils/* watch */.YP)((()=>({angle:this.angle,scale:this.scale})),(e=>this._update(e)),reactiveUtils/* sync */.Z_),ScaleRotateMeshAdapter_d)}cancel(){this.scale=1,this.angle=this.initialAngle}createUndoRecord(){return undoRecords_r(this.graphic)}_update({scale:e,angle:t}){const s=this.geometry.anchor,o=this.viewingMode===ViewingMode/* ViewingMode.Global */.JY.Global;e!==this.previousScale&&(this.geometry.scale(e/this.previousScale,{origin:s,geographic:o}),this.previousScale=e,(0,maybe/* isSome */.pC)(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged()),t!==this.previousAngle&&(this.geometry.rotate(0,0,(0,mathUtils/* rad2deg */.BV)(t-this.previousAngle),{origin:s,geographic:o}),this.previousAngle=t,(0,maybe/* isSome */.pC)(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged())}};(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],ScaleRotateMeshAdapter_m.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],ScaleRotateMeshAdapter_m.prototype,"geometry",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],ScaleRotateMeshAdapter_m.prototype,"viewingMode",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],ScaleRotateMeshAdapter_m.prototype,"angle",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],ScaleRotateMeshAdapter_m.prototype,"scale",void 0),ScaleRotateMeshAdapter_m=(0,tslib_es6._)([(0,subclass/* subclass */.j)("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],ScaleRotateMeshAdapter_m);const ScaleRotateMeshAdapter_d="scale-heading-update-key";\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/ScaleRotateObjectSymbol3DAdapter.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nlet ScaleRotateObjectSymbol3DAdapter_y=class extends HandleOwner/* HandleOwner */.r{constructor(t){super(t),this.angle=0,this.scale=1,this.symbol=null,this.initialAngle=0}initialize(){this.restart()}restart(){this.handles.remove(ScaleRotateObjectSymbol3DAdapter_m);const t=(0,maybe/* isSome */.pC)(this.graphic.symbol)&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:maybe/* none */.YP;if(this.symbol=(0,maybe/* isSome */.pC)(t)?t.clone():null,this.initialSizes=[],(0,maybe/* isSome */.pC)(t)){const e=this.findLayerView();(0,maybe/* isSome */.pC)(e)&&(this.initialSizes=t.symbolLayers.map((i=>"object"===i.type?e.getSymbolLayerSize(t,i):null)).toArray())}this.angle=0,(0,maybe/* isSome */.pC)(t)&&t.symbolLayers.some((t=>!("object"!==t.type||!(0,maybe/* isSome */.pC)(t.heading))&&(this.angle=-(0,mathUtils/* deg2rad */.Vl)(t.heading),!0))),this.initialAngle=this.angle,this.scale=1,this.handles.add((0,reactiveUtils/* watch */.YP)((()=>({angle:this.angle,scale:this.scale})),(t=>this._updateSymbol(t)),reactiveUtils/* sync */.Z_),ScaleRotateObjectSymbol3DAdapter_m)}cancel(){this.graphic.symbol=this.symbol}createUndoRecord(){let t=this.graphic.symbol,e=null;return{undo:i=>{e=i.symbol,i.symbol=t,this.restart()},redo:i=>{t=i.symbol,i.symbol=e,this.restart()}}}_updateSymbol({scale:t,angle:e}){const i=this.graphic.symbol;if((0,maybe/* isNone */.Wi)(this.symbol)||(0,maybe/* isNone */.Wi)(i)||"point-3d"!==i.type)return;const r=i.clone(),h=-(0,mathUtils/* rad2deg */.BV)(e-this.initialAngle);let c=!1;this._forEachObjectSymbolLayerPair(this.symbol,r,((e,i,s)=>{const r=(0,maybe/* unwrapOr */.Pt)(e.heading,0)+h;i.heading!==r&&(i.heading=r,c=!0);const a=this.initialSizes[s];if((0,maybe/* isSome */.pC)(a)&&"width"in a){a.width=this.sizeFilter(a.width),a.height=this.sizeFilter(a.height),a.depth=this.sizeFilter(a.depth);const e=a.width*t;i.width!==e&&(i.width=e,c=!0);const s=a.depth*t;i.depth!==s&&(i.depth=s,c=!0);const o=a.height*t;i.height!==o&&(i.height=o,c=!0)}})),c&&(this.graphic.symbol=r)}_forEachObjectSymbolLayerPair(t,e,i){t.symbolLayers.forEach(((t,s)=>{const o=e.symbolLayers.getItemAt(s);"object"===t.type&&"object"===o.type&&i(t,o,s)}))}};(0,tslib_es6._)([(0,property/* property */.Cb)()],ScaleRotateObjectSymbol3DAdapter_y.prototype,"angle",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],ScaleRotateObjectSymbol3DAdapter_y.prototype,"scale",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],ScaleRotateObjectSymbol3DAdapter_y.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],ScaleRotateObjectSymbol3DAdapter_y.prototype,"symbol",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],ScaleRotateObjectSymbol3DAdapter_y.prototype,"findLayerView",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],ScaleRotateObjectSymbol3DAdapter_y.prototype,"sizeFilter",void 0),ScaleRotateObjectSymbol3DAdapter_y=(0,tslib_es6._)([(0,subclass/* subclass */.j)("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],ScaleRotateObjectSymbol3DAdapter_y);const ScaleRotateObjectSymbol3DAdapter_m="scale-heading-update-key";\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/GraphicTransformTool.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nlet GraphicTransformTool_T=class extends((0,HandleOwner/* HandleOwnerMixin */.p)(Evented/* default.EventedMixin */.Z.EventedMixin(InteractiveToolBase/* InteractiveToolBase */.m))){constructor(t){super(t),this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.type="transform-3d",this.scaleRotate=null,this.snappingPipeline=new SnappingDragPipelineStep/* SnappingPipeline */.n}initialize(){this.graphicState=new GraphicState/* GraphicState */.F({graphic:this.graphic}),this.moveManipulation=new MoveManipulation_u({tool:this,view:this.view,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&manipulatorUtils_t(this.graphic),radius:MoveManipulation_u.radiusForSymbol(this.graphic.symbol)}),this.moveManipulation.forEachManipulator((t=>this.handles.add(t.events.on("immediate-click",(t=>{this.emit("immediate-click",{...t,graphic:this.graphicState.graphic}),t.stopPropagation()}))))),this.moveManipulation.elevationInfo=(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(this.graphic);const t=this.graphic.geometry;if(this.moveManipulation.createGraphicDragPipeline(((e,i,a,n,s)=>((0,maybe/* isSome */.pC)(t)&&e===MoveManipulation_M.XY&&(a=a.next(this.snappingPipeline.createSnapDragEventPipelineStep({snappingContext:new SnappingContext/* SnappingContext */.N({elevationInfo:(0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(this.graphic),pointer:s,editGeometryOperations:EditGeometryOperations/* EditGeometryOperations.fromGeometry */.c.fromGeometry(new Point/* default */.Z({spatialReference:t.spatialReference}),this.view.state.viewingMode),visualizer:new g,excludeFeature:this.graphic}),snappingManager:this.snappingManager,updatingHandles:this.updatingHandles,cancel:n}),this.snappingPipeline.next)),a)),this.graphicState,(t=>{const{action:e,graphic:i,dxScreen:a,dyScreen:o}=t,n={graphic:i,dxScreen:a,dyScreen:o};switch(e){case"start":this.emit("graphic-translate-start",n),this.emit("record-undo",{record:this._createGeometryUndoRecord()});break;case"update":this.emit("graphic-translate",n);break;case"end":this.emit("graphic-translate-stop",n)}})),this.moveManipulation.angle=(0,maybe/* isSome */.pC)(this.scaleRotate)?this.scaleRotate.angle:0,this.scaleRotateAdapter=this._createScaleRotateAdapter(),this.handles.add(this.scaleRotateAdapter.watch("angle",(()=>this._updateMoveAngle()))),this.enableScaling||this.enableRotation){const t=this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate";this.scaleRotate=new gt({tool:this,mode:t,adapter:this.scaleRotateAdapter}),this.handles.add(this.scaleRotate.events.on("scale-changed",(()=>this._onScaleChanged())))}this.handles.add([visualElementUtils_i({view:this.view,graphic:this.graphic,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>(0,handleUtils/* makeHandle */.kB)()}),this.graphicState.on("changed",(()=>this._onGeometryChanged())),this._hideManipulatorsForGraphicState(),this.view.watch("scale",(()=>this._updateMoveAngle()))]),this.handles.add(this.view.trackGraphicState(this.graphicState)),this._onGeometryChanged(),this._updateMoveAngle(),this._forEachManipulator((t=>{t instanceof Manipulator3D/* Manipulator3D */.Z&&this.handles.add(t.events.on("grab-changed",(()=>this._updateManipulatorsInteractive())))})),this.finishToolCreation()}_updateManipulatorsInteractive(){(0,maybe/* isNone */.Wi)(this.scaleRotate)||(this.scaleRotate.interactive=!this.moveManipulation.grabbing,this.moveManipulation.interactive=!this.scaleRotate.grabbing)}_createScaleRotateAdapter(){return (0,maybe/* isSome */.pC)(this.graphic.geometry)&&"mesh"===this.graphic.geometry.type?new ScaleRotateMeshAdapter_m({graphic:this.graphic,geometry:this.graphic.geometry,viewingMode:this.view.state.viewingMode}):new ScaleRotateObjectSymbol3DAdapter_y({graphic:this.graphic,sizeFilter:t=>this._enforceNonZeroSize(t),findLayerView:()=>this.view.allLayerViews.find((t=>t.layer===this.graphic.layer))})}_forEachManipulator(t){this.moveManipulation.forEachManipulator(t),(0,maybe/* isSome */.pC)(this.scaleRotate)&&this.scaleRotate.forEachManipulator(t)}_hideManipulatorsForGraphicState(){return this.graphicState.watch("displaying",(t=>{this._forEachManipulator((e=>e.available=t)),this.moveManipulation.zManipulation.available=t&&this.enableZ&&manipulatorUtils_t(this.graphic)}))}_createGeometryUndoRecord(){return undoRecords_r(this.graphic)}destroy(){this.moveManipulation.destroy(),this.scaleRotate=(0,maybe/* destroyMaybe */.SC)(this.scaleRotate),this.scaleRotateAdapter=(0,maybe/* destroyMaybe */.SC)(this.scaleRotateAdapter),this._set("view",null),this._set("graphic",null)}set snapToScene(t){this.moveManipulation&&(this.moveManipulation.snapToScene=t),this._set("snapToScene",t)}get updating(){return this.updatingHandles.updating}set location(t){this.moveManipulation.location=t,(0,maybe/* isSome */.pC)(this.scaleRotate)&&(this.scaleRotate.location=t)}set elevationAlignedLocation(t){this.moveManipulation.elevationAlignedLocation=t,(0,maybe/* isSome */.pC)(this.scaleRotate)&&(this.scaleRotate.elevationAlignedLocation=t)}reset(){}onHide(){(0,maybe/* isSome */.pC)(this.scaleRotate)&&this.scaleRotate.cancelActiveAnimation()}_onScaleChanged(){if((0,maybe/* isNone */.Wi)(this.scaleRotate))return;const t=this.scaleRotate.getScale();this.moveManipulation.displayScale=t}_updateMoveAngle(){this.view.state.viewingMode===ViewingMode/* ViewingMode.Local */.JY.Local||this.view.scale<config_w?this.moveManipulation.angle=this.scaleRotateAdapter.angle:this.moveManipulation.angle=0}_onGeometryChanged(){(0,manipulatorUtils/* placeAtGraphic */.u2)(this.view,this,this.graphic)}_enforceNonZeroSize(t){return t||this.view.state.camera.computeRenderPixelSizeAt(this.moveManipulation.renderLocation)}get test(){return{discManipulator:this.moveManipulation.xyManipulation.test.discManipulator,zManipulator:this.moveManipulation.zManipulation.test.manipulator,ringManipulator:(0,maybe/* isSome */.pC)(this.scaleRotate)?this.scaleRotate.test.ringManipulator:null,arrowManipulators:this.moveManipulation.xyAxisManipulation.test.arrowManipulators}}};(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicTransformTool_T.prototype,"view",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicTransformTool_T.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],GraphicTransformTool_T.prototype,"enableZ",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],GraphicTransformTool_T.prototype,"enableRotation",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],GraphicTransformTool_T.prototype,"enableScaling",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({value:!1})],GraphicTransformTool_T.prototype,"snapToScene",null),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0})],GraphicTransformTool_T.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],GraphicTransformTool_T.prototype,"type",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],GraphicTransformTool_T.prototype,"updating",null),GraphicTransformTool_T=(0,tslib_es6._)([(0,subclass/* subclass */.j)("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransformTool")],GraphicTransformTool_T);\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/unitUtils.js\nvar unitUtils = __webpack_require__(17321);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/vec2f64.js\nvar vec2f64 = __webpack_require__(69666);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/boundedPlane.js\nvar boundedPlane = __webpack_require__(96739);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/sliceToolUtils.js + 3 modules\nvar sliceToolUtils = __webpack_require__(74703);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/images/heading-rotate-png.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nconst heading_rotate_png_D="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAACuFBMVEUAAAD/AAD/gAD/VQD/gAD/bQD/gAD/cQD/gAD/dAD/eAD/gAD/gAD/egD/gAD/ewD/gAD/fAD/gAD/fQD/gAD/fQD/fQD/egD/fQD/gAD/fQD/ewD/fQD/gAD/gAD/fQD/gAD/fAD/fgD/fgD/fAD/fgD/fAD/fgD/fAD/fgD/gAD/fAD/fgD/fAD/fQD/fgD/fgD/fQD/fgD/fgD/fQD/fgD/fQD/fQD/fgD/fgD/fQD/fQD/fgD/fQD/fgD/fQD/fgD/fQD/fgD/fgD/gAL/fgD/gAb/gAT/gwr/gQj/hA7/hAz/hxH/iBP/ixn/iRf/jBz/jR7/jyP/kCX/kyr/lS7/lCz/li//mTT/mTf/nDr/mjn/nTz/n0H/nT//oET/oEL/okf/oEX/o0r/pU3/o0v/pU//qFL/plH/qFX/qFP/qVb/q1n/rV3/rFz/rmD/rl7/sGL/rmH/tW3/s2v/tW//tW7/t3L/tnD/uHT/unb/unn/unf/vHv/vX3/v4D/vX7/w4n/xY3/xIv/x4//xY3/x5H/yZP/x5H/yJP/y5f/yZX/zZv/y5n/zZ3/zJv/z5//z6D/z6H/0aT/0KP/0qb/06j/1av/06r/1q3/1q//17H/2rb/2rb/2rj/3bz/4MH/38D/38H/4sX/4MT/48f/4sb/4sf/5Mr/5s3/5cz/5s3/59D/59D/6dT/6dP/6dT/6tb/6tX/6tf/69n/69j/7dr/7Nn/7dz/7dv/7t3/7t7/7t3/7+H/8eL/8uX/8eP/8+j/8+f/9On/8+j/9Or/9ez/9e3/9ez/9e3/9+//9+7/+PD/9+//+PH/+PD/+fL/+PH/+fT/+vX/+fT/+vb/+vX/+/b/+vb/+/j/+/j//Pr//Pn//fv//v3//vz//fz//fv//v3//fz//////v7//v3///9vf1WOAAAA53RSTlMAAQIDBgcICQoLERIYGRobKCkqKywtLzAxMjM4OTo+P0BAQUVGR0hPUFFSUlNUWlthYmNlZmdoamtvcHR1dnd4eXx9f4CAgYGCgoODhIWGhoeIiYqLjIyNjo+QkJGSkpOTlJSVlpaXmJiZmZqbnJydnZ6eoqKjo6Skpaanp6ipqqqvsLCxsbKzs7S1tbe3uLi5uru8vL2+wMDBwsTGx8jLzc3O0NDR0dLT1dXW19ja2tvc3N3e3t/f4ODh4uLl5ufn6urr6+zt7u7v8PDx8fLy8/P09fX29vf3+Pn6+vv8/Pz8/f3+/v7EBDCzAAADmklEQVR42qXXd3sUVRQG8BNDKkU3KLYUIFkLLBo0yRJNBszuuwQlGISIDUTFhljAhhUbtlXEYEcjoEJUNCqKPXZUUCDU0FvI+RpkZpa5c9iZzMzD7+/d88yde+95z5CbvIIhIyqrtbo6rboyUlKQR4GcGI7GIMSi4QHkU1bRKDgaVZRF3nKGanClDc4hD4Nq0CvtzAzqRd8L4GlkX3IVGg0fxpxMzjLOgk9hx2VkRuBbJNPh/+cjpQnezkuvcC6Q8vVseItkkKTWP6Pr17HwVkbCQFg+YJ4P3U0vtrS1t//c9u6zM+DgFLH/av+m7Gfe1IhpLf+ysmbxVBxrdD4ptvPzDvdY2trNUvfytBLlZDkdloZt3GPvPk5z8K0EpFMpJacWlmTqmdnBd1dBqMkm01BY4n+waTsb1nd0drHl/2kQSsiQpcHyKKd0MP/YfOt4AJfPWtTOKRumw04z+0MRlNV81PezoNz5JZv+boRdIemisMxkS+ck2M3rZMPHskcZ/Q/KR6y8D2HqWjbMh11/IgrDfoiU7lsgXGNW6GgQB1quYPrClk9+WnuITash3WGWfw02VUR5MUCKX3n7w8m3P1z121xIzazbMg5KLJcK4Ntl5vV4EDYhGgz/XmDdcnmWRsC/iQeM1wibYVSBAL5g3WQoF9JFCOBN1t0PpZo0BDCPdU9BqaU6BPAA65JQLglWYDbrFooCGgJ4jHXPiSUEeokvse4hKNXBtnEF624W2xiBf/GN3GP3pVCG0xAIE57+9h64uZd1bbApFpcpMXfFLuaVcLOKdS/DJiSu87UHucfhOb0+wIEmeZ0pCqWVdX+Nh5MJ61i3BDaVsqVhphkCnyaQrt68SYdvhE0pEQ2AzRI2LBuX3k1a2fAe7PoRyTU0/seGb66ANPkHNqxpEG1dBIvhvkNs2PLMWCiJ5FY27LlbBouMNsOTXWz6p/lqmK57fR2buh+HjDYVrsqCLhWmK5cuXvbZBhUVzzuGK+XUwO6J3exs5yMQLs6mlNMg3PY7O/nlBkiDyDISQv2CHXysrckEpHI5ZEmTXpUzyp+vTOx1yHLIp/icN74y927z54vuiiNNiISwc5hNub6pHoo8xNI5CCSS4T5sw/ewLZ1wNnwbnklOyuBPrJRcnKTBhzEDyVV+OTyV5x/fZ98Z5CG7RIOr2pJs8tanMApH0cI+5FP/sqoYhFhVaT8KJDdUHKkwP/8rhhWHct1+dwRTps/cplDIpwAAAABJRU5ErkJggg==";\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Texture.js + 1 modules\nvar Texture = __webpack_require__(44101);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/analysisTools/slice/images/Factory.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nconst Factory_n={mipmap:!0,preMultiplyAlpha:!0,width:64,height:64};function Factory_o(r){return r.fromData(heading_rotate_png_D,(()=>new Texture/* Texture */.x(heading_rotate_png_D,Factory_n)))}function Factory_i(t){return t.fromData(r,(()=>new e(r,Factory_n)))}\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/PreserveAspectRatio.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass PreserveAspectRatio_s{constructor(){this.lastDragEvent=null,this.next=new dragEventPipeline/* EventPipeline */.hM,this._enabled=!1}get enabled(){return this._enabled}set enabled(a){if(this._enabled!==a&&(0,maybe/* isSome */.pC)(this.lastDragEvent)){const t={...this.lastDragEvent,action:"update"};a&&this._adjustScaleFactors(t),this.next.execute(t)}this._enabled=a}createDragEventPipelineStep(){return this.lastDragEvent=null,t=>(this.lastDragEvent="end"!==t.action?{...t}:null,this._enabled&&this._adjustScaleFactors(t),t)}_adjustScaleFactors(t){const e=(0,sliceToolUtils/* isDiagonalResizeHandle */.J0)(t.handle)?Math.max(Math.abs(t.factor1),Math.abs(t.factor2)):0===t.handle.direction[0]?Math.abs(t.factor2):Math.abs(t.factor1);t.factor1=t.factor1<0?-e:e,t.factor2=t.factor2<0?-e:e}get test(){return{_adjustScaleFactors:t=>this._adjustScaleFactors(t)}}}\n\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/editGeometry/operations/UpdateVertices.js\nvar UpdateVertices = __webpack_require__(28835);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/editGeometry/operations/MoveVertex.js\nvar MoveVertex = __webpack_require__(15328);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/editGeometry/operations/RotateVertex.js\nvar RotateVertex = __webpack_require__(15772);\n// EXTERNAL MODULE: ./node_modules/@arcgis/core/views/interactive/editGeometry/operations/ScaleVertex.js\nvar ScaleVertex = __webpack_require__(47472);\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/interactive/editGeometry/support/editPlaneUtils.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction l(s,o){return editPlaneUtils_F(s,o,!1)}function editPlaneUtils_C(s,o){return editPlaneUtils_F(s,o,!0)}function editPlaneUtils_F(s,o,i){if(s instanceof UpdateVertices/* UpdateVertices */.y){if(s.operation instanceof MoveVertex/* MoveVertex */.z)return editPlaneUtils_S(s.operation,o,i),!0;if(s.operation instanceof RotateVertex/* RotateVertex */.S)return editPlaneUtils_Y(s.operation,o,i),!0;if(s.operation instanceof ScaleVertex/* ScaleVertex */.q)return _(s.operation,o,i),!0}return!1}function editPlaneUtils_S(s,o,i=!1){const n=i?-1:1,r=(0,vec3f64.f)(n*s.dx,n*s.dy,n*s.dz);(0,vec3.b)(o.origin,o.origin,r)}function editPlaneUtils_Y(s,o,i=!1){const n=i?-s.angle:s.angle;(0,vec3.G)(o.basis1,o.basis1,vec3f64.Z,n),(0,vec3.G)(o.basis2,o.basis2,vec3f64.Z,n)}function _(o,i,n=!1){const r=n?1/o.factor1:o.factor1,t=n?1/o.factor2:o.factor2;(0,vec3.a)(i.basis1,i.basis1,r),(0,vec3.a)(i.basis2,i.basis2,t),(0,vec2.q)(i.origin,i.origin,o.origin,o.axis1,r),(0,vec2.q)(i.origin,i.origin,o.origin,o.axis2,t)}function editPlaneUtils_y(s,c,g,b){b||(b=(0,boundedPlane.c)());const f=(0,vec2.s)(vectorStacks/* sv2d.get */.qW.get(),s[1],-s[0]),u=(0,vec2.s)(vectorStacks/* sv2d.get */.qW.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),m=(0,vec2.s)(vectorStacks/* sv2d.get */.qW.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),p=vectorStacks/* sv2d.get */.qW.get();c.components.forEach((t=>t.vertices.forEach((t=>{const a=t.pos;(0,vec2.s)(p,(0,vec2.k)(s,a),(0,vec2.k)(f,a)),(0,vec2.x)(u,u,p),(0,vec2.y)(m,m,p)}))));const I=1e-6,d=(0,vec2.s)(vectorStacks/* sv2d.get */.qW.get(),m[0]-u[0]<I?g/2:0,m[1]-u[1]<I?g/2:0);return (0,vec2.f)(u,u,d),(0,vec2.m)(m,m,d),(0,vec2.g)(b.basis1,s,(m[0]-u[0])/2),(0,vec2.g)(b.basis2,f,(m[1]-u[1])/2),(0,vec2.s)(b.origin,u[0]*s[0]+u[1]*f[0],u[0]*s[1]+u[1]*f[1]),(0,vec2.m)(b.origin,b.origin,b.basis1),(0,vec2.m)(b.origin,b.origin,b.basis2),b}function editPlaneUtils_G(s,o,i,n=0,r){r||(r=(0,boundedPlane.c)()),o.toRenderCoords(s.origin,i,r.origin);const t=vectorStacks/* sv3d.get */.WM.get();(0,vec3.b)(t,s.origin,s.basis1),(0,vec3.b)(t,t,s.basis2),o.toRenderCoords(t,i,t);const a=vectorStacks/* sv3d.get */.WM.get();(0,vec3.b)(a,s.origin,s.basis1),(0,vec3.f)(a,a,s.basis2),o.toRenderCoords(a,i,a);const e=vectorStacks/* sv3d.get */.WM.get();(0,vec3.f)(e,s.origin,s.basis1),(0,vec3.f)(e,e,s.basis2),o.toRenderCoords(e,i,e);const g=vectorStacks/* sv3d.get */.WM.get();(0,vec3.f)(g,s.origin,s.basis1),(0,vec3.b)(g,g,s.basis2),o.toRenderCoords(g,i,g);const N=(0,vec3.e)(vectorStacks/* sv3d.get */.WM.get(),t,a,.5);(0,vec3.f)(N,N,r.origin);const j=(0,vec3.e)(vectorStacks/* sv3d.get */.WM.get(),e,g,.5);(0,vec3.f)(j,r.origin,j),(0,vec3.e)(r.basis1,N,j,.5);const T=(0,vec3.e)(vectorStacks/* sv3d.get */.WM.get(),g,t,.5);(0,vec3.f)(T,T,r.origin);const h=(0,vec3.e)(vectorStacks/* sv3d.get */.WM.get(),a,e,.5);(0,vec3.f)(h,r.origin,h),(0,vec3.e)(r.basis2,T,h,.5);const k=(0,vec3.c)(vectorStacks/* sv3d.get */.WM.get(),r.basis1,r.basis2),v=(0,vec3.c)(k,k,r.basis1);return (0,vec3.n)(v,v),(0,vec3.a)(r.basis2,v,(0,vec3.d)(r.basis2,v)),(0,vec3.a)(r.basis1,r.basis1,1+n/(0,vec3.l)(r.basis1)),(0,vec3.a)(r.basis2,r.basis2,1+n/(0,vec3.l)(r.basis2)),(0,boundedPlane.u)(r),r}\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools/transformGraphic/ExtentTransformTool.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nlet At=class extends(Evented/* default.EventedMixin */.Z.EventedMixin(InteractiveToolBase/* InteractiveToolBase */.m)){constructor(t){super(t),this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this._preserveAspectRatio=new PreserveAspectRatio_s,this.grabbing=!1,this.inputState=null,this.type="transform-3d",this.handles=new Handles/* default */.Z,this.moveZManipulator=null,this.resizeManipulators=null,this.rotateManipulator=null,this.attachmentOrigin=null,this.outlineVisualElement=null,this.mapBounds=(0,boundedPlane.c)(),this.mapBoundsStart=(0,boundedPlane.c)(),this.displayBounds=(0,boundedPlane.c)(),this.displayBoundsStart=(0,boundedPlane.c)(),this.displayBoundsMarginStart=0,this.resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}]}initialize(){this.graphicState=new GraphicState/* GraphicState */.F({graphic:this.graphic});const t=this.graphic.geometry;this.editGeometryOperations=EditGeometryOperations/* EditGeometryOperations.fromGeometry */.c.fromGeometry(t,this.view.state.viewingMode),this.graphicMoveManipulation=new MoveXYGraphicManipulation_h({tool:this,view:this.view,graphicState:this.graphicState}),this.handles.add(this._createMoveXYGraphicDragPipeline()),this.moveZManipulator=(0,sliceToolUtils/* createShiftManipulator */.Pt)(this.view,sliceToolUtils/* OffsetMode.CENTER_ON_CALLOUT */.lX.CENTER_ON_CALLOUT),this.moveZManipulator.state|=sliceToolUtils/* IsShiftEdgeOnScreenFlag */.Df,this.handles.add(this.watch("enableZ",(()=>this._updateManipulatorAvailability(this.moveZManipulator,ManipulatorType_A.TRANSLATE_Z)))),this.handles.add(this._createMoveZDragPipeline()),this.manipulators.add(this.moveZManipulator),this.resizeManipulators=this.resizeHandles.map((t=>{const e=(0,sliceToolUtils/* createResizeManipulator */.vw)(this.view,t);return this.handles.add(this.watch("enableScaling",(()=>this._updateManipulatorAvailability(e,ManipulatorType_A.SCALE)))),e.events.on("grab-changed",(t=>this._onResizeGrab(t))),this.handles.add(this._createResizeDragPipeline(e,t)),e})),this.manipulators.addMany(this.resizeManipulators),this.rotateManipulatorTexture=Factory_o(this.view.toolViewManager.textures),this.rotateManipulator=(0,sliceToolUtils/* createRotateManipulator */.Ju)(this.view,this.rotateManipulatorTexture.texture),this.handles.add(this.watch("enableRotation",(()=>this._updateManipulatorAvailability(this.rotateManipulator,ManipulatorType_A.ROTATE)))),this.rotateManipulator.events.on("grab-changed",(t=>{this._onRotateGrab(t)})),this.handles.add(this._createRotateDragPipeline(this.rotateManipulator)),this.manipulators.add(this.rotateManipulator),this._calculateMapBounds(),this._updateDisplayBounds();const e=visualElementUtils_i({view:this.view,graphic:this.graphic,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>(0,handleUtils/* makeHandle */.kB)()});(0,maybe/* isSome */.pC)(e)&&(this.outlineVisualElement=e.visualElement instanceof OutlineVisualElement/* OutlineVisualElement */.k?e.visualElement:null),(0,maybe/* isSome */.pC)(this.outlineVisualElement)&&this.handles.add(this.outlineVisualElement.events.on("attachment-origin-changed",(()=>this._updateDisplayBounds()))),this.handles.add(e),this.handles.add([this.graphicState.on("changed",(()=>this._onGeometryChanged())),this.graphicState.watch("displaying",(()=>this._updateAllManipulatorAvailability())),(0,watchUtils/* init */.S1)(this.graphicState,"isDraped",(()=>this._graphicDrapedChanged())),this.view.trackGraphicState(this.graphicState)]);const i=this.view.pointsOfInterest;i&&this.handles.add(i.centerOnSurfaceFrequent.watch("location",(()=>this._updateDisplayBounds())));const s=t=>{this.handles.add(t.events.on("grab-changed",(()=>{this.grabbing=t.grabbing,this._updateAllManipulatorAvailability()})))};this._forEachManipulator(s);const o=(t,e)=>{this.handles.add(t.events.on("immediate-click",(t=>{e===ManipulatorType_A.TRANSLATE_XY&&this.emit("immediate-click",{...t,graphic:this.graphic}),t.stopPropagation()})))};this._forEachManipulator(o),this._onGeometryChanged(),this._updateAllManipulatorAvailability(),this.finishToolCreation()}_graphicDrapedChanged(){this.handles.remove(xt),this._updateDisplayBounds(),this.graphicState.isDraped&&this.handles.add(this.view.elevationProvider.on("elevation-change",(t=>{(0,maybe/* isSome */.pC)(this.attachmentOrigin)&&(0,aaBoundingRect/* containsXY */.jE)(t.extent,this.attachmentOrigin.x,this.attachmentOrigin.y)&&this._updateDisplayBounds()})),xt)}_updateAllManipulatorAvailability(){this._forEachManipulator(((t,e)=>this._updateManipulatorAvailability(t,e)))}_updateManipulatorAvailability(t,e){const i=this.grabbing&&!t.grabbing;if(t.interactive=!i,t instanceof Manipulator3D/* Manipulator3D */.Z){const a=this.graphicState.displaying,s=this.enableZ&&manipulatorUtils_t(this.graphic);switch(e){case ManipulatorType_A.ROTATE:t.available=a&&this.enableRotation;break;case ManipulatorType_A.SCALE:t.available=a&&(this.enableScaling||this.enableRotation||s),t.interactive=!i&&this.enableScaling,t.state=this.enableScaling?sliceToolUtils/* resizeNormal */.Sc:sliceToolUtils/* resizeOutlineOnly */.vc;break;case ManipulatorType_A.TRANSLATE_Z:t.available=a&&s;break;default:t.available=a}}}_forEachManipulator(t){this.graphicMoveManipulation.forEachManipulator(t),this.resizeManipulators.forEach((e=>t(e,ManipulatorType_A.SCALE))),t(this.rotateManipulator,ManipulatorType_A.ROTATE),t(this.moveZManipulator,ManipulatorType_A.TRANSLATE_Z)}destroy(){this.mapBounds=null,this.displayBounds=null,this.rotateManipulatorTexture.release(),this.handles.destroy(),this.graphicMoveManipulation.destroy(),this.editGeometryOperations.destroy(),this._set("view",null),this._set("graphic",null)}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(t){this._preserveAspectRatio.enabled=t,this._set("preserveAspectRatio",t)}reset(){}_onGeometryChanged(){this._updateDisplayBounds()}_calculateMapBounds(){const t=this.graphic.geometry,e=this.editGeometryOperations.data,i=e.components[0].edges[0],a=(0,vec2.f)(vectorStacks/* sv2d.get */.qW.get(),i.leftVertex.pos,i.rightVertex.pos);(0,vec2.i)(a,a);const s=(0,maybe/* unwrapOr */.Pt)((0,manipulatorUtils/* getGraphicAttachmentOrigin */.du)(this.view,this.graphic),t.extent.center);let r=Rt*this.view.pixelSizeAt(s);const n=this.view.spatialReference;n!==t.spatialReference&&(r*=(0,unitUtils/* getMetersPerUnitForSR */.c9)(n)/(0,unitUtils/* getMetersPerUnitForSR */.c9)(t.spatialReference)),editPlaneUtils_y(a,e,r,this.mapBounds)}_updateDisplayBounds(){const t=this.graphic.geometry;if((0,maybe/* isNone */.Wi)(t))return;const e=(0,maybe/* isSome */.pC)(this.outlineVisualElement)&&!this.graphicState.isDraped&&(0,maybe/* isSome */.pC)(this.outlineVisualElement.attachmentOrigin)?this.outlineVisualElement.attachmentOrigin:(0,manipulatorUtils/* getGraphicAttachmentOrigin */.du)(this.view,this.graphic);this.attachmentOrigin=(0,maybe/* unwrapOr */.Pt)(e,t.extent.center);const i=(0,maybe/* isSome */.pC)(e)?e.z:(0,elevationAlignmentUtils/* evaluateElevationAlignmentAtPoint */.w7)(this.mapBounds.origin,this.view.elevationProvider,ElevationContext/* ElevationContext.fromElevationInfo */.o.fromElevationInfo((0,elevationInfoUtils/* getGraphicEffectiveElevationInfo */.RL)(this.graphic)),this.view.renderCoordsHelper),a=(0,boundedPlane.a)(this.mapBounds);a.origin[2]=i,editPlaneUtils_G(a,this.view.renderCoordsHelper,t.spatialReference,this.displayBoundsMargin,this.displayBounds),this._updateManipulators()}get displayBoundsMargin(){const t=this.view.pointsOfInterest,e=t?t.centerOnSurfaceFrequent.location:this.editGeometryOperations.data.geometry.extent.center;return Gt*this.view.pixelSizeAt(e)}_createMoveXYGraphicDragPipeline(){return this.graphicMoveManipulation.createDragPipeline(((t,e,i)=>this._applyGraphicMoveSteps(e,i)))}_createMoveZDragPipeline(){const t=this.view,e=this.editGeometryOperations.data.spatialReference;return (0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(this.moveZManipulator,((i,a,s)=>{const r=(0,vec3f64.a)(i.renderLocation),o=a.next(dragEventPipeline3D_G(t,r,e)).next((0,dragEventPipeline/* addScreenDelta */.zh)());this._applyGraphicMoveSteps(o,s)}))}_applyGraphicMoveSteps(t,e){const i=t.next((t=>("start"===t.action&&(this.inputState={type:"move"},(0,boundedPlane.a)(this.mapBounds,this.mapBoundsStart),this.emit("graphic-translate-start",{graphic:this.graphic,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY})),t))).next((0,dragEventPipeline/* addMapDelta */.AN)()).next(this._moveDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY};switch(t.action){case"start":case"update":(t.mapEnd.x-t.mapStart.x||t.mapEnd.y-t.mapStart.y||t.mapEnd.z-t.mapStart.z)&&this.emit("graphic-translate",e);break;case"end":this.inputState=null,this.emit("graphic-translate-stop",e)}return t}));return e.next((()=>{(0,maybe/* isSome */.pC)(this.inputState)&&this.emit("graphic-translate-stop",{graphic:this.graphic,dxScreen:0,dyScreen:0}),this._cancel()})),i}_moveDragUpdateGeometry(){return t=>{if((0,maybe/* isNone */.Wi)(this.inputState)||"move"!==this.inputState.type)return t;const e=[];for(const s of this.editGeometryOperations.data.components)e.push(...s.vertices);const i="start"===t.action?editGeometry_interfaces/* AccumulationBehaviour.NEW_STEP */.O.NEW_STEP:editGeometry_interfaces/* AccumulationBehaviour.ACCUMULATE_STEPS */.O.ACCUMULATE_STEPS,a=this.editGeometryOperations.moveVertices(e,t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,i);return l(a,this.mapBounds),this.graphic.geometry=this.editGeometryOperations.data.geometry,t}}_onResizeGrab(t){if("start"!==t.action)return;const e=this._calculatePickRay(t.screenPoint);(0,plane/* intersectRay */.BR)(this.displayBounds.plane,e,vectorStacks/* sv3d.get */.WM.get())&&((0,boundedPlane.a)(this.displayBounds,this.displayBoundsStart),(0,boundedPlane.a)(this.mapBounds,this.mapBoundsStart),this.displayBoundsMarginStart=this.displayBoundsMargin,this.inputState={type:"resize"})}_createResizeDragPipeline(t,e){return (0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(t,((t,i,a)=>{(0,maybe/* isNone */.Wi)(this.inputState)||(i.next((t=>("start"===t.action&&this.emit("graphic-scale-start",{graphic:this.graphic,xScale:1,yScale:1}),t))).next(dragEventPipeline3D_C(this.view,this.displayBoundsStart.plane)).next((t=>({...t,handle:e}))).next(this._resizeDragRenderPlaneToFactors()).next(this._preserveAspectRatio.createDragEventPipelineStep(),this._preserveAspectRatio.next).next(this._resizeDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,xScale:t.factor1,yScale:t.factor2};switch(t.action){case"start":case"update":this.emit("graphic-scale",e);break;case"end":this.inputState=null,this.emit("graphic-scale-stop",e)}return t})),a.next((()=>{(0,maybe/* isSome */.pC)(this.inputState)&&this.emit("graphic-scale-stop",{graphic:this.graphic,xScale:1,yScale:1}),this._cancel()})))}))}_resizeDragRenderPlaneToFactors(){return t=>{const e=this.displayBoundsStart,i=t.handle.direction,a=this.displayBoundsMargin,s=this.displayBoundsMarginStart,r=(0,vec3.g)(vectorStacks/* sv3d.get */.WM.get(),e.origin);(0,vec3.F)(r,r,e.basis1,-i[0]),(0,vec3.F)(r,r,e.basis2,-i[1]);const o=(0,vec3.f)(vectorStacks/* sv3d.get */.WM.get(),t.renderEnd,r),n=(0,vec3.f)(vectorStacks/* sv3d.get */.WM.get(),t.renderStart,r),p=(0,sliceToolUtils/* isDiagonalResizeHandle */.J0)(t.handle),h=(0,sliceToolUtils/* calculateDiagonalResizeHandleScale */.Lw)(e),l=(0,sliceToolUtils/* calculateDiagonalResizeHandleScale */.Lw)(this.displayBounds)/h,c=(t,e)=>{if(0===t)return 1;let i=(0,vec3.l)(e),r=.5*t*(0,vec3.d)(e,o)/i;const h=r<0?-1:1;if(p){r+=(i-.5*t*(0,vec3.d)(e,n)/i)*h*l}const c=i<1.5*s?1:wt;return i=Math.max(i-s,wt),h>0&&(r-=a),h*Math.max(h*(r/i),c)};return{...t,factor1:c(i[0],e.basis1),factor2:c(i[1],e.basis2)}}}_resizeDragUpdateGeometry(){return t=>{const e=(0,vec3.g)((0,vec3f64.c)(),this.mapBoundsStart.origin);(0,vec3.F)(e,e,this.mapBoundsStart.basis1,-t.handle.direction[0]),(0,vec3.F)(e,e,this.mapBoundsStart.basis2,-t.handle.direction[1]);const i=(0,vec2.s)((0,vec2f64.a)(),this.mapBoundsStart.basis1[0],this.mapBoundsStart.basis1[1]);(0,vec2.i)(i,i);const a=[];for(const o of this.editGeometryOperations.data.components)a.push(...o.vertices);const s="start"===t.action?editGeometry_interfaces/* AccumulationBehaviour.NEW_STEP */.O.NEW_STEP:editGeometry_interfaces/* AccumulationBehaviour.ACCUMULATE_STEPS */.O.ACCUMULATE_STEPS,r=this.editGeometryOperations.scaleVertices(a,e,i,t.factor1,t.factor2,s,UpdateVertices/* AccumulationType.REPLACE */.w.REPLACE);return (0,boundedPlane.a)(this.mapBoundsStart,this.mapBounds),l(r,this.mapBounds),this.graphic.geometry=this.editGeometryOperations.data.geometry,t}}_onRotateGrab(t){if("start"!==t.action)return;const e=(0,sliceToolUtils/* createRotatePlane */.Rd)(this.displayBounds,this.view.renderCoordsHelper,sliceToolUtils/* RotationAxis.HEADING */.aZ.HEADING,(0,plane/* create */.Ue)()),i=this._calculatePickRay(t.screenPoint);(0,plane/* intersectRay */.BR)(e,i,vectorStacks/* sv3d.get */.WM.get())&&((0,boundedPlane.a)(this.displayBounds,this.displayBoundsStart),(0,boundedPlane.a)(this.mapBounds,this.mapBoundsStart),this.inputState={type:"rotate",rotatePlane:e})}_createRotateDragPipeline(t){return (0,dragEventPipeline/* createManipulatorDragEventPipeline */.Xd)(t,((t,e,i)=>{const a=this.inputState;(0,maybe/* isNone */.Wi)(a)||(e.next((t=>("start"===t.action&&this.emit("graphic-rotate-start",{graphic:this.graphic,angle:0}),t))).next(dragEventPipeline3D_C(this.view,a.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(a)).next(this._rotateDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,angle:(0,mathUtils/* rad2deg */.BV)(t.rotateAngle)};switch(t.action){case"start":case"update":this.emit("graphic-rotate",e);break;case"end":this.inputState=null,this.emit("graphic-rotate-stop",e)}return t})),i.next((()=>{(0,maybe/* isSome */.pC)(this.inputState)&&this.emit("graphic-rotate-stop",{graphic:this.graphic,angle:0}),this._cancel()})))}))}_rotateDragRenderPlaneToRotate(t){return e=>{const i=(0,plane/* normal */.mJ)(t.rotatePlane),a=(0,manipulatorUtils/* calculateInputRotationTransform */.Gd)(e.renderStart,e.renderEnd,this.displayBounds.origin,i);return{...e,rotateAxis:i,rotateAngle:a}}}_rotateDragUpdateGeometry(){return t=>{const e=(0,vec3.g)((0,vec3f64.c)(),this.mapBoundsStart.origin),i=[];for(const r of this.editGeometryOperations.data.components)i.push(...r.vertices);const a="start"===t.action?editGeometry_interfaces/* AccumulationBehaviour.NEW_STEP */.O.NEW_STEP:editGeometry_interfaces/* AccumulationBehaviour.ACCUMULATE_STEPS */.O.ACCUMULATE_STEPS,s=this.editGeometryOperations.rotateVertices(i,e,t.rotateAngle,a,UpdateVertices/* AccumulationType.REPLACE */.w.REPLACE);return (0,boundedPlane.a)(this.mapBoundsStart,this.mapBounds),l(s,this.mapBounds),this.graphic.geometry=this.editGeometryOperations.data.geometry,t}}_calculatePickRay(t){const e=(0,ray/* create */.Ue)(),i=(0,screenUtils/* screenPointObjectToArray */.md)(t);return (0,geometryUtils_ray/* fromScreen */.u4)(this.view.state.camera,i,e),(0,vec3.n)(e.direction,e.direction),e}_updateManipulators(){if(!this.visible)return;const t=(0,sliceToolUtils/* calculateBoundedPlaneTranslateRotate */.zY)(this.displayBounds,vectorStacks/* sm4d.get */.MP.get());(0,sliceToolUtils/* updateRotateHeadingHandle */.A5)(this.rotateManipulator,t,this.displayBounds,this.view.renderCoordsHelper),this._updateZMoveHandle(this.moveZManipulator,t),this.resizeManipulators.forEach(((e,i)=>{(0,sliceToolUtils/* updateResizeHandle */.EC)(e,this.resizeHandles[i],t,this.displayBounds)}))}_updateZMoveHandle(t,e){const i=this.displayBounds,a={basis:i.basis1,direction:-1,position:(0,vec3.f)(vectorStacks/* sv3d.get */.WM.get(),i.origin,i.basis1),edge:2},s=vectorStacks/* sm4d.get */.MP.get();(0,mat4.g)(s,e,a.edge*Math.PI/2),s[12]=0,s[13]=0,s[14]=0,t.modelTransform=s,t.renderLocation=a.position}_cancel(){const t=this.editGeometryOperations.lastOperation;(0,maybe/* isNone */.Wi)(t)||(this.editGeometryOperations.undo(),this.graphic.geometry=this.editGeometryOperations.data.geometry,editPlaneUtils_C(t,this.mapBounds),this._updateDisplayBounds(),this.inputState=null)}get canUndo(){return this.editGeometryOperations.canUndo}undo(){if((0,maybe/* isSome */.pC)(this.inputState))this.view.activeTool=null;else if(this.canUndo){const t=this.editGeometryOperations.undo();this.graphic.geometry=this.editGeometryOperations.data.geometry,editPlaneUtils_C((0,maybe/* unwrap */.Wg)(t),this.mapBounds),this._updateDisplayBounds()}}get canRedo(){return this.editGeometryOperations.canRedo}redo(){if(this.canRedo){const t=this.editGeometryOperations.redo();this.graphic.geometry=this.editGeometryOperations.data.geometry,l((0,maybe/* unwrap */.Wg)(t),this.mapBounds),this._updateDisplayBounds()}}get test(){return{resizeManipulators:this.resizeManipulators,rotateManipulator:this.rotateManipulator,moveZManipulator:this.moveZManipulator}}};(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],At.prototype,"view",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],At.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({constructOnly:!0,nonNullable:!0})],At.prototype,"enableZ",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],At.prototype,"enableRotation",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],At.prototype,"enableScaling",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],At.prototype,"preserveAspectRatio",null),(0,tslib_es6._)([(0,property/* property */.Cb)()],At.prototype,"grabbing",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)()],At.prototype,"inputState",void 0),(0,tslib_es6._)([(0,property/* property */.Cb)({readOnly:!0})],At.prototype,"type",void 0),At=(0,tslib_es6._)([(0,subclass/* subclass */.j)("esri.views.3d.interactive.editingTools.graphicTransform3D.ExtentTransformTool")],At);const xt="draped-elevation-changes",Gt=10,Rt=80,wt=1e-6;\n\n;// CONCATENATED MODULE: ./node_modules/@arcgis/core/views/3d/interactive/editingTools.js\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\n\n\n\n//# sourceURL=webpack://reveal-js-testing/./node_modules/@arcgis/core/views/3d/interactive/editingTools.js_+_36_modules?')},83061:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "R": () => (/* binding */ z)\n/* harmony export */ });\n/* harmony import */ var _core_Handles_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(44584);\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(61681);\n/* harmony import */ var _chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(24455);\n/* harmony import */ var _chunks_mat4f64_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(39100);\n/* harmony import */ var _chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(6766);\n/* harmony import */ var _chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(8909);\n/* harmony import */ var _chunks_vec4_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(88589);\n/* harmony import */ var _chunks_vec4f32_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(18916);\n/* harmony import */ var _geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(68817);\n/* harmony import */ var _Object3DVisualElement_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(10449);\n/* harmony import */ var _webgl_engine_lib_Geometry_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(47562);\n/* harmony import */ var _webgl_engine_lib_GeometryUtil_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(6087);\n/* harmony import */ var _webgl_engine_lib_Material_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(7358);\n/* harmony import */ var _webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(21414);\n/* harmony import */ var _webgl_engine_materials_ColorMaterial_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(95793);\n/* harmony import */ var _webgl_engine_materials_RibbonLineMaterial_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(65392);\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nclass z extends _Object3DVisualElement_js__WEBPACK_IMPORTED_MODULE_8__/* .Object3DVisualElement */ ._{constructor(t){super(t),this._handles=new _core_Handles_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z,this._quadMaterial=null,this._outlineMaterial=null,this._maxSize=0,this._position=(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.c)(),this._up=(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.c)(),this._right=(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.c)(),this._renderOccluded=_webgl_engine_lib_Material_js__WEBPACK_IMPORTED_MODULE_11__/* .RenderOccludedFlag.OccludeAndTransparent */ .yD.OccludeAndTransparent,this._color=(0,_chunks_vec4f32_js__WEBPACK_IMPORTED_MODULE_6__.f)(1,0,0,1),this._outlineColor=(0,_chunks_vec4f32_js__WEBPACK_IMPORTED_MODULE_6__.f)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=_webgl_engine_lib_Material_js__WEBPACK_IMPORTED_MODULE_11__/* .RenderOccludedFlag.Opaque */ .yD.Opaque,this.applyProps(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_5__.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_5__.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry({previous:e,center:t,next:i}){this._maxSize=Math.min((0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.i)(t,e),(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.i)(t,i))/3,(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.n)(this._up,(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.f)(this._up,e,t)),(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.n)(this._right,(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.f)(this._right,i,t)),(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.g)(this._position,t),this.recreateGeometry()}createExternalResources(){this._quadMaterial=new _webgl_engine_materials_ColorMaterial_js__WEBPACK_IMPORTED_MODULE_13__/* .ColorMaterial */ .E(this.quadMaterialParameters),this._outlineMaterial=new _webgl_engine_materials_RibbonLineMaterial_js__WEBPACK_IMPORTED_MODULE_14__/* .RibbonLineMaterial */ .U(this.outlineMaterialParameters),this._handles.add(this.view.state.watch("camera",(()=>this._updateTransform())))}destroyExternalResources(){this._quadMaterial=null,this._outlineMaterial=null,this._handles.removeAll()}forEachExternalMaterial(e){e(this._quadMaterial),e(this._outlineMaterial)}createGeometries(e){this._createQuadGeometry(e),this._createOutlineGeometry(e),this._updateTransform(e)}_createQuadGeometry(e){const t=this._quadGeometryData(this._up,this._right);e.addGeometry(t,this._quadMaterial)}_createOutlineGeometry(e){if(0===this._outlineSize)return;const t=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.b)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_7__/* .sv3d.get */ .WM.get(),this._up,this._right),i=_webgl_engine_lib_GeometryUtil_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"].createPolylineGeometry */ .Z.createPolylineGeometry([this._up,t,this._right]);e.addGeometry(i,this._outlineMaterial)}_updateTransform(e=this.object){const s=this.view.state.camera,a=this._size*s.computeScreenPixelSizeAt(this._position),o=Math.min(this._maxSize,a);(0,_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__.f)(j,this._position),(0,_chunks_mat4_js__WEBPACK_IMPORTED_MODULE_1__.h)(j,j,[o,o,o]),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isSome */ .pC)(e)&&(e.transformation=j)}_quadGeometryData(e,t){const i=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.b)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_7__/* .sv3d.get */ .WM.get(),e,t);return new _webgl_engine_lib_Geometry_js__WEBPACK_IMPORTED_MODULE_9__/* .Geometry */ .Z([[_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__/* .VertexAttribute.POSITION */ .T.POSITION,{size:3,data:[0,0,0,...t,...e,...i],exclusive:!0}]],[[_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_12__/* .VertexAttribute.POSITION */ .T.POSITION,new Uint16Array([0,1,2,1,2,3])]])}get quadMaterialParameters(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}_updateQuadMaterial(){this._quadMaterial&&this._quadMaterial.setParameters(this.quadMaterialParameters)}get outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}_updateOutlineMaterial(){this._outlineMaterial&&this._outlineMaterial.setParameters(this.outlineMaterialParameters)}}const j=(0,_chunks_mat4f64_js__WEBPACK_IMPORTED_MODULE_2__.c)();\n\n\n//# sourceURL=webpack://reveal-js-testing/./node_modules/@arcgis/core/views/3d/interactive/visualElements/RightAngleQuadVisualElement.js?')},4641:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "L": () => (/* binding */ v)\n/* harmony export */ });\n/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(36663);\n/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(53443);\n/* harmony import */ var _core_Evented_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(31355);\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(61681);\n/* harmony import */ var _core_screenUtils_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(95550);\n/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(81977);\n/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(7753);\n/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(39994);\n/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(7283);\n/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(40266);\n/* harmony import */ var _chunks_vec2_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(55709);\n/* harmony import */ var _chunks_vec3_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(6766);\n/* harmony import */ var _chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(8909);\n/* harmony import */ var _geometry_projection_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(90472);\n/* harmony import */ var _support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(83772);\n/* harmony import */ var _symbols_support_defaults_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(5310);\n/* harmony import */ var _symbols_support_ElevationInfo_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(74710);\n/* harmony import */ var _support_drapedUtils_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(99621);\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nlet v=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z{constructor(e){super(e),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.events=new _core_Evented_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"].EventEmitter */ .Z.EventEmitter,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}set graphic(e){this._circleCollisionCache=null,this._originalSymbol=e.symbol,this._set("graphic",e),this.attachSymbolChanged()}get elevationInfo(){const e="elevationInfo"in this.graphic.layer&&this.graphic.layer.elevationInfo,t=(0,_support_elevationInfoUtils_js__WEBPACK_IMPORTED_MODULE_11__/* .getGraphicEffectiveElevationMode */ .vu)(this.graphic),i=e?e.offset:0;return new _symbols_support_ElevationInfo_js__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z({mode:t,offset:i})}set focusedSymbol(e){e!==this._get("focusedSymbol")&&(this._set("focusedSymbol",e),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(e){e!==this._get("grabbing")&&(this._set("grabbing",e),this._updateGraphicSymbol())}set hovering(e){e!==this._get("hovering")&&(this._set("hovering",e),this._updateGraphicSymbol())}set selected(e){e!==this._get("selected")&&(this._set("selected",e),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set("view",null)}intersectionDistance(e){const t=this.graphic;if(!1===t.visible)return null;const i=t.geometry;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isNone */ .Wi)(i))return null;const r=this._get("focusedSymbol"),l=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isSome */ .pC)(r)?r:t.symbol;return"2d"===this.view.type?this._intersectDistance2D(this.view,e,i,l):this._intersectDistance3D(this.view,e,t)}attach(){this.attachSymbolChanged(),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isSome */ .pC)(this.layer)&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isSome */ .pC)(this.layer)&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=this.graphic.watch("symbol",(e=>{(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isSome */ .pC)(e)&&e!==this.focusedSymbol&&e!==this._originalSymbol&&(this._originalSymbol=e,this._focused&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isSome */ .pC)(this.focusedSymbol)&&(this.graphic.symbol=this.focusedSymbol))}),!0)}detachSymbolChanged(){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isSome */ .pC)(this._graphicSymbolChangedHandle)&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isSome */ .pC)(this.focusedSymbol)?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(e,t,i,a){if(a=a||(0,_symbols_support_defaults_js__WEBPACK_IMPORTED_MODULE_12__/* .getDefaultSymbol2D */ .js)(i),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isNone */ .Wi)(a))return null;const n=1;let c=this._circleCollisionCache;if("point"!==i.type||"simple-marker"!==a.type)return (0,_support_drapedUtils_js__WEBPACK_IMPORTED_MODULE_14__/* .intersectsDrapedGeometry */ .D)(t,i,e)?n:null;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isNone */ .Wi)(c)||!c.originalPoint.equals(i)){const t=i,o=e.spatialReference;if((0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_10__/* .canProjectWithoutEngine */ .Up)(t.spatialReference,o)){const e=(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_10__/* .project */ .iV)(t,o);c={originalPoint:t.clone(),mapPoint:e,radiusPx:(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_16__/* .pt2px */ .F2)(a.size)},this._circleCollisionCache=c}}if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__/* .isSome */ .pC)(c)){const i=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_16__/* .screenPointObjectToArray */ .md)(t,C),o=e.toScreen(c.mapPoint),s=c.radiusPx,p=o.x+(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_16__/* .pt2px */ .F2)(a.xoffset),m=o.y-(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_16__/* .pt2px */ .F2)(a.yoffset);return (0,_chunks_vec2_js__WEBPACK_IMPORTED_MODULE_7__.a)(i,[p,m])<s*s?n:null}return null}_intersectDistance3D(e,t,i){const o=e.toMap(t,{include:[i]});return o&&(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_10__/* .projectPointToVector */ .KC)(o,S,e.renderSpatialReference)?(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_8__.i)(S,e.state.camera.eye):null}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)({constructOnly:!0,nonNullable:!0})],v.prototype,"graphic",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)({readOnly:!0})],v.prototype,"elevationInfo",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)({constructOnly:!0,nonNullable:!0})],v.prototype,"view",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)({value:null})],v.prototype,"focusedSymbol",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)({constructOnly:!0})],v.prototype,"layer",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)()],v.prototype,"interactive",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)()],v.prototype,"selectable",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)()],v.prototype,"grabbable",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)({value:!1})],v.prototype,"grabbing",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)()],v.prototype,"dragging",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)()],v.prototype,"hovering",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)({value:!1})],v.prototype,"selected",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .Cb)()],v.prototype,"cursor",void 0),v=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_17__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__/* .subclass */ .j)("esri.views.interactive.GraphicManipulator")],v);const S=(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_9__.c)(),C=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_16__/* .createScreenPointArray */ .s1)();\n\n\n//# sourceURL=webpack://reveal-js-testing/./node_modules/@arcgis/core/views/interactive/GraphicManipulator.js?')},99621:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{eval('/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "D": () => (/* binding */ o),\n/* harmony export */   "K": () => (/* binding */ a)\n/* harmony export */ });\n/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(91957);\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(61681);\n/* harmony import */ var _core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(17321);\n/* harmony import */ var _renderers_support_clickToleranceUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(59468);\n/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(91772);\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.23/esri/copyright.txt for details.\n*/\nfunction a(t,n,a,o=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z){let s;if("2d"===a.type)s=n*a.resolution;else if("3d"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_3__/* .isSome */ .pC)(o)&&!o.equals(a.spatialReference)?(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .getMetersPerUnitForSR */ .c9)(o)/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .getMetersPerUnitForSR */ .c9)(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_3__/* .isNone */ .Wi)(o))return!1;return a(o,(0,_renderers_support_clickToleranceUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .calculateTolerance */ .k)(),i,s).intersects(r)}const s=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z;\n\n\n//# sourceURL=webpack://reveal-js-testing/./node_modules/@arcgis/core/views/support/drapedUtils.js?')}}]);